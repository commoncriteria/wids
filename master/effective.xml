<Module xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:sec="https://niap-ccevs.org/cc/v1/section" boilerplate="yes" target-product="Wireless Intrusion Detection/Prevention System" target-products="Wireless Intrusion Detection/Prevention Systems (WIDS/WIPS)" name="802.11 Wireless Intrusion Detection/Prevention Systems">
  <PPReference>
    <ReferenceTable>
      <PPVersion>2.1</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-02-28</PPPubDate>
      <Keywords>WIDS/WIPS, Wireless Intrusion Detection/Prevention System</Keywords>
    </ReferenceTable>
  </PPReference>
  
  <RevisionHistory>
    <entry>
    <version>2.1</version>
    <date>2025-02-28</date>
    <subject>Incorporate NIAP Technical Decisions, Update to CC:2022</subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2022-09-30</date>
      <subject>Added 6 GHz spectrum slice</subject>
    </entry>
    <entry>
      <version>1.0</version>
      <date>2020-09-30</date>
      <subject>Initial Release - PP-Module for NDcPP</subject>
    </entry>
  </RevisionHistory>

  <release-notes><h:h3>TDs Applied</h:h3></release-notes><include-pkg id="pkgTLS">
    <git>
      <url>https://github.com/commoncriteria/tls/</url>
      <branch>release-2.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/465</url>
  </include-pkg>

  <include-pkg id="pkgSSH">
    <git>
      <url>https://github.com/commoncriteria/ssh/</url>
      <branch>release-2.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/515</url>
  </include-pkg> 

  <pp-preferences>
    <audit-events-in-sfrs/>
  </pp-preferences>

  <sec:Introduction>
    <sec:Overview> 
      <h:p>
      This Protection Profile Module (PP-Module) describes
      security requirements for a 802.11 Wireless Intrusion Detection System (WIDS) defined to be an
      IEEE 802.11 network intrusion detection product located at the edge of a private network that
      can collect, inspect, and analyze real-time network traffic and alert the administrator of
      policy violations. This PP-Module is intended to provide a minimal baseline set of
      requirements that are targeted at mitigating well defined and described threats.
    </h:p><h:p> 
      This PP-Module contains optional requirements for a Wireless Intrusion
      Protection System (WIPS), a security product that in addition to the 802.11 WIDS capability,
      provides network security administrators with the additional ability to react in real-time to
      potentially malicious wireless (IEEE 802.11) network traffic. 
      </h:p><h:p> 
      This PP-Module is intended for use with the following Base-PP: <h:ul>
        <h:li>collaborative Protection Profile for Network Devices (NDcPP), Version 3.0e</h:li>
      </h:ul>
      </h:p><h:p>
      A TOE that conforms to a PP-Configuration containing this PP-Module must be a 'Distributed TOE' as defined in the NDcPP. 
      The expectation for this PP-Module is that a WIDS must include distributed sensor nodes to ensure that the full physical range of a wireless network
      to ensure that user interactions with the network cannot evade detection.
</h:p>
    </sec:Overview>
    <cc-terms>
      <term abbr="SF" full="Security Function">
	A part or parts of the TOE that have to be relied upon for enforcing a
	closely related subset of the rules from the TSP.
      </term>
      <term abbr="SFP" full="Security Function Policy">The security policy enforced by an SF.</term>
    </cc-terms>
    <tech-terms>
      <suppress>Extended Package</suppress>
      <term abbr="AES" full="Advanced Encryption Standard"/>
      <term abbr="AP" full="Access Point" plural="APs">
	A device that provides the network interface that enables
        802.11 wireless client hosts to access a wired network. </term>
	<term abbr="BSSID" full="Basic Service Set Identifier"/>
	<term abbr="DHCP" full="Dynamic Host Configuration Protocol"/>
      <term abbr="DoS" full="Denial of Service"/>
      <term abbr="DDoS" full="Distributed Denial of Service"/>
      <term abbr="EUD" full="End User Device" plural="EUDs">
	An 802.11 enabled device that has the ability to
        process, transmit, and/or store information.
      </term>
      <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/>
      <term abbr="IPsec" full="Internet Protocol Security"/>
      <term abbr="ICS" full="Internet Connection Sharing"/>
      <term abbr="MAC" full="Media Access Control"/>
      <term abbr="OSI" full="Open Systems Interconnection"/>
      <term abbr="SNMP" full="Simple Network Management Protocol"/>
      <term abbr="SSH" full="Secure Shell"/>
      <term abbr="SSID" full="Service Set Identifier" plural="SSIDs"> The primary name associated with an 802.11
        wireless local area network (WLAN). </term>
      <term abbr="TLS" full="Transport Layer Security"/>
      <term abbr="TKIP" full="Temporal Key Integrity Protocol"/>
      <term abbr="WEP" full="Wired Equivalent Protocol"/>
      <term abbr="WIDS" full="Wireless Intrusion Detection System"> A security product that
        provides network security administrators with the ability to monitor, collect, and log
        real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WIPS" full="Wireless Intrusion Prevention System"> A security product that
        provides network security administrators with the ability to monitor, collect, log, and
        react in real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WLAN" full="Wireless Local Area Network" plural="WLANs"> An 802.11 wireless computer network that
        links two or more devices using wireless communication to form a local area network (LAN)
        within a limited area such as a home, school, computer laboratory, campus, office building
        etc. </term>
      <term abbr="WPA" full="WLAN Protected Access"/>
    </tech-terms>
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <section title="TOE Boundary" id="TOEboundary"> 
        <h:p>
        This PP-Module specifically addresses
        WIDS/WIPS. A conformant WIDS is a product that can monitor, collect, inspect, and analyze
        real-time network traffic and alert the administrator of policy violations. WIPS
        functionality is not required to conform to this PP-Module, and it is optional for the TOE
        to have the additional ability to react in real-time to potentially malicious wireless (IEEE
        802.11) network traffic.</h:p>
	<h:p> 
	  A WIDS/WIPS TOE consists of multiple sensors that
        passively scan the RF environment on the WLAN radio frequency spectrum and a centralized
        mechanism such as a Server or Controller that processes the data collected by the sensors.
        Conformant TOEs must use a secure communication path(s) between WIDS/WIPS components.
        </h:p><h:p> A WIDS/WIPS can be Integrated (be part of the WLAN infrastructure) or
        Standalone (independent from WLAN) architecture depending on vendor implementation. The two
        different architectures are illustrated in <xref to="toe"/> below. The TOE
        boundary is indicated by the yellow box.
        </h:p><h:p> A WIDS/WIPS is expected to inspect layers 1 and 2 network traffic, per the
        OSI network model, and monitor wireless frames in the RF spectrum utilized by IEEE 802.11 a,
        b, g, n, and ac. Monitoring and inspection of other technologies (e.g., cellular) and
        protocols are optional.</h:p><h:p> Conformant TOEs will detect potentially malicious
        network traffic using various approaches. Broadly speaking, the traffic analysis could be
        based on identification of 'known' threats, or 'unknown' threats. Identification of 'known'
        threats may be performed through pattern matching, (e.g. by matching strings of characters
        within a frame with known patterns, or by matching traffic patterns common with
        reconnaissance or denial of service (DoS) attacks). Identification of 'unknown' threats may
        be performed through use of various forms of anomaly detection whereby the WIDS/WIPS is
        provided with (or learns/creates) a definition of expected/typical traffic patterns, such
        that it’s able to detect and react to anomalous (unexpected/atypical) traffic patterns.</h:p><h:p>
        <figure entity="images/TOE.jpg" title="General TOE" id="toe"/>
      </h:p>
      </section>
    </section>
    <!-- NIAP: Do we have to have a use case? Todo: Need to either add a use case or delete this section -->
     
    <section title="Use Cases" id="usecases">  
      <usecases>  
        <usecase id="usecase1" title="Use Case 1">
          <description>
            <h:p>
	    A WIDS consists of sensors (preferably dedicated) and a central controller working together to provide 24/7 monitoring, primarily to the 
          802.11 Wireless Local Area Network (WLAN) spectrum and protocol, to detect, identify, and geolocate WLAN devices within a controlled space.
            </h:p><h:p> The WIDS may be capable of detecting or monitoring traffic other than 802.11 WLAN, such as
          802.15.4 based protocols, which enhances the security of the controlled space. However, a WIDS is not required to monitor additional protocols outside of 802.11. 
          A WIDS monitors all 802.11 WLAN traffic emanating from and traversing the controlled space, thus inadvertent collection of any 802.11
          signals is possible when operating a WIDS.</h:p>
	  </description> 
        </usecase>
      </usecases>  
      </section>   
  </sec:Introduction>

  <sec:Conformance_Claims>
  <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
  <cc-st-conf>exact</cc-st-conf>
  <cc-pt2-conf>extended</cc-pt2-conf>
  <cc-pt3-conf>conformant</cc-pt3-conf>
  <cc-pp-conf/>
  <cc-pp-config-with/>
  <cc-pkg-claim/>
  </CClaimsInfo>
  </sec:Conformance_Claims>
  <!--   <cclaims> -->
  <!--     <cclaim title="Conformance Statement"> -->
  <!--       <description> This PP-Module inherits exact conformance as required from the specified -->
  <!--         Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based -->
  <!--         SFRs, and Optional SFRs (dated May 2017).</h:p><h:p> -->
  <!--         The following PPs and PP-Modules are allowed to be specified in a PP-Configuration with this PP-Module: <h:ul> -->
  <!--           <h:li>PP-Module for Virtual Private Network (VPN) Gateways,  Version 1.1</h:li> -->
  <!--         </h:ul> -->
          
  <!--       </description> -->
  <!--     </cclaim> -->
  <!--     <cclaim title="CC Conformance Claims"> -->
  <!--       <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common -->
  <!--         Criteria Version 3.1, Release 5 [CC]. </description> -->
  <!--     </cclaim> -->
  <!--     <cclaim title="Package Claims"> -->
  <!--       <description> This PP-Module does not claim conformance to any packages.</description> -->
  <!--     </cclaim> -->
  <!--   </cclaims> -->
  <!-- </chapter> -->
  <sec:Security_Problem_Definition>
    <h:p>
      WIDS address a range of security threats
    related to detection of and reaction to potentially malicious WLAN traffic. The malicious
    traffic may pose a threat to one or more endpoints on the monitored networks, to the network
    infrastructure, or to the TOE itself. Attacks against a WLAN could compromise the
    confidentiality and integrity of WLAN users and system data as well as the availability of the
    WLAN to legitimate users. </h:p><h:p> The term “monitored network” is used here to represent
    any WLAN and/or wired network that the TOE is configured to monitor and detect intrusions on.
    This extends to the wired networks as intrusions on the wireless network can also be damaging to
    the wired infrastructure. The WIDS/WIPS also protect the wired infrastructure by detecting rogue
    devices that are directly connected to the wired infrastructure, which may expose the wired
    network, or unauthorized WLAN devices deployed in a no-wireless zone.<h:br/>
    <h:br/> The proper installation, configuration, and administration of the WIDS is critical to
    its correct operation. A site is responsible for developing its security policy and configuring
    a rule set that the WIDS will enforce and provide an appropriate response to meet their needs,
    relative to their own risk analysis and their perceived threats.</h:p><h:p> Note that this
    PP-Module does not repeat the threats identified in the NDcPP, though they all apply given the
    conformance and hence dependence of this PP-Module on the NDcPP. Note also that while the NDcPP
    contains only threats to the ability of the TOE to provide its security functions, this
    PP-Module addresses only threats to resources in the operational environment. Together the
    threats of the NDcPP and those defined in this PP-Module define the comprehensive set of
    security threats addressed by a WIDS TOE. 
  </h:p>
      <section title="Threats" id="threats">
      <threats>
        <threat name="T.UNAUTHORIZED_DISCLOSURE_OF_INFORMATION">
          <description> A malicious actor may take advantage of unintended/unauthorized disclosure of 
            sensitive information on a protected WLAN, such as sending unencrypted sensitive data, without detection. 
            A malicious actor may also force the modification or disclosure of data in transit between 
            distributed components of a WIDS to impede or gain visibility into its data collection capabilities.</description>
          <consistency-rationale>This threat is similar to the T.UNDETECTED_ACTIVITY threat in the Base-PP 
            but it applies to the attacker performing malicious actions on the network monitored by the TOE rather than against the TOE itself.</consistency-rationale>
          <addressed-by>FAU_ARP.1</addressed-by><rationale>Mitigates the threat by generating alerts for potential violations of security policy.</rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by><rationale>Mitigates the threat by allowing for nuisance or undesirable alarms from generation, preventing alarm fatigue.</rationale>
          <addressed-by>FAU_GEN.1/WIDS</addressed-by><rationale>Mitigates the threat by generating audit data related to operation, including abnormal conditions and potential threat detections.</rationale>
          <addressed-by>FAU_GEN_EXT.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by generating audit data on each component of the TOE.</rationale>
        
          
          
          <addressed-by>FAU_IDS_EXT.1</addressed-by><rationale>Mitigates the threat by detecting intrusions or potential intrusions.</rationale>
          <addressed-by>FAU_INV_EXT.1</addressed-by><rationale>Mitigates the threat by defining an allowlist of authorized equipment for use in the network.</rationale>
          <addressed-by>FAU_INV_EXT.2</addressed-by><rationale>Mitigates the threat by detecting all wireless devices present in the vicinity.</rationale>
          <addressed-by>FAU_INV_EXT.3</addressed-by><rationale>Mitigates the threat by determining the physical location of wireless devices in the vicinity.</rationale>
          <addressed-by>FAU_RPT_EXT.1</addressed-by><rationale>Mitigates the threat by transmitting audit data to a central location.</rationale>
          <addressed-by>FAU_SAA.1</addressed-by><rationale>Mitigates the threat by defining rules that indicate a potential malicious action.</rationale>
          <addressed-by>FAU_STG.1/PCAP</addressed-by><rationale>Mitigates the threat by storing packet captures generated by the TOE, and optionally forwarding this data to a central point.</rationale>
          <addressed-by>FAU_STG_EXT.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by storing audit data in specified locations and optionally forwarding this data to a central point.</rationale>
          <addressed-by>FAU_WID_EXT.1</addressed-by><rationale>Mitigates the threat by classifying wireless devices as benign or malicious based on device metrics.</rationale>
          <addressed-by>FAU_WID_EXT.2</addressed-by><rationale>Mitigates the threat by monitoring 802.11 wireless traffic in the vicinity.</rationale>
          <addressed-by>FCO_CPC_EXT.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by securely registering components to the TOE.</rationale>
          <addressed-by>FMT_SMF.1/WIDS</addressed-by><rationale>Mitigates the threat by allowing configuration of rules, configuration, and other TOE operational settings.</rationale>
          <addressed-by>FPT_FLS.1/WIDS (objective)</addressed-by><rationale>Mitigates the threat by at miniimum generating an audit record when potential security failures of the TSF are detected, 
          which could include failures to properly monitor or alert to potential threats.</rationale>
          <addressed-by>FTP_ITC.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by securely transmitting data from the TOE to other trusted entities.</rationale>
          <addressed-by>FPT_ITT.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by securely transmitting data between TOE components.</rationale>
          <addressed-by>FAU_WID_EXT.3/BT (optional)</addressed-by><rationale>Mitigates the threat by monitoring Bluetooth wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/CELL (optional)</addressed-by><rationale>Mitigates the threat by monitoring cellular wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/RF (optional)</addressed-by><rationale>Mitigates the threat by monitoring non-802.11 wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.4 (optional)</addressed-by><rationale>Mitigates the threat by using a dedicated sensor for analysis of wireless traffic.</rationale>
          <addressed-by>FAU_ANO_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining thresholds of baseline and anomalous traffic for analysis and action.</rationale>
          <addressed-by>FAU_SIG_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining signatures for an attack.</rationale>
          <addressed-by>FAU_INV_EXT.4 (objective)</addressed-by><rationale>Mitigates the threat by detecting non-authorized wireless equipment being attached to an internal wired network.</rationale>
          <addressed-by>FAU_INV_EXT.5 (objective)</addressed-by><rationale>Mitigates the threat by including a signal library.</rationale>
          <addressed-by>FAU_MAC_EXT.1 (objective)</addressed-by><rationale>Mitigates the threat by detecting when a device is attempting to spoof a trusted device's MAC address.</rationale>
          <addressed-by>FAU_WIP_EXT.1 (objective)</addressed-by><rationale>Mitigates the threat by isolating confirmed threats to the internal network, either wired (unauthorized AP) or wireless.</rationale>
          


        </threat>
        <threat name="T.UNAUTHORIZED_ACCESS">
          <description> An attacker may attempt to gain unauthorized access to a network, endpoints,
            or services, by methods such as impersonation of an authorized AP to get an EUD to
            connect to the unauthorized AP If malicious external APs or EUDs are able to communicate
            with APs or EUDs on the protected WLAN, then those devices may be susceptible to the
            unauthorized disclosure of information. </description>
          <consistency-rationale>This threat is similar to the T.UNAUTHORIZED_ADMINISTRATOR_ACCESS threat in the Base-PP 
            but it applies to the attacker gaining unauthorized access to an asset on the network monitored by the TOE rather than against the TOE itself.</consistency-rationale>
          <addressed-by>FAU_ARP.1</addressed-by><rationale>Mitigates the threat by generating alerts for potential violations of security policy.</rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by><rationale>Mitigates the threat by allowing for nuisance or undesirable alarms from generation, preventing alarm fatigue.</rationale>
          <addressed-by>FAU_IDS_EXT.1</addressed-by><rationale>Mitigates the threat by detecting intrusions or potential intrusions.</rationale>
          <addressed-by>FAU_INV_EXT.1</addressed-by><rationale>Mitigates the threat by defining an allowlist of authorized equipment for use in the network.</rationale>
          <addressed-by>FAU_INV_EXT.2</addressed-by><rationale>Mitigates the threat by detecting all wireless devices present in the vicinity, to use against the allowlist 
            for detection of potentially unauthorized access points or end-user devices.</rationale>
          <addressed-by>FAU_INV_EXT.3</addressed-by><rationale>Mitigates the threat by determining the physical location of wireless devices in the vicinity, to allow 
          for locating any potentially rogue devices.</rationale>
          <addressed-by>FAU_SAA.1</addressed-by><rationale>Mitigates the threat by defining rules that indicate a potential malicious action.</rationale>
          <addressed-by>FAU_WID_EXT.1</addressed-by><rationale>Mitigates the threat by classifying wireless devices as benign or malicious based on device metrics.</rationale>
          <addressed-by>FAU_WID_EXT.2</addressed-by><rationale>Mitigates the threat by monitoring 802.11 wireless traffic in the vicinity for comparison against defined policies.</rationale>
          <addressed-by>FAU_WIP_EXT.1 (objective)</addressed-by><rationale>Mitigates the threat by isolating confirmed threats to the internal network, either wired (unauthorized AP) or wireless.</rationale>
          <addressed-by>FAU_WID_EXT.3/RF (optional)</addressed-by><rationale>Mitigates the threat by monitoring non-802.11 wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/BT (optional)</addressed-by><rationale>Mitigates the threat by monitoring Bluetooth wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/CELL (optional)</addressed-by><rationale>Mitigates the threat by monitoring cellular wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.4 (optional)</addressed-by><rationale>Mitigates the threat by using a dedicated sensor for analysis of wireless traffic.</rationale>
          <addressed-by>FAU_ANO_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining thresholds of baseline and anomalous traffic for analysis and action.</rationale>
          <addressed-by>FAU_SIG_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining signatures for an attack.</rationale>
          <addressed-by>FAU_INV_EXT.4 (objective)</addressed-by><rationale>Mitigates the threat by detecting non-authorized wireless equipment being attached to an internal wired network.</rationale>
          <addressed-by>FAU_INV_EXT.5 (objective)</addressed-by><rationale>Mitigates the threat by including a signal library.</rationale>
          <addressed-by>FAU_MAC_EXT.1 (objective)</addressed-by><rationale>Mitigates the threat by detecting when a device is attempting to spoof a trusted device's MAC address.</rationale>
          <addressed-by>FMT_SMF.1/WIDS</addressed-by><rationale>Mitigates the threat by allowing configuration of rules, configuration, and other TOE operational settings.</rationale>
        </threat>
        <threat name="T.DISRUPTION">
          <description> Attacks against the WLAN infrastructure might lead to denial of service
            (DoS) attacks within a protected WLAN. A wireless DoS may occur in two ways: at the
            physical layer through RF Jamming, or at the data link layer through packet injection. </description>
          <consistency-rationale>This threat is for a denial-of-service attack against an asset on the network monitored by the TOE. 
            The Base-PP does not define any threats for availability but there is no consistency issue here because the threat applies to an interface that does not exist in the Base-PP.</consistency-rationale>
          <addressed-by>FAU_ARP.1</addressed-by><rationale>Mitigates the threat by generating alerts for potential violations of security policy.</rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by><rationale>Mitigates the threat by allowing for nuisance or undesirable alarms from generation, preventing alarm fatigue.</rationale>
          <addressed-by>FAU_IDS_EXT.1</addressed-by><rationale>Mitigates the threat by detecting intrusions or potential intrusions.</rationale>
          <addressed-by>FAU_INV_EXT.1</addressed-by><rationale>Mitigates the threat by defining an allowlist of authorized equipment for use in the network.</rationale>
          <addressed-by>FAU_INV_EXT.2</addressed-by><rationale>Mitigates the threat by detecting all wireless devices present in the vicinity, to use against the allowlist 
            for detection of potentially unauthorized access points or end-user devices.</rationale>
          <addressed-by>FAU_INV_EXT.3</addressed-by><rationale>Mitigates the threat by determining the physical location of wireless devices in the vicinity, to allow 
          for locating any potentially rogue devices.</rationale>
          <addressed-by>FAU_SAA.1</addressed-by><rationale>Mitigates the threat by defining rules that indicate a potential malicious action, including signs of a DoS attack.</rationale>
          <addressed-by>FAU_WID_EXT.1</addressed-by><rationale>Mitigates the threat by classifying wireless devices as benign or malicious based on device metrics, including throughput 
          (which may indicate a DoS threat).</rationale>
          <addressed-by>FAU_WID_EXT.2</addressed-by><rationale>Mitigates the threat by monitoring 802.11 wireless traffic in the vicinity for comparison against defined policies.</rationale>
          <addressed-by>FAU_WIP_EXT.1</addressed-by><rationale>Mitigates the threat by isolating confirmed threats to the internal network, either wired (unauthorized AP) or wireless.</rationale>
          <addressed-by>FMT_SMF.1/WIDS</addressed-by><rationale>Mitigates the threat by allowing configuration of rules, configuration, and other TOE operational settings.</rationale>
          <addressed-by>FAU_WID_EXT.3/BT (optional)</addressed-by><rationale>Mitigates the threat by monitoring Bluetooth wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/CELL (optional)</addressed-by><rationale>Mitigates the threat by monitoring cellular wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.3/RF (optional)</addressed-by><rationale>Mitigates the threat by monitoring non-802.11 wireless traffic in the vicinity for potential violations of policy.</rationale>
          <addressed-by>FAU_WID_EXT.4 (optional)</addressed-by><rationale>Mitigates the threat by using a dedicated sensor for analysis of wireless traffic.</rationale>
          <addressed-by>FAU_ANO_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining thresholds of baseline and anomalous traffic for analysis and action.</rationale>
          <addressed-by>FAU_SIG_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining signatures for an attack.</rationale>
          <addressed-by>FAU_INV_EXT.4 (objective)</addressed-by><rationale>Mitigates the threat by detecting non-authorized wireless equipment being attached to an internal wired network.</rationale>
          <addressed-by>FAU_INV_EXT.5 (objective)</addressed-by><rationale>Mitigates the threat by including a signal library.</rationale>
          <addressed-by>FAU_MAC_EXT.1 (objective)</addressed-by><rationale>Mitigates the threat by detecting when a device is attempting to spoof a trusted device's MAC address.</rationale>
          
        </threat>
      </threats>
    </section>
    <section title="Assumptions" id="assumption">
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner
            that ensures that the TOE's security policies will be enforced on all applicable network
            traffic flowing among the attached networks. </description>
          <consistency-rationale>This assumption defines the TOE’s placement in a network such that it is able to perform its required security functionality. 
            The Base-PP does not define any assumptions about the TOE’s architectural deployment so there is no conflict here.</consistency-rationale>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The operational environment objective OE.CONNECTIONS is realized through
              A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
          <consistency-rationale>This assumption is comparable to the A.TRUSTED_ADMINISTRATOR assumption from the Base-PP, applied to the specific administrative functions defined in this PP-Module.</consistency-rationale>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale> The operational environment objective OE.PROPER_ADMIN is realized through
              A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="osp"> 
      <OSPs>
        <OSP name="P.ANALYZE">
          <description>Analytical processes and information to derive conclusions about potential
            intrusions must be applied to WIDS data and appropriate response actions
            taken.</description>
          <consistency-rationale>This organizational security policy expects the data produced by the TSF about the behavior of external entities to be used in an organization’s analytical process. 
            There is no conflict with the Base-PP because the Base-PP does not define any functionality for the TOE to produce data about any entities other than itself.</consistency-rationale>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The organizational security policy P.ANALYZE is facilitated through
              O.WIDS_ANALYZE. </rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </sec:Security_Problem_Definition>
  <sec:Security_Objectives>

      <!-- NIAP: Make sure new SFRs are mapped to SOs -->
      <sec:Security_Objectives_for_the_Operational_Environment>
      The following security objectives for the operational
      environment assist the TOE in correctly providing its security functionality. These track the
      assumptions about the environment. <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that
            will allow the TOE to effectively enforce its policies on the network traffic of
            monitored networks. </description>
          <consistency-rationale>This objective expects the TOE to be placed in a network such that it is able to perform its required security functionality. 
            The Base-PP does not define any objectives about the TOE’s architectural deployment so there is no conflict here.</consistency-rationale>
        </SOE>
        <SOE name="OE.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
          <consistency-rationale>This objective is comparable to the OE.TRUSTED_ADMIN objective from the Base-PP, applied to the specific administrative functions defined in this PP-Module.</consistency-rationale>
        </SOE>
      </SOEs>
      </sec:Security_Objectives_for_the_Operational_Environment>

    <section title="Security Objectives Rationale" id="SOR">
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <base-pp version="3.0e" name="Network Device" product="Network Device" short="ND" id="b-nd">
      <url>https://www.niap-ccevs.org/protectionprofiles/482</url>
      <cPP/>
      <modified-sfrs>
                
        <section title="Security Audit (FAU)" id="ss-mod-fau">

          <base-sfr-spec cc-id="fau_gen_ext.1" title="Security Audit Data Generation for Distributed TOE Components" id="mod-nd-fau-gen-ext-1">
          <consistency-rationale>This PP-Module mandates the inclusion of this selection-based SFR because a TOE that conforms to this PP-Module will always be deployed in a configuration that requires this SFR to be claimed.</consistency-rationale>
          <description>
          <h:p>This SFR has been modified from its definition in the NDcPP to mandate the selection of options that correspond to distributed TOEs. A TOE that conforms to this PP-Module will always be a distributed TOE.</h:p>
          <h:p>The text of the requirement is replaced with:</h:p>
          <h:p>
            The TSF shall be able to generate audit records for each TOE component. The audit records generated by the TSF of each TOE component shall include the subset of security relevant audit events which can occur on the TOE component.
          </h:p>
          <h:p><h:b>Application Note:</h:b> This SFR is selection-based in the Base-PP but is mandated by this PP-Module because the ST author must claim a distributed TOE selection in FAU_STG_EXT.1.2.</h:p>
          </description>
          <replace>
          <!-- Note: This path does not yet exist because NDcPP is not (yet) in XML format. Including for syntactical purposes-->
          <xpath-specified xpath="*//cc:f-element[@id='fel-audit-gen']//cc:title">
          <title>The TSF shall be able to generate audit records for each TOE
                component. The audit records generated by the TSF of each TOE component shall include the
                subset of security relevant audit events which can occur on the TOE component.
              </title>
              <note role="application">This SFR is selection-based in the Base-PP but is mandated by this PP-Module because the ST author must claim a distributed TOE selection in FAU_STG_EXT.1.2.</note>
              <aactivity>
                <no-tests>
                  There is no change to the EAs specified for this SFR in the NDcPP SD. 
                The PP-Module modifies this SFR to make its inclusion mandatory rather than selection-based, but there is no change to how the SFR must be implemented.
                  </no-tests>
              </aactivity>  
          </xpath-specified>
          
          </replace>
          </base-sfr-spec>

          <base-sfr-spec cc-id="fau_stg_ext.1" title="Protected Audit Event Storage" id="mod-nd-fau-stg-ext-1">
            <consistency-rationale>This PP-Module modifies the Base-PP SFR to remove a selection that is not permitted by the TOE architecture that it specifies.</consistency-rationale>
            <description>
            <h:p>Any element not specified in this section is unchanged from its definition in the Base-PP.</h:p>
            <h:p><h:b>FAU_STG_EXT.1.2</h:b>: This SFR has been modified from its definition in the NDcPP to remove a selection that is not permitted by the architecture
            required by the PP-Module.</h:p>
            <h:p> The text of the requirement is replaced with:</h:p>
            <h:p>The TSF shall be able to store generated audit data on the TOE itself. In addition [<h:b>selection:</h:b>
            <h:ul>
              <h:li><h:i>The TOE shall be a distributed TOE that stores audit data on the following TOE components: [<h:b>assignment:</h:b> identification of TOE components]</h:i></h:li>
              <h:li><h:i>The TOE shall be a distributed TOE with storage of audit data provided externally for the following TOE components: 
              [<h:b>assignment:</h:b> list of TOE components that do not store audit data locally and the other TOE components to which they transmit their generated audit data]</h:i></h:li>
            </h:ul>
            ].
            </h:p>
            <h:p><h:b>Application Note:</h:b> This SFR is modified from its definition in the Base-PP by removing the selection option for the TOE to be standalone. 
              A TOE that conforms to this PP-Module is expected to be distributed.</h:p>
            </description>
            <replace>
            <!-- Note: This path does not yet exist because NDcPP is not yet in XML format. Including for syntactical purposes -->
            <xpath-specified xpath="*//cc:f-element[@id='fel-audit-store']//cc:title">
            <title>
                The TSF shall be able to store generated audit data on the TOE itself. In addition <selectables linebreak="yes"> 
                  <selectable>The TOE shall be a distributed TOE that stores audit data on the following TOE components: <assignable>identification of TOE components</assignable></selectable> 
                  <selectable>The TOE shall be a distributed TOE with storage of audit data provided externally for the following TOE components: 
                    <assignable>list of TOE components that do not store audit data locally and the other TOE components to which they transmit their generated audit data</assignable></selectable>
                </selectables>.
              </title>
            <note role="application">
              This SFR is modified from its definition in the Base-PP by removing the selection option for the TOE to be standalone. A TOE that conforms to this PP-Module is expected to be distributed.</note>
            </xpath-specified></replace>
          </base-sfr-spec>
          
        </section>
        <section title="Communications (FCO)" id="ss-mod-fco">
          
          <base-sfr-spec cc-id="fco_cpc_ext.1" id="nd-mod-fco-cpc-ext-1" title="Communication Partner Control">
            <consistency-rationale>This PP-Module mandates the inclusion of this optional SFR because it is required to implement functionality required by this PP-Module.</consistency-rationale>
            <description>
            <h:p>This SFR is mandated for inclusion by this PP-Module because the WIDS TOE is expected to be a distributed system. Any element not specified in this section is unchanged from its definition in the Base-PP.</h:p>
            <h:p><h:b>FCO_CPC_EXT.1.2: </h:b>This SFR has been modified from its definition in the NDcPP to specify which communications channels are acceptable for registration.</h:p>
            <h:p>The text of the requirement is replaced with: </h:p>
            <h:p>The TSF shall implement a registration process in which components establish and use a communications channel that uses [<h:b>selection: </h:b>
            <h:ul>
              <h:li><h:i>A channel that meets the secure channel requirements in [<h:b>selection: </h:b>FTP_ITC.1, FPT_ITT.1]</h:i></h:li>
              <h:li><h:i>A channel that meets the secure registration channel requirements in FTP_TRP.1/Join</h:i></h:li>
              <h:li><h:i>No channel</h:i></h:li>
            </h:ul>] for at least TSF data.</h:p>

            <h:p><h:b>Application Note:</h:b> This SFR is optional in the NDcPP but is mandated by this PP-Module because the WIDS TOE is expected to be a distributed system.</h:p>
            </description>
            <replace>
              <!-- Note: This path does not yet exist because NDcPP is not yet in XML format. Including for syntactical purposes. -->
              <xpath-specified xpath="*//cc:f-element[@id='fel-sec-chan-reg']//cc:title">
                <title>The TSF shall implement a registration process in which
                    components establish and use a communications channel that uses <selectables linebreak="yes">
                    <selectable>A channel that meets the secure channel requirements in 
                      <selectables><selectable>FTP_ITC.1</selectable>
                      <selectable>FPT_ITT.1</selectable>
                      </selectables></selectable>
                      <selectable>A channel that meets the secure registration channel requirements in FTP_TRP.1/Join</selectable>
                      <selectable>No channel</selectable>
                  </selectables>
                  for at least TSF data. 
              </title>
              </xpath-specified>
            </replace>
          </base-sfr-spec>
        </section>
        <section title="Protection of the TSF (FPT)" id="ss-mod-fpt">
          <base-sfr-spec cc-id="fpt_itt.1" title="Basic Internal TSF Data Transfer Protection" id="nd-mod-fpt-itt-1">
            <consistency-rationale>This PP-Module mandates the inclusion of this optional SFR because it is required to implement functionality required by this PP-Module.</consistency-rationale>
            <description>
              <h:p>This SFR is unchanged from its definition in the Base-PP, it is only mandated for inclusion because a TOE that 
                conforms to this PP-Module is expected to be a distributed system.</h:p>
              <h:p>This requirement ensures all communications between
                components of a distributed TOE is protected through the use of an encrypted
                communications channel. The data passed in this trusted communication channel are
                encrypted as defined in the protocol chosen in the selection. The ST author chooses
                the mechanisms supported by the TOE, and then ensures that the detailed protocol
                requirements in Appendix B of NDcPP corresponding to their selection are included in
                the ST, if not already present. 
              </h:p>
            </description>
            <no-change/>
          </base-sfr-spec>
        </section>
        <section title="Trusted Paths/Channels (FTP)" id="ss-mod-ftp">
          <base-sfr-spec cc-id="ftp_itc.1" title="Inter-TSF Trusted Channel" id="nd-mod-ftp-itc-1">
            <consistency-rationale>This PP-Module refines the Base-PP SFR to add a selection for a specific external entity that may be applicable to a TOE that conforms to this PP-Module.</consistency-rationale>
            <description>
              <h:p>This SFR is modified from its definition in the Base-PP to add a selection for database server capability. Any element not specified in this section is unchanged from its definition in the Base-PP. </h:p>
              <h:p>The text of the requirement is replaced with: </h:p>
              <h:p><h:b>FTP_ITC.1.1: </h:b>The TSF shall be capable of using [<h:b>selection: </h:b><h:i>IPsec, SSH <h:b>[v2]</h:b>, TLS <h:b>[1.2 or 1.3]</h:b>, DTLS, HTTPS</h:i>]
              to provide a trusted communication channel between itself and authorized IT entities supporting the following capabilities: audit server, [<h:b>selection: </h:b>
              <h:i>authentication server, <h:b>database server</h:b>, [<h:b>assignment: </h:b>other capabilities], no other capabilities</h:i>] that is 
              logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data 
              from disclosure and detection of modification of the channel data.</h:p>
              <h:p><h:b>Application Note: </h:b>
              If the TSF uses a separate database server to support its security-relevant functionality, this selection must be included in the ST.
              The intent of the database server is to store WIDS/WIPS data that must be queryable, such as events/alarms, triangulation calculations, 
              wireless spectrum analysis (including RF jammer/Denial of Service (DoS)), and packet capture analysis. Authorized Administrators must be permitted to view alarms, 
              raw event data, and any other data stored in the database. The Administrator must access the database through a trusted channel if done so remotely.</h:p>
              <h:p>The intent of this requirement is to provide a means by which a cryptographic protocol may be used to protect external communications 
              with authorized IT entities that the TOE interacts with to perform its functions. The TOE uses at least one of the listed protocols for 
              communications with the server that collects the audit information.</h:p>
              <h:p>If other authorized IT entities are protected, the ST author makes the appropriate assignments (for those entities) and selections 
              (for the protocols that are used to protect those connections). The ST author selects the mechanism or mechanisms supported by the TOE, 
              and then ensures that the detailed protocol requirements in Appendix B of NDcPP corresponding to their selection are included in the ST.</h:p>
              <h:p>TLS and DTLS are defined in the Functional Package for TLS. SSH is defined in the Functional Package for SSH.</h:p>
            </description>
            <replace>
            <xpath-specified xpath="*//cc:f-element[@id='fel-sec-chan-how']//cc:title">
              <title> The TSF shall be capable of using <selectables>
                  <selectable>IPsec</selectable>
                  <selectable>SSH <h:b>[v2]</h:b></selectable>
                  <selectable>TLS <h:b>[1.2 or 1.3]</h:b></selectable>
                  <selectable>DTLS</selectable>
                  <selectable>HTTPS</selectable>                
                    </selectables> to provide a trusted communication channel between itself and
                    authorized IT entities supporting the following capabilities: audit server, <selectables>
                      <selectable>authentication server</selectable>
                      <selectable><h:b>database server</h:b></selectable>
                      <selectable><assignable>other capabilities</assignable></selectable>
                      <selectable>no other capabilities</selectable>
                    </selectables> that is logically distinct from other communication channels
                  and provides assured identification of its end points and protection of the channel
                  data from disclosure and detection of modification of the channel data.
                </title>
            </xpath-specified></replace>
            <replace><xpath-specified xpath="*//cc:f-element[@id='fel-sec-chan-how']//cc:note">
              <note role="Application">
		            <h:p>
		            This SFR is modified from its definition in the Base-PP by 
                adding a selection for a database server capability. 
                If the TSF uses a separate database server to support its security-relevant functionality, 
                this selection must be included in the ST.</h:p><h:p>
                The intent of the database server is to store WIDS/WIPS data that must
                be queryable, such as events/alarms, triangulation calculations, wireless spectrum analysis (including RF jammer/Denial of Service (DoS)),
                and packet capture analysis. Authorized Administrators must be permitted to view alarms, raw event data, and any other data stored in the database.
                The Administrator must access the database through a trusted channel if done so remotely.
              </h:p><h:p>
                The intent of this requirement is to provide a means by
                which a cryptographic protocol may be used to protect external communications with
                authorized IT entities that the TOE interacts with to perform its functions. The TOE
                uses at least one of the listed protocols for communications with the server that
                collects the audit information. </h:p><h:p>  If
                other authorized IT entities are protected, the ST author makes the appropriate
                assignments (for those entities) and selections (for the protocols that are used to
                protect those connections). The ST author selects the mechanism or mechanisms
                supported by the TOE, and then ensures that the detailed protocol requirements in
                Appendix B of NDcPP corresponding to their selection are included in the ST.</h:p>
                <h:p>TLS and DTLS are defined in the <xref to="pkgTLS"/>. SSH is defined in the <xref to="pkgSSH"/>.</h:p>
	      </note>
            </xpath-specified></replace>
          </base-sfr-spec>
        </section>
      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module extends the Network Device cPP, the TOE type for the overall TOE
        is still WIDS/WIPS products. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
    </base-pp>
    <man-sfrs>
      <section id="sec-audit-table" title="Auditable Events for Mandatory SFRs">
        <audit-table id="at-mandatory" table="mandatory"/>
      </section>
      <section title="Security Audit (FAU)" id="ss-man-fau">
        <f-component cc-id="fau_arp.1" name="Security Alarms"> <!-- DONE -->
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <f-element id="fel-arp">
            <title> The TSF shall [<h:i>display an alert to Authorized Administrator in sufficient
              detail to include identity of APs and EUDs involved, signal strength, accurate event timestamp, description of alert and severity level and
              <selectables>
                <selectable id="pcap">capture raw frame traffic that triggered the violation</selectable>
                <selectable>no other actions</selectable>
              </selectables></h:i>] upon detection of a potential security violation.</title>
            <note role="application">
              <h:p>
                If "capture raw frame traffic that triggers the violation" is
                selected then FAU_STG.1/PCAP must be included in the ST. </h:p><h:p>
                FAU_SAA.1 defines the rules for monitoring the wireless traffic to detect for potential security violations. 
                FAU_INV_EXT.2 defines the information the TOE needs to collect for all APs and EUDs within range of the the TOE's sensors. Device attributes can then be individually filtered
                and/or selected in order to be displayed as part of the alert.
              </h:p>
            </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes where to find the WIDS alerts
                on the Administrator console/interface.
              </TSS>
              <Guidance> The evaluator shall use the operational guidance for instructions on where
                the alerts generated are displayed within the WIDS interface. If "capture raw frame traffic that triggers the violation is selected", the
                evaluator shall use the operational guidance to configure the traffic capture
                capabilities.
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall perform a series of events or generate traffic that
                    would successfully trigger an alert for each of the rules defined in FAU_SAA.1. The evaluator should verify and record
                    whether the TOE generated the alert for each rule, and provided sufficient details. The evaluator should also record the events
                    or traffic that was generated as each alert was attempted to be triggered and
                    record the details provided by the TOE in the alert. </test>
                  <test><h:i>[conditional]</h:i> If capturing of raw frames was selected, verify
                    that the packet capture was triggered and stored as appropriate.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Actions taken due to potential security violations</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <ext-comp-def title="Security Alarm Filtering" fam-id="FAU_ARP_EXT">
          <fam-behavior>This family defines requirements for suppression of audit events. It is intended to complement the FAU_ARP family already defined in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_arp_ext.1" name="Security Alarm Filtering"> <!-- DONE -->
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to implement a filtering mechanism to selectively suppress the generation of security alarms.</comp-lev>
          <management>No specific management functions have been identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_ARP.1 Security Alarms</dependencies>
          <f-element id="fel-drop-alerts">
            <title> The TSF shall provide the ability to apply <assignable>methods of
                selection</assignable> to selectively exclude alerts from being generated. </title>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to filter 
                WIDS/WIPS alerts.
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance includes
                instructions on enabling and disabling alerts.
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>                
                      <step>The evaluator shall use the operational guidance to enable/disable
                        detection of available detection capabilities through the WIDS administrator
                        interface. The evaluator shall then generate traffic that would successfully
                        trigger the alert. The evaluator should verify that the TOE generated the
                        alert. </step>
                      <step>The evaluator shall disable the alert. The evaluator shall then generate
                        events as in previous test that should successfully trigger the alert. The
                        evaluator shall verify that the TOE did not generate an alert. </step>                 
                </steplist>
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <f-component cc-id="fau_gen.1" name="Audit Data Generation (WIDS)" iteration="WIDS">  <!-- DONE -->      
          <consistency-rationale>This SFR iterates the FAU_GEN.1 SFR defined in the Base-PP to define auditable events for the functionality that is specific to this PP-Module.</consistency-rationale>
          <f-element id="fel-audit-gen-wids">
            <title> The TSF shall be able to generate audit data of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the <h:i>not specified</h:i> level of audit;</h:li>
                <h:li>[<h:i>Auditable events listed in the Auditable Events table (<xref to="at-mandatory"/>);</h:i></h:li>
                <h:li><h:i>Failure of wireless sensor communication</h:i>;</h:li>
                <h:li><h:i>Any authentication event listed in the Auditable Events table (<xref to="at-mandatory"/>)].</h:i></h:li>
              </h:ol>
            </title>
            <note role="application">
	            <h:p>
                The auditable events defined in <xref to="at-mandatory"/>
                are for the SFRs that are explicitly defined in this PP-Module and are intended to
                extend FAU_GEN.1 in the Base-PP. The events in the Auditable Events table should
                be combined with those of the NDcPP in the context of a conforming Security
                Target.</h:p><h:p> The Auditable Events tables for Optional, (<xref to="at-optional"/>), 
                Objective (<xref to="at-objective"/>), and Selection-Based (<xref to="at-sel-based"/>)
                 SFRs includes optional, objective and selection-based SFRs, respectively. 
                The auditing of optional, objective, and selection-based SFRs is only required if that 
                SFR is included in the ST. </h:p><h:p> Per FAU_STG_EXT.1 in the Base-PP, the TOE must 
                support transfer of the audit data to an external IT entity using a trusted channel. 
              </h:p>
	    </note>
          </f-element>
          <f-element id="fel-audit-what">
            <title> The TSF shall record within each audit record at least the following
              information: <h:ol type="a">
                <h:li>Date and time of the event, type of event, and subject identity (if
                  applicable);</h:li>
                <h:li>For each audit event type, based on the auditable event definitions of the
                  functional components included in the PP/ST, [<h:i>auditable events listed in
                    Auditable Events table (<xref to="at-mandatory"/>)</h:i>]. </h:li>
              </h:ol>
            </title>
            <note role="application"> The subject identity in this case is the allowlisted inventory
              item. </note>
            <aactivity>
              <TSS> There are no TSS evaluation activities for this SFR.
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR.
              </Guidance>
              <Tests>
		          <h:p>
		            The evaluator shall test the TOE’s ability to correctly generate audit records
                by having the TOE generate audit records in accordance with the evaluation activities
                associated with the functional requirements in this PP-Module. When verifying the
                test results, the evaluator shall ensure the audit records generated during testing
                match the format specified in the administrative guide, and that the fields in each
                audit record have the proper entries. </h:p><h:p> Note that the testing here can
                be accomplished in conjunction with the testing of the security mechanisms directly.
	      </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Any authentication event</audit-event-descr>
            <audit-event-info>Failed login attempts, successful login attempts, administrator logins, 
            changes to the WIDS native authentication system (creation of an account, deletion of an account, 
            modification of user accounts, changes to groups or group membership, attempts for privilege escalation)
            <comment>This appears to be a list of events that should be logged and not "additional audit record contents". If this 
            is the case, these should be defined as separate auditable events. If not, suggest making it more clear as to 
            how each of these details relate to the overarching "authentication event", e.x. for the first three, "Type of authentication attempt and its result (i.e.,
            administrator vs user, success or failure)".</comment></audit-event-info>
          </audit-event>
        </f-component>

        <ext-comp-def title="Intrusion Detection Methods" fam-id="FAU_IDS_EXT">
          <fam-behavior>This family defines requirements for supported methods of intrusion detection.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_ids_ext.1" name="Intrusion Detection System - Intrusion Detection Methods">
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to specify the methods of intrusion detection that it supports.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-ids-meth">
            <title> The TSF shall detect intrusions using<selectables>
                <selectable id="anoBased">anomaly-based</selectable>
                <selectable id="sigBased">signature-based</selectable>
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables> methods. </title>
            <ext-comp-def-title>            
              <title> The TSF shall detect intrusions using
                <assignable>detection strategies</assignable>
                methods. </title>
            </ext-comp-def-title>
            <note role="application">
	          <h:p>
		          At least one detection method must be selected. If multiple
              detection methods are supported, each supported method must be selected.
              </h:p><h:p> If anomaly-based detection is selected, then FAU_ANO_EXT.1 shall be
              included in the ST. If signature-based detection is selected, then FAU_SIG_EXT.1 shall
              be included in the ST.
	          </h:p>
            </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes which intrusion detection
                method(s) the TOE utilizes. If multiple methods are selected, the evaluator shall
                confirm that the TSS describes how the different methods are
                incorporated.
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to configure the TOE in order for it to detect such
                intrusions.
              </Guidance>
              <Tests> Depending on the detection technique used by the TOE, the evaluator shall
                confirm and note the existence of the capability and test for the appropriate
                selection-based requirements. </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <ext-comp-def title="Environmental Inventory" fam-id="FAU_INV_EXT">
          <fam-behavior>This family defines requirements for detection and inventorying of network assets in the TOE’s operational environment.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.1" name="Environmental Inventory">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to determine if inventoried objects are authorized or unauthorized.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Definition of inventory of authorized APs based on MAC address</h:li>
            <h:li>Definition of inventory of authorized EUDs based on MAC address</h:li>
          </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST: <h:ul>
              <h:li>Presence of allowlisted device</h:li>
            </h:ul>
          </audit>
          <dependencies>FAU_INV_EXT.2 Characteristics of Environmental Objects</dependencies>
          <f-element id="fel-ap-auth">
            <title> The TSF shall determine if a given AP is authorized based on <selectables>
              <selectable>MAC addresses</selectable>
              <selectable><assignable>other unique device identifier</assignable></selectable>
            </selectables>
            </title>
          </f-element>
          <f-element id="fel-eud-auth">
            <title> The TSF shall determine if a given EUD is authorized based on <selectables>
              <selectable>MAC addresses</selectable>
              <selectable><assignable>other unique device identifier</assignable></selectable>
            </selectables>
            </title>
          </f-element>
          <f-element id="fel-evesdropper">
            <title> The TSF shall detect the presence of non-allowlisted EUDs and APs in the Operational Environment. </title>
            <note role="application"> 
	            <h:p>
              This inventory is used as an allowlist to indicate to the WIDS which APs and EUDs are authorized members of the wireless network. The inventory of authorized APs and EUDs is configured by FMT_SMF.1/WIDS. </h:p><h:p> 
              The terminology used to describe an inventoried or allowlisted device may vary by vendor
              product. This PP-Module utilizes allowlisted to describe APs and EUDs that are part of
              the inventory and non-allowlisted to describe APs and EUDs that are not part of the
              inventory.
	            </h:p>
	          </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes how the presence of authorized
                EUDs and APs is presented by the TOE. The evaluator shall verify that the TSS
                includes where in the WIDS interface the list of detected APs and EUDs is
                displayed.
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to view authorized and unauthorized APs and EUDs that are within
                range of the TOE sensors.
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Per guidance in FMT_SMF.1/WIDS, add MAC Addresses or other unique device identifier 
                        for an AP and EUD to the allowlist.</step>
                      <step>Deploy the AP and EUD that were added to allowlist within the range of
                        the TOE's sensors.</step>
                      <step>Verify that the devices are classified as authorized.</step>
                      <step>Remove the EUD from the allowlist.</step>
                      <step>Verify that the EUD is classified as unauthorized.</step>
                      <step>Remove the AP from the allowlist.</step>
                      <step>Verify that the AP is classified as unauthorized.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy an allowlisted AP and EUD, and connect the EUD to the AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the allowlisted
                        AP and EUD that were just deployed. </step>
                      <step>If the AP and EUD are detected verify that they are classified as
                        allowlisted devices.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a non-allowlisted AP and EUD and connect the EUD to the
                        AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the
                        non-allowlisted AP and EUD that were just deployed.</step>
                      <step>If the AP and EUD are detected verify that they are not classified as
                        allowlisted devices.</step>
                    </steplist></test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Presence of allowlisted device</audit-event-descr>
            <audit-event-info>Type of device (AP or EUD)</audit-event-info>
            <audit-event-info>MAC Address</audit-event-info>
          </audit-event>
        </f-component>
        <!-- 
        <ext-comp-def title="Characteristics of Environmental Objects" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>  -->  
        <f-component cc-id="fau_inv_ext.2" name="Characteristics of Environmental Objects"> <!-- DONE -->
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to discover network assets in its operational environment and maintain an inventory of them based on collected attributes.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Definition of classification rules to detect rogue APs</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-detect-main">
            <title> The TSF shall detect the <h:ul>
              <h:li>Current RF band</h:li>
              <h:li>Current channel</h:li>
              <h:li>MAC Address</h:li>
              <h:li>Received signal strength</h:li>           
              <h:li>Device detection timestamps</h:li>
              <h:li>Classification of APs and EUDs</h:li>
              <h:li><selectables>
                    <selectable><assignable>other details</assignable></selectable>
                    <selectable>no other details</selectable>
                  </selectables></h:li>
              </h:ul>of all APs and EUDs within range of the TOE's wireless sensors.</title>
          </f-element>
          <f-element id="fel-detect-add">
            <title> The TSF shall detect the following additional details for all APs within range of the TOE's wireless sensors:<h:ul>
                <h:li>encryption</h:li>
                <h:li>number of connected EUDs.</h:li>
              <h:li>Received frames/packets</h:li>
              <h:li>Beacon rate</h:li>
              <h:li>SSID of AP (if not hidden).</h:li>
              </h:ul>
            </title>
            <note role="Application"> For detection of encryption type, the TSF should be able to
              differentiate between the different WLAN encryption methods and when no encryption is
              in use. </note>
          </f-element>
          <f-element id="fel-detect-ssid">
            <title> The TSF shall detect the following additional details for all EUDs within range of the TOE's wireless sensors:<h:ul>
                <h:li>SSID and BSSID of AP it is connected to.</h:li>
              <h:li>DHCP configuration.</h:li>
              </h:ul>
            </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS explains the capability of detecting the information specified in the requirements for all APs and EUDs within the TOE's wireless range.
              </TSS>
              <Guidance> The evaluator shall review the operational guidance in order to verify that
                there are instructions that show how to locate the device inventory mentioned
                above.
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an allowlisted AP, non-allowlisted AP and two allowlisted
                        EUDs.</step>
                      <step>Connect one allowlisted EUD to the allowlisted AP and one to the
                        non-allowlisted AP.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that current RF band, current channel, MAC Address, received signal strength, device detection timestamps, classification of device, are part of the information presented on the WIDS user interface for all the APs and EUDs detected. 
                        For APs verify that encryption, number of connected EUDs, SSID (if not hidden), received frames/packets and beacon rate are presented. 
                        For EUDs verify that the SSID and BSSID of AP it is connected and DHCP configuration is presented.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- 
        <ext-comp-def title="Location of Environmental Objects" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>  -->
        <f-component cc-id="fau_inv_ext.3" name="Location of Environmental Objects"> <!-- DONE -->
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to approximate the physical location of network assets in its operational environment based on triangulation of wireless emissions.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST: <h:ul>
            <h:li>Physical location and identification of AP or EUD</h:li>
          </h:ul>
          </audit>
          <dependencies>FAU_INV_EXT.2 Characteristics of Environmental Objects</dependencies>
          <f-element id="fel-detect-location">
            <title> The TSF shall detect the physical location of rogue APs and EUDs, and <selectables>
                <selectable>allow-listed APs</selectable>
                <selectable>allow-listed EUDs</selectable>
                <selectable>neighboring APs and EUDs</selectable>
                <selectable>no other devices</selectable>
                </selectables> to within <assignable>value equal or less than 25</assignable> feet of their actual location.
            </title>
          </f-element>
          <f-element id="fel-detect-signal">
            <title> The TSF shall detect received signal strength and <selectables>
                <selectable>RF power levels above a predetermined threshold</selectable>
                <selectable>no other characteristics</selectable>
              </selectables> of hardware operating within range of the TOE’s wireless sensors. </title>
            <aactivity>
              <TSS>
		            <h:p>
                  The evaluator shall verify that the TSS includes information on location
                  tracking, optimal number of sensors and sensor placement to meet the required level
                  of accuracy.</h:p><h:p> The evaluator shall verify that the TSS contains
                  information regarding the TSF’s ability to record signal strength of hardware
                  operating within range of its sensors.
                </h:p>
	            </TSS>
              <Guidance>
		          <h:p>
                The evaluator shall review the operational guidance for instructions on how
                to configure location tracking, how to load a location map (if applicable), and
                where in the TSF administrator interface the location of APs and EUDs can be
                viewed.</h:p><h:p> If the option for detection of RF power levels above a
                predetermined threshold is selected, the evaluator shall use the operational
                guidance to set or check what the threshold is in a given test. The evaluator should
                also verify that the operational guidance provides instruction on how to configure
                the TOE to generate an alert when the threshold is exceeded.
	            </h:p>
	            </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within 25 feet of the sensors.</step>
                      <step>Verify the TSF provides location tracking information about the
                        AP.</step>
                      <step>Verify the AP location presented is within 25 feet of the actual
                        location.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the current received signal strength is part of the
                        information presented on the WIDS user interface about the APs and
                        EUDs.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Location of AP or EUD</audit-event-descr>
            <audit-event-info>MAC address</audit-event-info>
            <audit-event-info>Device type</audit-event-info>
            <audit-event-info>Classification of device</audit-event-info>
            <audit-event-info>Sensor(s) that detected device</audit-event-info>
            <audit-event-info>Signal strength as received by detecting sensor(s)</audit-event-info>
            <audit-event-info>Proximity to detecting sensor(s)</audit-event-info>
          </audit-event>
        </f-component>
        
        <ext-comp-def title="Reporting Methods" fam-id="FAU_RPT_EXT">
          <fam-behavior>This family defines requirements for the format of generated reports.</fam-behavior>
        </ext-comp-def>
        <f-component name="Intrusion Detection System - Reporting Methods" cc-id="fau_rpt_ext.1">
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to implement a specified reporting mechanism for collected data for compatibility with third parties that may consume this data.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_GEN.1 Audit Data Generation</dependencies>
          <f-element id="fel-report-what">
            <title> The TSF shall provide <selectables linebreak="yes">
              <selectable>Syslog using <selectables>
                <selectable>defined API</selectable>
                <selectable>Syslog</selectable>
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables></selectable>
              <selectable>SNMP trap reporting using <selectables>
                <selectable>defined API</selectable>
                <selectable>Simple Network Management Protocol (SNMP)</selectable>
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables></selectable>
            </selectables> for reporting of collected data. </title>
            <note role="application"> Syslog and/or SNMP trap reporting can be used. At least one
              reporting method must be selected.
            </note>
          </f-element>
          <f-element id="fel-report-import">
            <title> The TSF shall provide the ability to import data, such as an allowlist of APs and EUDs, and WIDS/WIPS configuration files from the system using <selectables>
              <selectable>custom API</selectable>
              <selectable>Syslog</selectable>
              <selectable>common log format</selectable>
              <selectable>comma separated values (CSV)</selectable>
              <selectable><assignable>vendor detection method</assignable></selectable>
            </selectables>.
            </title>
            <note role="application"> The system must provide the ability to interact with an
              extensible interface to a third party wireless monitoring system for the purposes of
              importing data from the wireless system.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes which method the TOE utilizes.</TSS>
              <Guidance> There are no operational guidance activities for this SFR.</Guidance>
              <Tests> Depending on the detection technique used by the TOE, the evaluator shall
                confirm and note the existence of the capability. <testlist>
                  <test>
                    <steplist> 
                      <step>Deploy an allowlisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Confirm that the TSF can use the reporting mechanisms specified in the TSS.</step>
                      <step>Verify that the TSF can import and export observable event data in 
                        each of the formats specified in the TSS.
                        <!-- any
                        of the following formats:</step>
                      <h:ul>
                        <h:li>comma separated values (CSV)</h:li>
                        <h:li>common log format (CLF)</h:li>
                        <h:li>JavaScript Object Notation (JSON)</h:li>
                        <h:li>syslog</h:li>
                      </h:ul> --></step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <f-component cc-id="fau_saa.1" name="Potential Violation Analysis"> 
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <f-element id="fel-set-mon-rules">
            <title>The TSF shall be able to apply a set of rules in monitoring <h:b>the wireless
                traffic</h:b> and based upon these rules indicate a potential <h:b>malicious
                action</h:b>.</title>
          </f-element>
          <f-element id="fel-enforce-mon-rules">
            <title>The TSF shall enforce the following rules for monitoring <h:b>wireless traffic:</h:b>
              <h:ol type="a">
                <h:li><h:i>Accumulation or combination of <selectables>
                    <selectable><assignable>subset of defined auditable events</assignable></selectable>
                    <selectable>no defined auditable events</selectable></selectables>known to indicate a potential security violation</h:i>,</h:li>
                <h:li>[<h:i>Detection of non-allowlisted AP</h:i>,</h:li>
                <h:li><h:i>Detection of non-allowlisted EUD</h:i>,</h:li>               
                <h:li><h:i>Detection of authorized EUD establishing peer-to-peer (P2P) connection with any other EUD</h:i>,</h:li>
                <h:li><h:i>Detection of a single EUD, or multiple EUDs, bridging two network interfaces</h:i>,</h:li>
                <h:li><h:i>Detection of unauthorized point-to-point wireless bridges by allowlisted APs</h:i>,</h:li>        
                <h:li><h:i>Alert generated by violation of user defined signature</h:i>,</h:li>
                <h:li><h:i>Detection of ICS connection</h:i>,</h:li>
                <!-- (Removal from TRRT Query 1439) <h:li><h:i>Detection of traffic with excessive transmit power level</h:i>,</h:li> Removal from TRRT Query 1439-->         
                <h:li><h:i>Detection of MAC spoofing</h:i>,</h:li>
                <h:li><h:i>Detection of unauthorized AP broadcasting authorized SSIDs</h:i>,</h:li>
                <h:li><h:i>Detection of authorized AP broadcasting an unauthorized SSID</h:i>,</h:li>
                <h:li><h:i>Detection of allowlisted EUD connected to unauthorized SSID</h:i>,</h:li>
                <h:li><h:i>Detection of NULL SSID associations</h:i>,</h:li>              
                <h:li><h:i>Detection of active probing</h:i>,</h:li>
                <h:li><h:i>Detection of packet flooding/DoS/DDoS</h:i>,</h:li>
                <h:li><h:i>Detection of RF-based denial of service</h:i>,</h:li>
                <h:li><h:i>Detection of deauthentication flooding</h:i>,</h:li>
                <h:li><h:i>Detection of disassociation flooding</h:i>,</h:li>
                <h:li><h:i>Detection of request-to-send/clear-to-send abuse</h:i>,</h:li>             
                <h:li><h:i>Detection of unauthorized authentication scheme use</h:i>,</h:li>
                <h:li><h:i>Detection of unauthorized encryption scheme use</h:i>,</h:li>
                <h:li><h:i>Detection of unencrypted traffic</h:i>,</h:li>
                <h:li><h:i>Detection of allowlisted EUD or AP that is using weak/outdated WLAN protocols and protocol implementations</h:i>,</h:li>
                <h:li><h:i>Detection of extremely high numbers of client devices using a particular allowlisted AP</h:i>,</h:li> 
                <h:li><h:i>Detection of a high number of failed attempts to join the WLAN in a short period of time</h:i>,</h:li>
                <h:li><h:i>Detection of the use of active WLAN scanners (e.g. wardriving tools) to generate WLAN traffic, such as Probes, Auths, and Assoc frames</h:i>,</h:li>
                <h:li><h:i>Detection of the physical location of an identified WLAN threat by using triangulation</h:i>,</h:li>
                <h:li><h:i>Detection of an SSID using weak/unsupported/disallowed encryption options</h:i>,</h:li>
                <h:li><h:i>Detection of AP SSID larger than 32 bytes</h:i>,</h:li>
                <!-- <h:li><h:i>Detection of excessive WPS negotiations</h:i>,</h:li>-->
                <h:li><h:i><assignable>any other rules</assignable></h:i>.</h:li>
              </h:ol>           
            </title>
            <note role="Application">
	            <h:p>
              These rules are used to detect a potential security violation. 
              A malicious actor who has gained unauthorized access to the TSF possesses the ability to alter its configuration and overall security posture.
              Maintenance of the rules by adding, modifying or deletion of rules from the set of rules is handled by FMT_SMF.1/WIDS.</h:p><h:p>
              There is no expectation that the TOE classify or categorize audit records related to TSF configuration changes as malicious activity.
              If a potential security violation is detected the alert generated for the Administrator is handled by FAU_ARP.1.
	            </h:p>
            </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes the ability of the TOE to detect the network behavior described by the SFR. The evaluator shall verify that the TSS describes the methods that the TOE uses to detect the presence of unauthorized connections and unauthorized network traffic. The evaluator shall examine the TSS to verify that it describes the denial of service attacks that can be detected by the TOE. The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized WLAN authentication schemes and encryption schemes are used. The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized APs and EUDs send or receive unencrypted data. </TSS>
              <Guidance>                 
                If the ability of the TSF to detect the different potential security violations is configurable, the evaluator shall verify that the operational guidance provides instructions on how to configure the TOE.
                The TSF should generate an alert or audit event for all potential violations contained within rule set forth in FAU_SAA.1.
              </Guidance>
              <Tests>  
                <testlist>
                  <test><h:b>Detection of non-allowlisted AP</h:b>: 
                    <steplist>
                      <step>Deploy a non-allowlisted AP.</step>
                      <step>Verify that the AP is detected as a non-allowlisted AP.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of non-allowlisted EUD</h:b>:
                    <steplist>
                      <step>Deploy a non-allowlisted EUD.</step> 
                      <step>Verify that the EUD is detected as an non-allowlisted EUD.</step>             
                    </steplist>
                    <h:br/>
                  </test>               
                  <test><h:b>Detection of authorized EUD establishing peer-to-peer connection with any other EUD</h:b>:
                    <testlist>
                      <test> Create the following connections between two allowlisted EUDs. <h:ul>
                        <h:li>Windows ad hoc</h:li>
                        <h:li>Mac OS ad hoc</h:li>
                        <h:li>Linux ad hoc</h:li>
                        <h:li>Wi-Fi Direct</h:li>
                      </h:ul>
                      </test>
                      <test> Create the following connections between one allowlisted EUD and a
                        non-allowlisted EUD <h:ul>
                          <h:li>Windows ad hoc</h:li>
                          <h:li>Mac OS ad hoc</h:li>
                          <h:li>Linux ad hoc</h:li>
                          <h:li>Wi-Fi Direct</h:li>
                        </h:ul>
                      </test>
                    </testlist> Verify that alerts were generated by each of the connections in each test. 
                  </test>
                  <test><h:b>Detection of EUD bridging two network interfaces</h:b>:<h:br/>
                     Bridge two network interfaces on an allowlisted EUD (one must be the wireless card listed as allowlisted).                  
                    <steplist>
                      <step>Create a Windows Hosted Network with an allowlisted EUD. </step>
                        <step>Connect a different allowlisted EUD to the network.</step>
                    </steplist>
                    Verify that alerts were generated by each of the connections in each test.
                  </test>
                  <test><h:b>Detection of unauthorized point to point wireless bridges by allowlisted APs</h:b>:
                      <steplist>
                        <step>Setup a point-to-point wireless bridge using allowlisted APs in the
                          range of the wireless sensors.</step>
                        <step>Verify that the TSF detects the bridge.</step>
                      </steplist>
                    <h:br/>
                  </test>             
                  <test><h:b>Alert generated by violation of user defined signature</h:b>:
                      <steplist>
                        <step>Setup a user defined detection signature.</step>
                        <step>Verify that the TSF generates an alert once the rules of signature have been violated.</step>
                      </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of ICS connection</h:b>:                 
                       <steplist>
                         <step>Setup an Internet Connection Sharing (ICS) connection.</step>
                         <step>Verify that the TSF detects the establishment of the ICS connection.</step>
                       </steplist>
                    <h:br/>
                  </test>
                  <!--  (Removal from TRRT Query 1439) test><h:b>Detection of traffic with excessive transmit power level</h:b>:                
                       <steplist>
                         <step>Configure a source of network traffic that can exceed the maximum transmit
                             power levels of 100 mW on 2.4 GHz, 200 mW on 5 GHz, and 250 mW on 6 GHz.</step>
                         <step>Configure a user defined signature to detects traffic with transmit power levels
                             that exceed the maximum.</step>
                         <step>Commence with the transmission of network traffic at excessive power levels.</step>
                         <step>Collect wireless traffic with range of the TSF.</step>
                         <step>Verify that the TSF detects wireless traffic that exceeds
                          100 mW on 2.4 GHz, 200 mW on 5 GHz, and 250 mW on 6 GHz.</step>
                       </steplist>
                    <h:br/>
                  </test-->              
                  <test><h:b>Detection of MAC spoofing</h:b>:                
                    <testlist>
                      <test>
                        <steplist>
                          <step>Spoof mac address of an allowlisted EUD connected to an allowlisted AP on a
                            second EUD. </step>
                          <step>Connect EUD with spoofed MAC address to another allowlisted AP while the
                            valid EUD it is spoofing is connected to the first AP. </step>
                          <step>Verify that the TSF detected the MAC spoofing.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Spoof mac address of an allowlisted AP on a second AP. </step>
                          <step>Verify that the TSF detected the MAC spoofing.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized AP broadcasting authorized SSIDs</h:b>:
                    <steplist>
                      <step>Configure a non-allowlisted AP to operate on a set channel on the 2.4 GHz band broadcasting an authorized SSID.</step>
                      <step>Verify that the TSF detects the non-allowlisted AP broadcasting an authorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                      <step>Repeat the test utilizing the 6 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>                 
                  <test><h:b>Detection of authorized AP broadcasting an unauthorized SSID</h:b>:
                    <steplist>
                      <step>Configure an allowlisted AP to operate on a set channel on the 2.4 GHz band broadcasting an unauthorized SSID.</step>
                      <step>Verify that the TSF detects the non-allowlisted AP broadcasting an authorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                      <step>Repeat the test utilizing the 6 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of allowlisted EUD connected to unauthorized SSID</h:b>: 
                    <steplist>                    
                      <step>Configure an allowlisted AP to operate on a set channel on the 2.4 GHz band with an unauthorized SSID.</step>
                      <step>Connect an allowlisted EUD to the AP.</step>
                      <step>Verify that the TSF detects the allowlisted EUD associated to the allowlisted AP broadcasting an unauthorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                      <step>Repeat the test utilizing the 6 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of NULL SSID associations</h:b>:
                      <steplist>
                        <step>Deploy allowlisted AP.</step>
                        <step>Configure the AP to have null SSID.</step>
                        <step>Attempt to connect an allowlisted EUD to the AP without supplying the correct AP SSID.</step>
                        <step>Verify that the AP does not permit the EUD to complete an association by returning a Probe Request.</step>
                        <step>If an association does occur, confirm that an alert is triggered due to a violation of policy.</step>
                      </steplist>
                    <h:br/>
                  </test>              
                  <test><h:b>Detection of active probing</h:b>:
                    <steplist>
                      <step>Perform an active scan on the subnet of the WLAN.</step>
                      <step>Record tools used and type of scan performed. </step>
                      <step>Verify that the TSF detects the active probing.</step>
                    </steplist>
                    <h:br/>
                </test>
                  <test><h:b>Detection of packet flooding/DoS/DDoS</h:b>:
                    <steplist>
                      <step>Generate a large amount of TCP and UDP traffic from a single EUD.</step>
                      <step>Verify that the TSF detects the network-based DoS.</step>
                      <step>Generate a large amount of TCP and UDP traffic from multiple EUDs.</step>
                      <step>Verify that the TSF detects the network-based DDoS.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of RF-based denial of service</h:b>:                  
                    <steplist>
                      <step>Deploy an allowlisted AP and configure to stay in a particular channel.</step>
                      <step>Connect an allowlisted EUD to the AP.</step>
                      <step>Use an RF Jammer or signal generator on the same frequency as the AP and EUD to create a RF-based DoS.</step>
                      <step>Verify that the TOE detects the RF-based DoS.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of deauthentication flooding</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy allowlisted AP and configure to a set channel.</step>
                          <step>Connect an allowlisted EUD to the AP.</step>
                          <step>Send an flood of deauthentication frames to the EUD using the MAC address of allowlisted AP it is connected to.</step>
                          <step>Verify that the TSF detects the deauthentication flood.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy allowlisted AP and configure to a set channel.</step>
                          <step>Connect an allowlisted EUD to the AP.</step>
                          <step>Send an flood of deauthentication frames with the MAC address of allowlisted AP as the source and destination as a broadcast.</step>
                          <step>Verify that the TSF detects the deauthentication flood.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of disassociation flooding</h:b>:
                        <steplist>
                          <step>Deploy an allowlisted AP and connect authorized EUDs.</step>
                          <step>Generate disassociation frames from an unauthorized EUD.</step>
                          <step>Verify that the TSF detected the disassociation flooding.</step>
                        </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of request-to-send/clear-to-send abuse</h:b>:
                    <steplist>
                      <step>Deploy allowlisted AP and configure to a set channel.</step>
                      <step>Connect two allowlisted EUDs to the AP.</step>
                      <step>Send an flood of CTS frames to reserve RF medium.</step>
                      <step>Verify that the TSF detects the CTS abuse.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized authentication scheme use</h:b>:<h:br/>
                    The evaluator shall configure the TOE, per FMT_SMF.1/WIDS, with 802.1x authentication as the only mode of authorized WLAN authentication scheme. 
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy an allowlisted AP with open authentication.</step>
                          <step>Verify that the TSF detects the AP broadcasting an unauthorized authentication scheme. 
                            If detected the test is satisfied. If not detected perform steps 3 and 4.</step>
                          <step>Connect an allowlisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes. </step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy an allowlisted AP that uses pre-shared key authentication.</step>
                          <step>Verify that the TSF detects the AP broadcasting an unauthorized authentication scheme.
                            If detected the test is satisfied. If not detected perform steps 3 and 4.</step>
                          <step>Connect an allowlisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized encryption scheme use</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Configure the TOE with 128 bit AES encryption type as the only allowed encryption scheme.</step>
                          <step>Deploy an allowlisted AP with no encryption.</step>
                          <step>Connect an allowlisted EUD to AP.</step>
                          <step>Verify that the TOE detects the AP and the EUD using unauthorized encryption schemes.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Configure the TOE with 128 bit AES encryption type as the only allowed encryption scheme.</step>
                          <step>Deploy an allowlisted AP that uses TKIP encryption only.</step>
                          <step>Connect an allowlisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized encryption schemes.</step>
                        </steplist>
                      </test>
                    </testlist> 
                    <h:br/>
                  </test>            
                  <test><h:b>Detection of unencrypted traffic</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy an allowlisted AP with no encryption.</step>
                          <step>Connect an allowlisted EUD to AP and generate traffic.</step>
                          <step>Verify that the TOE detects unencrypted data frames being sent between the allowlisted AP and EUD.</step>
                          <step>Attempt to connect a non-allowlisted EUD to AP.</step>
                          <step>If the connection attempt succeeds, generate traffic from the non-allowlisted EUD and verify that the TSF detects unencrypted data frames being sent between the allowlisted AP and non-allowlisted EUD.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy a non-allowlisted AP with no encryption.</step>
                          <step>Connect an allowlisted EUD to AP and generate traffic.</step>
                          <step>Verify that the TSF detects unencrypted data frames being between the non-allowlisted AP and allowlisted EUD.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of allowlisted EUD or AP that is using weak/outdated WLAN protocols and protocol implementations</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP that utilizes the 802.11g or older WLAN protocol.</step>
                          <step>Verify that the TSF detects the weak/outdated WLAN protocol and generates an alert.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of extremely high numbers of client devices using a particular allowlisted AP</h:b>:                   
                    <steplist>
                          <step>Deploy an allowlisted AP.</step>
                          <step>Configure a threshold amount of client devices that can use a particular AP.</step>
                          <step>Connect enough client devices to the AP to purposely exceed the defined threshold.</step>
                          <step>Verify that the TSF detects when the client usage exceeds the threshold.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of a high number of failed attempts to join the WLAN in a short period of time</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP.</step>
                          <step>Configure a threshold amount of connection attempts that can occur in a particular timeframe.</step>
                          <step>Attempt to authenticate to the AP with enough client devices to purposely exceed the defined threshold.</step>
                          <step>Verify that the TSF detects when the connection attempts within the specific timeframe exceeds the threshold.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of the use of active WLAN scanners (e.g. wardriving tools) to generate WLAN traffic</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP.</step>
                          <step>Verify that the TSF detects when WLAN scanners are the source of WLAN traffic.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of the physical location of an identified WLAN threat by using triangulation</h:b>:
                    <steplist>
                          <step>Deploy a non-allowlisted AP or EUD within range of the TSF.</step>
                          <step>Verify that the TSF can track and locate the AP or EUD to within 25 feet.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of an SSID using weak/unsupported/disallowed encryption options</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP and configure its encryption options.</step>
                          <step>Change the encryption options the AP advertises.</step>
                          <step>Verify that the TSF detects when the AP's encryption options change.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of AP SSID larger than 32 bytes</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP and configure its SSID to be larger than 32 bytes.</step>
                          <step>Configure a user defined signature on the WIDS to detect when an SSID is larger than 32 bytes.</step>
                          <step>Verify that the TSF detects when the AP's SSID is larger than 32 bytes.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <!-- <test><h:b>Detection of excessive WPS negotiations</h:b>:
                    <steplist>
                          <step>Deploy an allowlisted AP and permit WPS authentication.</step>
                          <step>Configure a threshold amount of WPS connections that are allowed in a specific amount of time on the AP</step>
                          <step>Verify that the TSF detects when the AP's WPS connection threshold has been exceeded.</step>
                    </steplist>
                    <h:br/>
                  </test>-->
                  
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <ext-comp-def title="Wireless Intrusion Detection" fam-id="FAU_WID_EXT">
          <fam-behavior>This family defines requirements for data collection of potentially malicious wireless network activity.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.1" name="Wireless Intrusion Detection - Malicious Environmental Objects"> 
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to implement a mechanism to distinguish between authorized and unauthorized network assets.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Definition of authorized SSID(s)</h:li>
            <h:li>Definition of authorized WLAN authentication schemes</h:li>
            <h:li>Definition of authorized WLAN encryption schemes</h:li>
            <h:li>Definition of authorized WLAN traffic schemes</h:li> 
          </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST:<h:ul>
              <h:li>Detection of rogue AP or EUD</h:li>
              <h:li>Detection of unauthorized SSID</h:li>
            </h:ul>
          </audit>
          <dependencies>FAU_INV_EXT.1 Environmental Inventory</dependencies>
          <f-element id="fel-test-goodness">
            <title> The TSF shall distinguish between benign and malicious APs and EUDs based on if the APs and EUDs are authorized and <selectables>
              <selectable>automatic detection metrics</selectable>
              <selectable>no other method</selectable>
            </selectables>.</title>
            <note role="Application"> 
              FAU_INV_EXT.1 defines that an AP or EUD is authorized based on if the AP/EUD is allowlisted as configured in FMT_SMF.1. 
              A non-allowlisted device does not always have to be conducting malicious activity. 
              However, it is acceptable to equate an allowlisted AP/EUD as both authorized/benign and a non-allowlisted AP/EUD as both not authorized and thus malicious. 
              If the TOE supports automatic malicious device detection, based on in-depth network traffic analysis, "automatic detection metrics" must be selected. 
              This can be used to further distinguish if the AP/EUD is benign or malicious. If the TOE does not support automatic detection metrics, "no other method" must be selected.
            </note>
          </f-element>
          <f-element id="fel-test-ssid">
            <title> The TSF shall provide the ability to determine if a given SSID is authorized. </title>
            <note role="application"> FMT_SMF.1/WIDS defines the subset of authorized SSID(s). </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes how the TOE detects malicious
                APs/EUDs and whether the TOE supports automatic detection. The evaluator shall
                verify that the TSS includes how the TOE determines if a given SSID is authorized.
                </TSS>
              <Guidance> If TOE supports automatic detection, the evaluator shall
                verify that the operational guidance contains instructions for configuring the
                automatic detection metrics. The evaluator shall verify that the operational guidance
                provides instructions on how to configure SSIDs as authorized.</Guidance>
              <Tests>
                               
                  For test 1 and 2 below the evaluator shall verify that the TOE detects and appropriately classifies the APs and EUDs. It is acceptable if the TOE uses different but equivalent descriptors for the classification. If the TOE does not support automatic detection metrics and equates a non-allowlisted AP/EUD as malicious, than it is sufficient that the the classification given to the AP/EUD in step 1 is the same as in step 2. If the TOE supports automatic detection metrics and distinguishes between a non-allowlisted AP/EUD and a malicious AP/EUD, then the classification for the AP/EUD should differ between step 1 and step 2.
                    <testlist>                    
                      <test>
                        <steplist>
                          <step>Deploy a non-allowlisted AP in the area of the WIDS sensor, but take no action against the network. Verify that the AP is classified as non-authorized.</step>
                          <step>Deploy a non-allowlisted AP in the area of the WIDS sensor and launch an attack against the network. This can be any variation of Fake AP, Spoof AP, Flood or DoS attack.</step> 
                          <step>Verify that the AP is classified as malicious.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy a non-allowlisted EUD in the area of the WIDS sensor, but take no action against the network. Verify that the EUD is classified as non-authorized.</step>
                          <step>Launch an RF Flooding, DoS/DDoS, masqueraded or spoofing attack against authorized AP with an unauthorized EUD.</step> 
                          <step>Verify that the EUD is classified as malicious.</step>                        
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy an AP with an unauthorized SSID in the area of the WIDS sensor.</step>
                          <step>Verify that the TOE detects the unauthorized SSID.</step>
                        </steplist>
                      </test>
                    </testlist>
                  
                
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Detection of rogue AP or EUD</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Detection of unauthorized SSID</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
 <!--       <ext-comp-def title="Passive Information Flow Monitoring" fam-id="FAU_WID_EXT">
          <fam-behavior/>
        </ext-comp-def> -->
        <f-component cc-id="fau_wid_ext.2" name="Wireless Intrusion Detection - Passive Information Flow Monitoring">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to surveil certain wireless frequency bands and perform stateful inspection of traffic on them.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Definition of authorized and unauthorized TCP/IP and UDP traffic</h:li>
            <h:li>Definition of known malicious activity ports</h:li>
            <h:li>Definition of the amount of time that a sensor monitors a specific frequency or channel</h:li>
          </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST: <h:ul>
            <h:li>Sensor wireless transmission capabilities</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-monitor-freq">
            <title> The TSF shall <selectables>
                <selectable>simultaneously</selectable>
                <selectable id="s-nonsimult">nonsimultaneously</selectable>
              </selectables> monitor and analyze network traffic matching the 802.11 monitoring SFP
              for all channels in the following RF frequencies: <h:ul>
                <h:li>2.4 GHz</h:li>
                <h:li>5.0 GHz</h:li>
                <h:li>6.0 GHz</h:li>
              </h:ul> and
              <selectables linebreak="yes">
                <selectable><assignable>specified Wi-Fi channels</assignable> in the 4.9 GHz regulatory domain</selectable>
                <selectable>channels outside regulatory domain</selectable>
                <selectable>non-standard channel frequencies</selectable>
                <selectable>no other domains</selectable>
            </selectables>. </title>
	          <ext-comp-def-title>
              <title> The TSF shall <selectables>
                  <selectable>simultaneously</selectable>
                  <selectable>nonsimultaneously</selectable>
                </selectables> monitor and analyze network traffic matching the 802.11 monitoring SFP
                for all channels in the following RF frequencies:
                <assignable>a list of frequency ranges</assignable>.</title>
	          </ext-comp-def-title>
            <note role="Application"> 
	          <h:p>
              If <xref to="s-nonsimult"/> is selected, then <xref to="s-mon-spec-chan"/> must be selected in FMT_SMF.1/WIDS.
            </h:p>
	          <h:p> The "802.11 monitoring SFP" is a security function policy and the SFRs
              that reference this policy describe what the policy does. The "802.11 monitoring SFP"
              is established in FDP_IFC.1 and defined through FAU_WID_EXT.1, FAU_WID_EXT.2,
              in addition to optional SFRs
              FAU_WID_EXT.3/RF and FAU_WID_EXT.4. A vendor does not have to formally define this
              policy, it only needs to comply with the SFRs.</h:p></note>
          </f-element>
          <f-element id="fel-detect-network-traffic">
            <title> The TSF shall provide wireless sensors to detect network traffic matching the
              802.11 monitoring SFP that <selectables>
                <selectable>can be configured to prevent transmission of data</selectable>
                <selectable>does not transmit data</selectable>
              </selectables>. </title>
            <note role="application"> 
	          <h:p>
              If "can be configured to prevent transmission of data" is
              selected then "Enable/Disable transmission of data by wireless sensor" must be
              selected in FMT_SMF.1/WIDS. </h:p><h:p> 
              The intent of this SFR is to employ WIDS
              sensors that can have all wireless transmission capabilities disabled for instances
              where a site wishes to implement a no wireless policy. </h:p><h:p>  
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe
              what the policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1 and
              defined through FAU_WID_EXT.1, FAU_WID_EXT.2, in addition to optional SFRs FAU_WID_EXT.3/RF and FAU_WID_EXT.4. A vendor
              does not have to formally define this policy, it only needs to comply with the SFRs.
	          </h:p>
            </note>
          </f-element>
          <f-element id="fel-frame-inspect">
            <title> The TSF shall perform stateful frame inspection and log attacks spanning
              multiple frames. </title>
            <note role="application"> 
              Attackers possess the capability to distribute an attack
              across multiple frames in an attempt to avoid traditional detection measures that
              solely focus on packet headers. Stateful frame inspection will allow for the
              identification of obfuscation techniques centered around spreading an attack across
              multiple frames.</note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes which channels the TOE can
                detect and monitor. Additionally, the TSS shall include whether the TOE
                simultaneously or nonsimultaneously monitors network traffic across these channels.
                The evaluator shall verify that the TSS includes information on if the sensors are
                completely passive, by default, or if the sensors ability to transmit data is
                configurable. </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance for how to configure
                the TOE to monitor the channels as selected in the SFR. If the sensor ability to
                transmits data is configurable, the evaluator shall review the operational guidance
                for how to disable wireless transmissions from the sensor. The evaluator shall verify that the operational guidance provides
                instructions on how to specify and confirm that stateful frame capture and
                inspection is being performed.</Guidance>
              <Tests>
                <h:b>Channels Monitored</h:b>
                <testlist>
                  <test> Channels on On 5 GHz band <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy an AP on at least 2 different channels within the regulatory
                        domain on 5 GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Channels on 2.4 GHz band <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels within the regulatory domain
                        on 2.4 GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Channels on 4.9 GHz band (if selected)<steplist>
                    <step>Configure the TSF to monitor the channels specified in the SFR.</step>
                    <step>Deploy AP and set to channels within the 4.9 GHz band outlined in the TSS.</step>
                    <step>Verify that the AP gets detected on each channel tested.</step>
                  </steplist>
                  </test>
                  <test> Channels on 6 GHz band (if selected)<steplist>
                    <step>Configure the TSF to monitor the channels specified in the SFR.</step>
                    <step>Deploy AP and set to channels within the 6 GHz band outlined in the TSS.</step>
                    <step>Verify that the AP gets detected on each channel tested.</step>
                  </steplist>
                  </test>
                  <test> Non-standard channel frequencies (if selected)<steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels on non-standard channel
                        frequencies.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Channels outside regulatory domain (if selected)
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy an AP on at least 2 different channels outside the regulatory domain on 5GHz band.</step>
                      <step>Deploy AP on at least 2 different channels outside the regulatory domain on 2.4GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                </testlist>
		<h:p><h:b>Wireless Sensor Transmission of Data</h:b></h:p><h:p> 
                If the TOE provides the ability to disable wireless transmission, the evaluator shall follow the operational guidance to configure the sensor to not transmit wirelessly. The evaluator shall then deploy a signal analyzer in order to check for wireless emanations from the TOE. <h:br/> 
                Repeat the two tests below, for both the 2.4 GHz, 5 GHz, and 6 GHz band.<h:br/> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Boot a sensor and using the signal analyzer observe to check if any
                        emanations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>During normal sensor operations, observe the analyzer for about 10
                        minutes to check if any emanations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                </testlist>              
                <h:b>Stateful Frame Inspection</h:b>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy allowlisted AP.</step>
                      <step>Connect an allowlisted EUD to the AP.</step>
                      <step>Deploy a protocol analyzer or native capability within the WIDS Controller between the AP and EUD.</step>
                      <step>Verify from the network traffic packet capture that all frames are being inspected to validate their connection state from the TSF</step>
                    </steplist>
                  </test>
                </testlist>
	      </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Sensor wireless transmission capabilities</audit-event-descr>
            <audit-event-info>Wireless transmission capabilities are turned on.</audit-event-info>
          </audit-event>
        </f-component>        
      </section>

      <section title="User Data Protection (FDP)" id="ss-man-fdp">
        <f-component cc-id="fdp_ifc.1" name="Subset Information Flow Control">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <f-element id="fel-detect-frame-types">
            <title> The TSF shall enforce the [<h:i>802.11 monitoring SFP</h:i>] on [<h:i>all IEEE
                802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <h:ul>
                <h:li><h:i>authorized APs and authorized EUDs </h:i></h:li>
                <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                <h:li><h:i>unauthorized APs and authorized EUDs</h:i>].</h:li>
              </h:ul>
            </title>
            <note role="application"> 
	          <h:p>
	            "Authorized" EUDs/APs are those that are assigned to the
              allowlist as defined by FMT_SMF.1/WIDS. </h:p>
	          <h:p> 
              The "802.11 monitoring SFP" is
              a security function policy and the SFRs that reference this policy describe what the
              policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1 and defined
              through FAU_WID_EXT.1, FAU_WID_EXT.2,
              in addition to optional SFRs FAU_WID_EXT.3/RF and FAU_WID_EXT.4. A vendor does not have
              to formally define this policy, it only needs to comply with the SFRs.
            </h:p></note>
            <aactivity>
              <TSS> There are no TSS evaluation activities for this SFR.</TSS>
              <Guidance> If this functionality is configurable, the evaluator shall verify that the
                operational guidance provides instructions on how to configure the TOE to monitor
                different types of IEEE 802.11 frame types and subtypes.</Guidance>
              <Tests>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Deploy an allowlisted AP/WIDS</h:li>
                      <h:li>Start a traffic capture from the AP/WIDS sensor</h:li>
                      <h:li>Send a set number of frames to the sensor for all IEEE 802.11 a, b, g, n, ac frame types and subtypes from/to the following:<h:ul>
                          <h:li><h:i>authorized APs and authorized EUDs</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs</h:i></h:li>
                        </h:ul></h:li>
                      <h:li>Verify that there are frames from all the types and subtypes in the
                        capture. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>

      <section title="Security Management (FMT)" id="ss-man-fmt">
        <f-component cc-id="fmt_smf.1" name="Specification of Management Functions (WIDS)" iteration="WIDS">
          <consistency-rationale>This SFR iterates the FMT_SMF.1 SFR defined in the Base-PP to define management functions for the functionality that is specific to this PP-Module.</consistency-rationale>
          <f-element id="fel-management-functions">
            <title> The TSF shall be capable of performing the following management functions <h:b>for WIDS functionality</h:b> [:
            <h:i>
              <h:ul>
                <h:li>Define an inventory of authorized APs based on <selectables>
                  <selectable>MAC addresses</selectable>
                  <selectable><assignable>other unique device identifier</assignable></selectable>
                </selectables>,</h:li><!-- FAU_INV_EXT.1.1 -->
                <h:li>Define an inventory of authorized EUDs based on MAC addresses,</h:li><!-- FAU_INV_EXT.1.1 -->
                <h:li>Define rules for monitoring and alerting on the wireless traffic,</h:li><!-- FAU_SAA.1.1 -->
                <h:li>Define authorized SSID(s),</h:li><!-- FAU_WID_EXT.2.3 -->
                <h:li>Define authorized WLAN authentication schemes,</h:li><!-- FAU_SAA.1 -->
                <h:li>Define authorized WLAN encryption schemes,</h:li><!--FAU_SAA.1  -->
                <!-- New: (e.g. Floods of deauthentication frames or SYN packets should not be allowed). Defining authorized
                                and unauthorized TCP/IP and UDP traffic would be beneficial. Defining known malicious activity ports
                                that are used, or detecting the use of SSH tunneling techniques could be an appropriate mitigation strategy. 
                                This would of course also be accomplished at the network's boundary, and should not fall solely on the WIDS to
                                detect, but having some form of network traffic scheme-of-detection seems appropriate. Update: Having the WIDS track, manage, define
                                WLAN traffic schemes has been removed. This function should not reside on the WIDS, an an overlay solution has no visibility into 
                                WLAN traffic due to encryption. -->
                
                <h:li><selectables>
                    <selectable>Specify periods of network activity that constitute baseline of expected behavior</selectable><!-- FAU_ANO_EXT.1-->
                    <selectable>Define anomaly activity</selectable><!-- FAU_ANO_EXT.1.2 -->
                    <selectable>Define classification rules to detect rogue APs</selectable><!-- FAU_WID_EXT.1.1 -->
                    <selectable><selectables>
                        <selectable>enable</selectable>
                        <selectable>disable</selectable>
                      </selectables> transmission of data by wireless sensor</selectable><!-- FAU_WID_EXT.2.2 -->
                    <selectable>Define attack signatures</selectable><!-- FAU_SIG_EXT.1.1 -->
                    <selectable>Define rules for overwriting previous packet captures</selectable><!-- FAU_STG_EXT.1.3/PCAP -->
                    <selectable id="s-mon-spec-freq">Define the amount of time sensor monitors a specific frequency </selectable>
                    <selectable id="s-mon-spec-chan">Define the amount of time sensor monitors a specific channel </selectable>
                    <selectable>Define authorized and unauthorized TCP/IP and UDP traffic</selectable>
                    <selectable>Define known malicious activity ports</selectable>
                    <selectable>No other capabilities</selectable>
                  </selectables></h:li>
              </h:ul>
              </h:i> ].
            </title>
            <note role="application"> 
              <h:p>
                Define authorized WLAN authentication and encryption schemes
                does not enforce, but rather establishes a baseline to determine if an unauthorized
                scheme is used.</h:p><h:p> 
                If FAU_ANO_EXT.1 is included in the ST, "Specification
                of periods of network activity that constitute baseline of expected behavior" must be
                selected. If FAU_ANO_EXT.1 is included in the ST and "manual configuration by
                administrators" is selected in FAU_ANO_EXT.1, then "Definition of anomaly activity"
                must be selected.</h:p><h:p> 
                If "can be configured to prevent transmission of
                data" is selected in FAU_WID_EXT.2 then "Enable/Disable transmission of data by
                wireless sensor" must be selected.</h:p><h:p> 
                It is expected that an Authorized
                Administrator will be responsible for configuring the AP to operate on a specific
                frequency pursuant to the 802.11 standard. The TSF will have the ability to adjust
                the amount of time it passively monitors and captures WLAN traffic on a given
                frequency and channel. 
              </h:p></note>
            <aactivity>
            <TSS>
	            <h:p>
	              The evaluator shall review the TSS to verify that it includes information on the
                ability of the TOE to define inventory of authorized APs and EUDs.</h:p><h:p> 
               The evaluator shall verify that the TSS describes the ability of the TOE to
               allow authorized administrators to define authorized WLAN authentication
               schemes.</h:p>
	          </TSS>
	          <Guidance> 
	            <h:p>
                The evaluator shall review the operational guidance for instructions on how
                to configure and change classification of APs and EUDs to indicate that they are part
                of the allowlist.</h:p><h:p> 
                The evaluator shall review the operational guidance to determine how to configure which SSIDs are permitted on the network.</h:p><h:p>

                The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN authentication scheme as authorized or
                unauthorized for the purposes of detection.</h:p><h:p>

                The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN encryption scheme as authorized or
                unauthorized for the purposes of detection.</h:p>
	          </Guidance>

            <Tests> 
              <testlist>
                <test> The evaluator shall define an inventory of authorized APs and EUDs. The ability to detect allowlisted and non-allowlisted APs and EUDs will be tested in FAU_INV_EXT.1 and FAU_SAA.1.
                </test>
                <test>The evaluator shall define authorized SSIDs. The ability to detect authorized and unauthorized SSIDs will be tested in FAU_WID_EXT.2.3 and FAU_SAA.1.</test>
              
                <test>The evaluator shall configure the TSF with a set of allowed authentication and encryption
                  schemes. The ability to detect violation of this policy will be tested in FAU_SAA.1. </test>
                  <test> (conditional): If "Define the amount of time sensor monitors a specific frequency or channel" is selected:
                    <steplist>
                      <step>Deploy an allowlisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Verify that the TSF can be configured to capture traffic on a specific
                        channel for specific interval of time, and assign a specified frequency and
                        time interval.</step>
                      <step>Confirm that the TSF remains on the frequency and channel for the
                        time period specified.</step>
                    </steplist>
                  </test>
              </testlist>
            </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
    </man-sfrs>
    <opt-sfrs>
      <section id="sec-opt-audit-table" title="Auditable Events for Optional SFRs">
        <audit-table id="at-optional" table="optional"/>
      </section>
      <section title="Security Audit (FAU)" id="ss-opt-fau">

        <!-- invisible un-iterated SFR for the ECD -->
        <f-component status="invisible" cc-id="fau_wid_ext.3" name="Wireless Intrusion Detection - Spectrum Monitoring">
        <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to surveil specified radio frequency bands or protocols to detect potential unauthorized devices.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST: <h:ul>
          <h:li>Detection of network devices operating in selected RF bands and/or protocols</h:li>
          </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element>
            <title>
              The TSF shall detect the presence of devices <selectables linebreak="yes">
              <selectable>that operate in the following RF bands: <assignable>RF bands</assignable></selectable>
              <selectable>that operate a specified protocol and take a specified action: <assignable>specify protocol and action</assignable></selectable>
              </selectables>.
            </title>
          </f-element>
          
        </f-component>
        <f-component cc-id="fau_wid_ext.3" iteration="RF" name="Wireless Intrusion Detection - Spectrum Monitoring (Non-Wireless RF)">
        <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>  
          <f-element id="fel-detect-devices-in-bands">
            <title> The TSF shall detect the presence of devices <h:i>that operate in the
              following RF bands:</h:i> [<h:i><selectables>
                <selectable>3.6 GHz</selectable>
                <selectable>6 GHz</selectable>
                <selectable>60 GHz</selectable>
                <selectable>sub-GHz (0-900 MHz)</selectable>
                <selectable id="cell">all cellular bands</selectable>
              </selectables></h:i>].
            </title>
            <note role="application"> This SFR refers to Non-WLAN (IEEE 802.11 a, b, g, n, y, ac, ad and ay)
              network devices that operate in the specified frequencies. There is an understanding that this 
              capability requires a TOE to use specialized, licensed radio systems. This SFR will allow for the introduction of an
              open API, set of defined interoperability standards, or other proprietary solution(s), to allow for third-party
              integration.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the set of RF bands and
                technologies that the TSF can detect the use of. The TSS should also include
                instructions on how to enable and the hardware that is necessary for the additional
                band detection. </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure detection of the technologies included in the ST as well as the
                hardware that is needed to perform this function.</Guidance>
              <Tests> The evaluator shall enable and configure detection of the selected
                technologies. <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects
                    the device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Detection of network devices operating in selected RF bands</audit-event-descr>
            <audit-event-info>Frequency band</audit-event-info>
            <audit-event-info>Channel used within frequency band</audit-event-info>
            <audit-event-info>Identification information (MAC address if applicable or other similar unique ID)</audit-event-info>
            <audit-event-info>Device technology (i.e. cellular)</audit-event-info>
            <audit-event-info>Sensor(s) that detected devices</audit-event-info>
          </audit-event>
        </f-component>
        
        <f-component cc-id="fau_wid_ext.3" iteration="BT" name="Wireless Intrusion Detection - Spectrum Monitoring (Bluetooth)">
        <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <f-element id="fel-detect-devices-in-bands">
            <title> The TSF shall detect the presence of devices <h:i>that operate a specified
            protocol and take a specified action: </h:i>[<h:i>
              <selectables linebreak="yes">
                <selectable>Detect and log the presence of 2.4 GHz Bluetooth BR/EDR devices operating within a controlled space</selectable>
                <selectable>Detect and log the presence of Bluetooth Low Energy (BLE) devices operating within a controlled space</selectable>
                <selectable>Detect and log the the Bluetooth BR/EDR devices LAP and half the Bluetooth MAC address within a controlled space</selectable>
                <selectable>Detect and log the BLE device's Bluetooth MAC address within a controlled space</selectable>
                <selectable>Geo-locate Bluetooth BR/EDR devices within 25 feet of their actual location</selectable>
                <selectable>Geo-locate BLE devices within 25 feet of their actual location</selectable>
                <selectable>Detect and log Bluetooth BR/EDR devices conducting the Inquiry Procedure within a controlled space</selectable>
                <selectable>Detect and log Bluetooth BR/EDR devices responding to the Inquiry Procedure within the controlled space</selectable>
                <selectable>Capture and log any device information transmitted during the Bluetooth BR/EDR Inquiry Procedure when occurring within a controlled space</selectable>
                <selectable>Detect and log BLE devices advertisements on the Advertisement channels</selectable>
                <selectable>Detect and log BLE devices exchanging information or data on the Advertisement channels</selectable>
                <selectable>Detect and log Bluetooth BR/EDR devices using the SDP procedure</selectable>
                <selectable>Capture and log any device information exchanged during the Bluetooth BR/EDR SDP procedure</selectable>
                <selectable>Detect and log any Bluetooth BR/EDR devices performing the Paging Procedure</selectable>
                <selectable>Detect and log any BLE device performing the Paging Procedure</selectable>
                <selectable>Detect and log the piconet membership of any Bluetooth BR/EDR device. This includes role in the piconet (Central or Peripheral), piconet ID, device ID, and number of piconets which they are members of</selectable>
                <selectable>Detect and log the piconet membership of any Low Energy (LE) device. This includes role in the piconet (Central or Peripheral), piconet ID, device ID, and number of piconets which they are members of</selectable>
                <selectable>Use Bluetooth BR/EDR Inquiry Procedure to detect Bluetooth BR/EDR devices in discoverable mode within a controlled area</selectable>
                <selectable>Use Bluetooth BR/EDR SDP procedure to gether information about Bluetooth BR/EDR devices within a controlled area</selectable>
                <selectable>Use BLE SDP procedure to gather information about BLE devices within a controlled area</selectable>
              </selectables></h:i>].
            </title>
            <note role="application"> This SFR refers to Bluetooth and Bluetooth Low-Energy (BLE) (IEEE 802.15)
              network devices that operate in the specified frequencies. There is an understanding that this 
              capability requires a TOE to use specialized, licensed radio systems. This SFR will allow for the introduction of an
              open API, set of defined interoperability standards, or other proprietary solution(s), to allow for third-party
              integration.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the set of RF bands and
                technologies that the TSF can detect the use of. The TSS should also include
                instructions on how to enable and the hardware that is necessary for the additional
                band detection. </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure detection of the technologies included in the ST as well as the
                hardware that is needed to perform this function.</Guidance>
              <Tests> The evaluator shall enable and configure detection of the selected
                technologies. <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects
                    the device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Detection of Bluetooth devices (for each selection made that includes an action of "log")</audit-event-descr>
            <audit-event-info>Information contained within each selection that contains a requirement to log information.
            <comment>It is unclear what information needs to be logged to constitue the logging of a particular Bluetooth device. This applies to
            selections that include logging the presence of a Bluetooth device, as well as selections that include logging a device
            that carries out a particular action, such as performing a particular procedure.</comment>
            </audit-event-info>
          </audit-event>
        </f-component>

        <f-component cc-id="fau_wid_ext.3" iteration="CELL" name="Wireless Intrusion Detection - Spectrum Monitoring (Cellular)">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <f-element id="fel-detect-devices-in-bands">
            <title> The TSF shall detect the presence of devices <h:i>that operate a specified protocol
            and take a specified action: </h:i> [<h:i><selectables linebreak="yes">
                <selectable>Detect and log the presence of cellular 3G devices operating within a controlled space</selectable>
                <selectable>Detect and log the presence of cellular 4G/LTE devices operating within a controlled space</selectable>
                <selectable>Detect and log the presence of cellular 5G low and mid-band devices operating within a controlled space</selectable>
                <selectable>Detect and identify base stations which had clients within the area monitored by the WIDS</selectable>
                <selectable>Capture temporary identifiers (e.g. TMSI) of cellular devices within a controlled space</selectable>
                <selectable>Detect and identify which cellular technology (such as 3G, LTE, UTMS, 5G, etc.) the cellular device is using within a controlled space</selectable>
                <selectable>Detect and identify which cellular carrier a cellular device is using within a controlled space</selectable>
                <selectable>Detect and identify which base station a cellular device is connnected to while operating within a controlled space</selectable>
                <selectable>Detect and identify whether a cellular device is using a cellular uplink or downlink operating within a controlled space</selectable>
                <selectable>Geo-locate cellular devices operating within the operation area of the WIDS</selectable>
              </selectables></h:i>].
            </title>
            <note role="application"> This SFR refers to Bluetooth and Bluetooth Low-Energy (BLE) (IEEE 802.15)
              network devices that operate in the specified frequencies. There is an understanding that this 
              capability requires a TOE to use specialized, licensed radio systems. This SFR will allow for the introduction of an
              open API, set of defined interoperability standards, or other proprietary solution(s), to allow for third-party
              integration.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the set of RF bands and
                technologies that the TSF can detect the use of. The TSS should also include
                instructions on how to enable and the hardware that is necessary for the additional
                band detection. </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure detection of the technologies included in the ST as well as the
                hardware that is needed to perform this function.</Guidance>
              <Tests> The evaluator shall enable and configure detection of the selected
                technologies. <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects
                    the device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Detection of cellular devices (for each selection made that includes an action of "log")</audit-event-descr>
            <audit-event-info>Information contained within each selection that contains a requirement to log information.
            <comment>It is unclear what information needs to be logged to constitute logging the "presence" of a cellular device.</comment></audit-event-info>
            
          </audit-event>
        </f-component>

        <f-component cc-id="fau_wid_ext.4" name="Wireless Intrusion Detection - Wireless Spectrum Analysis">
          <consistency-rationale>This SFR defines an optional capability for a distributed component to be dedicated to one particular function. 
            This function (wireless spectrum analysis) is defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to implement wireless spectrum analysis in a dedicated physical component.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
	    <h:p>[FAU_WID_EXT.2 Wireless Intrusion Detection - Passive Information Flow Monitoring, or </h:p><h:p>
          FAU_WID_EXT.3 Wireless Intrusion Detection - Spectrum Monitoring]</h:p></dependencies>
          <f-element id="fel-dedicate-sensor">
            <title> The TSF shall provide a dedicated sensor for wireless spectrum analysis. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS to verify that the TOE provides a
                dedicated sensor for wireless spectrum analysis.</TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure dedicated spectrum analysis as well as the hardware that is
                needed to perform this function.</Guidance>
              <Tests> The evaluator shall enable and configure dedicated spectrum analysis and test
                the capabilities listed in the TSS. </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>

      </section>
    </opt-sfrs>
    <sel-sfrs>
      <section title="Audit Events for Selection-Based SFRs">
        <audit-table id="at-sel-based" table="sel-based"/>
      </section>
      <section title="Security Audit (FAU)" id="ss-sel-fau">
        <ext-comp-def title="Anomaly-Based Intrusion Detection" fam-id="FAU_ANO_EXT">
          <fam-behavior>This family defines requirements for detection of malicious network activity based on anomalous behavior.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_ano_ext.1" name="Anomaly-Based Intrusion Detection">
          <depends on="anoBased"/>
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to define how it determines anomalous network traffic that may be indicative of malicious activity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Specification of periods of network activity that constitute baselines of expected behavior</h:li>
            <h:li>Definition of anomaly activity</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_IDS_EXT.1 Intrusion Detection System - Intrusion Detection Methods</dependencies>
          <f-element id="fel-detect-how">
            <title> The TSF shall support the definition of <selectables>
              <selectable>baselines ('expected and approved')</selectable>
              <selectable>anomaly ('unexpected') traffic patterns</selectable>
              </selectables> including the specification of <selectables linebreak="yes">
                <selectable>throughput (data elements (e.g. bytes, packets, etc.) per time period
                  (e.g. minutes, hours, days))</selectable>
                <selectable>time of day</selectable>
                <selectable>frequency</selectable>
                <selectable>thresholds</selectable>
                <selectable><assignable>other methods</assignable></selectable>
              </selectables> and the following network protocol fields: <h:ul>
                <h:li>all management and control frame header elements.</h:li>
              </h:ul>
            </title>
          </f-element>
          <f-element id="fel-define-anomaly">
            <title> The TSF shall support the definition of anomaly activity through <selectables>
                <selectable>manual configuration by administrators</selectable>
                <selectable>automated configuration</selectable>
              </selectables>. </title>
            <note role="application"> The "baseline" and "anomaly" can be something manually
              defined/configured by a TOE administrator (or importing definitions), or something
              that the TOE is able to automatically define/create by inspecting network traffic over
              a period of time (a.k.a. "profiling"). </note>
            <aactivity>
              <TSS>
		            <h:p>The evaluator shall verify that the TSS describes the composition and
                construction of baselines or anomaly-based attributes specified in the SFR. The
                evaluator shall verify that the TSS provides a description of how baselines are
                defined and implemented by the TSF, or a description of how anomaly-based rules are
                defined and configured by the administrator. </h:p><h:p> The evaluator shall
                verify that the TSS describes the available modes of configuration (manual or
                automatic) and how to configure or import the baseline.</h:p></TSS>
              <Guidance>
		            <h:p>The evaluator shall verify that the operational guidance describes how to
                configure baseline and/or anomalous traffic patterns based on what is stated in the
                TSS.</h:p><h:p> The evaluator shall verify that the operational guidance
                describes how to perform automatic and/or manual definition of anomaly activity
                based on what is selected in the ST.</h:p></Guidance>
              <Tests> The evaluator shall use the instructions in the operational guidance to
                configure baselines or anomaly-based rules through automated and/or manual means
                based on what is selected in the ST. The evaluator shall send traffic that does not
                match the baseline or matches the anomaly-based rule and verify the TSF detects the
                anomalous behavior and generates an alert. </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <ext-comp-def title="Signature-Based Intrusion Detection" fam-id="FAU_SIG_EXT">
          <fam-behavior>This family defines requirements for detection of malicious network activity based on traffic signatures.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_sig_ext.1" name="Signature-Based Intrusion Detection">
          <depends on="sigBased"/>
          <consistency-rationale>This SFR defines operations to be performed on collected WIDS data, which is collected using an external interface defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to support the definition of traffic signatures that can be compared to observed network traffic for the purpose of identifying potential malicious activity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Definition of attack signatures</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_IDS_EXT.1 Intrusion Detection System - Intrusion Detection Methods</dependencies>
          <f-element id="fel-attack-signature">
            <title> The TSF shall support user-defined and customizable attack signatures. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the user-defined and
                customizable attack signatures that the TOE can define.</TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                information on how to configure user-defined and customizable attack signatures,
                including a description of the customization options that are
                available.</Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Craft a signature with the available fields indicated in the TSS.</step>
                      <step>Send a crafted frame that matches the signature to an allowlisted
                        EUD</step>
                      <step>Verify that the TSF triggers an alert based on the newly defined
                        signature.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
 <!--         <ext-comp-def title="Protected Audit Event Storage (Packet Captures)" fam-id="FAU_STG_EXT">
          <fam-behavior/>
        </ext-comp-def> -->
        <f-component cc-id="fau_stg.1" iteration="PCAP" name="Protected Audit Event Storage (Packet Captures)">
          <!-- Later_TODO: Look at 1.2 in ND -->
          <!-- This component is copied from CC Part 2 and iterated to make a distintion between audit records and PCAPs -->
          <depends on="pcap"/>
          <!-- fau_arp.1.1 -->
          <consistency-rationale>This SFR iterates the FAU_STG.1 SFR defined in CC Part 2 for storage of audit data and applies it to storage of packet captures.</consistency-rationale>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element id="fel-capture-dit">
            <title>The TSF shall be able to store generated <h:b>packet captures</h:b> on the <h:i>transmit the generated
            audit data to an external IT entity <h:b>hosting a protocol analyzer</h:b> using a trusted channel according to FTP_ITC</h:i>. </title>
            <note role="application"> Per FAU_STG_EXT.1 in the Base-PP, the TOE must support
              transfer of the audit data to an external IT entity using a trusted channel per
              FTP_ITC.1. Note that this PP-Module modifies FTP_ITC.1 from the Base-PP.
	      If <xref to="pcap"/> is selected in <xref to="fel-arp"/>, then this SFR
              must be included in the ST, and this iteration is for the packet captures generated as a
              selectable action completed upon detection of a potential security violation in
              FAU_ARP.1. </note>
          </f-element>
          <f-element id="fel-capture-dar">
            <!-- Later_TODO: Look at this element in NDcPP -->
            <title>The TSF shall be able to store generated <h:b>packet captures</h:b> on the TOE itself. In addition <selectables linebreak="yes"> 
              <selectable>The TOE shall be a distributed TOE that stores <h:b>packet capture</h:b> data on the following TOE components: <assignable>identification of TOE components</assignable></selectable> 
              <selectable>The TOE shall be a distributed TOE with storage of <h:b>packet capture</h:b> data provided externally for the following TOE components: 
                <assignable>list of TOE components that do not store packet capture data locally and the other TOE components to which they transmit their generated packet capture data</assignable></selectable>
            </selectables>.
            </title>
          </f-element>
          <f-element id="fel-full-capture">
            <title> The TSF shall <selectables>
              <selectable>drop new <h:b>packet capture</h:b> data</selectable>
              <selectable>overwrite previous <h:b>packet captures</h:b> according to the following rule:
                <assignable>rule for overwriting previous packet captures</assignable></selectable>
                <selectable><assignable>other action</assignable></selectable>
            </selectables> when the local storage space for <h:b>packet capture</h:b> data is full. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the list of trusted channels
                (as specified in FTP_ITC.1) available in the TSF to transmit packet captures to an
                external entity. The evaluator shall verify that the TSS describes the ability of
                the TOE to store packet capture data within itself, how much storage space is
                available for packet capture data and where that data is stored. The evaluator shall
                verify that the TSS describes the behavior of the TOE when local storage space for
                packet capture data is exhausted and whether this behavior is
                configurable.</TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to configure the trusted channel. If the behavior of the TOE
                when local storage space for packet capture data is exhausted is configurable, the
                evaluator shall verify that the operational guidance provides information on what
                the configurable behaviors are and how they can be set.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure packet captures according to the guidance
                    specified. The evaluator shall then trigger an event that starts a capture and
                    verify through the tests in FTP_ITC.1 that the captured traffic being sent to
                    the external device is being sent through a trusted channel.</test>
                  <test>The evaluator shall configure packet captures to be stored on the TSF
                    according to the guidance specified. The evaluator shall then trigger an event
                    that starts a capture and verify that the packet capture was stored on the
                    TSF.</test>
                  <test>The evaluator shall define packet data retention and deletion rules on the
                    TSF according to the guidance specified and test the functionality of the
                    specified rules.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
    </sel-sfrs>
    <obj-sfrs>
      <section title="Auditable Events for Objective SFRs">
        <audit-table id="at-objective" table="objective"/>
      </section>

      <section title="Security Audit (FAU)" id="ss-obj-fau">
        <!-- Originally I thought we needed to add this SFR, most likely do not need it, b/c ND cPP covers it.  -->
        <!-- <f-component id="fau_gen.1" name="Device Configuration - Exporting Event Data">         
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall allow for the for the export of all captured event logs. </title>
            <note role="application">It is expected that an Authorized Administrator will be
              responsible for providing event output from the TSF for the purposes of ingest into
              other analysis and reporting mechanisms. Having the ability to export event log data
              from the device is a necessary capability to satisfy this requirement. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.</TSS>
              <Guidance> There are no operational guidance activities for this SFR.</Guidance>
              <Tests> 
              <testlist>
                <test>
                  <steplist>
                    <step>Deploy an allowlisted AP and connect it to the protected wired
                      infrastructure via wire.</step>
                    <step>Confirm that the TSF can observe and capture traffic and events
                      generated by the AP.</step>
                    <step>Verify that the TSF can export its configuration and observable event
                      data in any of the following formats:</step>
                    <h:ul>
                      <h:li>comma separated values (CSV)</h:li>
                      <h:li>common log format (CLF)</h:li>
                      <h:li>JavaScript Object Notation (JSON)</h:li>
                      <h:li>syslog</h:li>
                    </h:ul>
                  </steplist>
                </test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>
          </f-component> -->
        <!-- <ext-comp-def title="Detection of Unauthorized Connections" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>  -->
        <f-component cc-id="fau_inv_ext.4" name="Detection of Unauthorized Connections">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to identify if an unauthorized network asset in its inventory is attempting to access a protected network using a wired connection.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_INV_EXT.1 Environmental Inventory</dependencies>
          <f-element id="fel-detect-bad-ap">
            <title> The TSF shall detect when non-allowlisted APs have a wired connection to the
              internal corporate network.</title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes guidance on whether the TSF has
                the capability of detecting APs connecting to the protected wired network
                infrastructure. If the capability is present the TSS shall include configuration
                guidance for this feature.</TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to configure the WIDS to detect unauthorized APs connected to the protected wired
                infrastructure.</Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-allowlisted AP.</step>
                      <step>Connect the AP via wire to the protected network infrastructure.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the rogue AP is detected and an alert generated on the
                        detection of an AP connected to the protected wired infrastructure.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- NEW Component -->
 <!--        <ext-comp-def title="Signal Library" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>   -->
        <f-component cc-id="fau_inv_ext.5" name="Signal Library">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to maintain a signal library.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-signal-library">
            <title> The TSF shall include a signal library.</title>
            <note role="application">The TSF will need to have the ability to import, export, or
              update the existing signal library.</note>
            <aactivity>
              <TSS> There are no TSS evaluation activities for this SFR.</TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to locate and verify that the WIDS comes preloaded with a signal library, as well as
                possesses the ability to import, export, and update the existing signal library if
                present.</Guidance>
              <Tests>
		Depending on operation guidance provided for the TOE, the evaluator shall
                confirm and note the existence of the signal library, and test for the ability to
                import, export, and update the signal library. <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an allowlisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm and note whether the TSF has an existing signal library.</step>
                      <step>If existence is confirmed, verify that the TSF can import, export, and
                        update the existing signal library.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <ext-comp-def title="Device Impersonation" fam-id="FAU_MAC_EXT">
          <fam-behavior>This family defines requirements for detection of potential device impersonation on the basis of MAC address spoofing.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_mac_ext.1" name="Device Impersonation">
          <consistency-rationale>This SFR defines operations to be performed on assets in the TOE’s operational environment, which is behavior defined in this PP-Module that extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to detect possible MAC address spoofing using various methods.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_INV_EXT.2 Characteristics of Environmental Objects</dependencies>
          <f-element id="fel-detect-same-mac">
            <title> The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the same MAC address simultaneously.</title>
            <note role="application"> The intent of this SFR is to detect MAC spoofing where an
              attacker is able to cause the allowlisted EUD to disconnect and promptly connects a
              non-allowlisted device using the MAC address of the allowlisted EUD.</note>
          </f-element>
          <f-element id="fel-detect-bad-mac">
            <title> The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the MAC addresses of non-allowlisted EUDs within an Authorized
              administrator-configurable timeframe based on distance between sensors.</title>
            <note role="application">The intent of this SFR is to allow the administrator to
              determine the time that should be allowed between an allowlisted EUD connecting in two
              distant locations.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the behavior of the TOE when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously.</TSS>
              <Guidance>
		<h:p>The evaluator shall verify that the operational guidance provides
                instructions on how to deploy the TOE in a manner that allows the TSF to detect when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously (i.e. information about the range and placement of sensors to ensure
                non-overlapping coverage).</h:p><h:p> The evaluator shall verify that the
                operational guidance provides instructions on how to configure the timeframe that
                should be allowed between two subsequent attempts for an EUD to connect from two
                separate locations.</h:p></Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Setup an allowlisted AP (Location 1).</step>
                      <step>Connect an allowlisted EUD to AP.</step>
                      <step>Setup a second allowlisted AP and a non-allowlisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-overlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the allowlisted AP in location 2. Make sure both EUDs
                        are connected at the same time.</step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Configure the timeframe allowed between connection of two EUDs in two
                        separate locations (Location 1, Location 2).</step>
                      <step>Setup an allowlisted AP (Location 1). </step>
                      <step>Connect an allowlisted EUD to AP.</step>
                      <step>Setup a second allowlisted AP and a non-allowlisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-overlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the allowlisted AP in location 2. Make sure that the
                        time between connections is shorter than the time timeframe
                        allowed/configured. </step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- Removed-->
        <!-- <ext-comp-def title="Proprietary Traffic Monitoring" fam-id="FAU_WID_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.8" name="Wireless Intrusion Detection - Proprietary Traffic Monitoring">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the presence of all vendor proprietary network traffic
              matching the 802.11 monitoring SFP for all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:
              <h:ul>
                <h:li>authorized APs and authorized EUDs</h:li>
                <h:li>authorized APs and unauthorized EUDs</h:li>
                <h:li>unauthorized APs and authorized EUDs.</h:li>
              </h:ul></title>
            <note role="Application">
              The "802.11 monitoring SFP" is a security function policy and
              the SFRs that reference this policy describe what the policy does. The "802.11
              monitoring SFP" is established in FDP_IFC.1 and defined through FAU_WID_EXT.1, FAU_WID_EXT.2, in addition to optional SFRs FAU_WID_EXT.3 and FAU_WID_EXT.4. A vendor does not have to formally define
              this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS> 
                There are no TSS evaluation activities for this SFR.</TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.</Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Set the WIDS sensor for a set channel.</step>
                      <step>Start a traffic capture from the WIDS sensor.</step>
                      <step>Send a set number of frames on the sensor's operating channel for all
                        IEEE 802.11 a, b, g, n, ac vendor propietary frame types and subtypes
                        from/to the following: <h:ol>
                          <h:li><h:i>authorized APs and authorized EUDs.</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs.</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs.</h:i></h:li>
                        </h:ol>
                      </step>
                      <step>Provide a list of the frames types and subtypos that were used for
                        testing and verify that they were all detected.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        -->
        <ext-comp-def title="Wireless Intrusion Prevention" fam-id="FAU_WIP_EXT">
          <fam-behavior>This family defines requirements for wireless intrusion prevention.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fau_wip_ext.1" name="Wireless Intrusion Prevention">
          <consistency-rationale>This SFR defines WIPS behavior in response to detection of potential malicious activity in the TOE’s operational environment. This extends the logical scope of the TOE beyond what the Base-PP defines.</consistency-rationale>
          <comp-lev>requires the TSF to support reactive behavior if potential malicious traffic is observed to be originating from or targeted to a particular network asset.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Enabling or disabling transmission of data by wireless sensor</h:li>
          </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the PP/ST: <h:ul>
              <h:li>Isolation of AP or EUD</h:li>
            </h:ul>
          </audit>
          <dependencies>FAU_WID_EXT.1 Wireless Intrusion Detection - Malicious Environmental Objects</dependencies>
          <f-element id="fel-isolate">
            <title> The TSF shall allow an Authorized Administrator to isolate a wireless AP or EUD
              from the network monitored by the TSF using the following methods: <selectables>
                <selectable>wireless containment</selectable>
                <selectable>wire-side containment of an unauthorized AP connected to the internal
                  corporate wired network</selectable>
              </selectables>.
            </title>
            <note role="application">
	      <h:p>It is expected that an Authorized Administrator will be
              responsible for confirming the AP or EUD as a rogue AP or EUD to initiate wireless
              containment. </h:p><h:p> In this SFR the containment of an an unauthorized AP
              connected to the internal corporate wired network refers to an unauthorized AP that is
              physically connected (via wire) to the protected internal wired infrastructure.</h:p> </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.</TSS>
              <Guidance> There are no operational guidance activities for this SFR.</Guidance>
              <Tests> Configure the containment methods available on the TSF and perform the
                following test for each method. <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-allowlisted AP and connect to the protected wired
                        infrastructure via wire (make sure it gets classified as rogue, or manually
                        classify as such).</step>
                      <step>Connect an allowlisted EUD to the AP.</step>
                      <step>Verify that TSF generates an alert, breaks the connection of the
                        allowlisted EUD from the rogue AP, and contains the rogue AP.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Isolation of AP or EUD</audit-event-descr>
            <audit-event-info>Description of violation</audit-event-info>
            <audit-event-info>Type of containment used</audit-event-info>
            <audit-event-info>Was containment triggered manually or automatically</audit-event-info>
            <audit-event-info>Sensor performing the containment (if wireless)</audit-event-info>
            <audit-event-info>Details about the device(s) being contained (classification, device type, MAC address)</audit-event-info>
          </audit-event>
        </f-component>
      </section>

      <section title="Protection of the TSF (FPT)" id="ss-obj-fpt">
        <f-component cc-id="fpt_fls.1" iteration="WIDS" name="Basic Internal TSF Data Transfer Protection (WIDS)">
          <consistency-rationale>This SFR defines preservation of a secure state in the event that a failure condition is detected. 
            The Base-PP does not define an SFR for this behavior but this SFR mitigates the T.SECURITY_FUNCTIONALITY_FAILURE threat defined in the Base-PP, 
            so it is clear that this behavior is consistent with the security expectations of the Base-PP.</consistency-rationale>
          <f-element id="fel-preserve-state">
            <title> The TSF shall preserve a secure state when the following types of failures
              occur: [<h:i>sensor functionality failure, potential compromise of the TSF</h:i>]. </title>
            <note role="application"> At minimum, the preservation of a secure state requires the
              generation of audit records when the defined failure conditions occur. </note>
            <aactivity>
              <TSS> The evaluator shall review the TSS section to determine that the TOE’s
                implementation of the fail secure functionality is documented. The evaluator shall
                examine the TSS section to ensure that all failure modes specified in the ST are
                described.</TSS>
              <Guidance> The evaluator shall review the operational guidance to verify that it
                identifies the potential TOE failures, how the TSF preserves a secure state
                following these failures, and any actions that are required to restore the TOE to
                normal operation following the transition to a failure state. </Guidance>
              <Tests>
                <testlist>
                  <test>For each failure mode specified in the ST, the evaluator shall ensure that
                    the TOE attains a secure state after initiating each failure mode type.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Information about failure</audit-event-descr>
            <audit-event-info>Indication that there was a failure</audit-event-info>
            <audit-event-info>Type of failure</audit-event-info>
            <audit-event-info>Device that failed</audit-event-info>
            <audit-event-info>Sensor connectivity and operating status</audit-event-info>
            <audit-event-info>Time of failure</audit-event-info>
          </audit-event>
        </f-component>
      </section>
    </obj-sfrs>
    <impl-dep-sfrs/>
  </sec:Security_Requirements>

  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Rationale for Satisfaction</h:td>
      </h:tr>
      <h:tr>
        <h:td>FDP_IFF.1 - Information Flow Control Functions</h:td>
        <h:td>
          CC Part 2 specifies FDP_IFF.1 as a dependency of FDP_IFC.1 because the TSF must define the information flow control SFP rules associated with a given SFP. 
          This dependency is implicitly addressed through FAU_WID_EXT.2, which defines the rules for the 802.11 monitoring SFP defined by FDP_IFC.1.
        </h:td>
      </h:tr>
    </h:table>
  </appendix>
  
    <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
      
      For a distributed TOE, the security functional requirements in this PP-Module need to be met by the
      TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
      following categories are defined in order to specify when each SFR must be implemented by a
      component: <h:ul>
        <h:li><h:b>All Components ("All")</h:b> - All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
        <h:li><h:b>At least one Component ("One")</h:b> - This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
        <h:li><h:b>Feature Dependent ("Feature Dependent")</h:b> - These requirements will only be
      fulfilled where the feature is implemented by the distributed TOE component (note
      that the requirement to meet the PP-Module as a whole requires that at least one component
      implements these requirements if they are claimed by the TOE).</h:li></h:ul>
      The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
      
      <h:table>
        <h:tr class="header">
          <h:td>Requirement</h:td>
          <h:td>Description</h:td>
          <h:td>Distributed TOE SFR Allocation</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_ANO_EXT.1</h:td>
          <h:td>Anomaly-Based Intrusion Detection</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
        <h:td>FAU_ARP.1</h:td>
        <h:td>Security Alarms</h:td>
        <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_ARP_EXT.1</h:td>
          <h:td>Security Alarm Filtering</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_GEN.1/WIDS</h:td>
          <h:td>Audit Data Generation (WIDS)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_IDS_EXT.1</h:td>
          <h:td>Intrusion Detection System - Intrusion Detection Methods</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_INV_EXT.1</h:td>
          <h:td>Environmental Inventory</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_INV_EXT.2</h:td>
          <h:td>Characteristics of Environmental Objects</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_INV_EXT.3</h:td>
          <h:td>Location of Environmental Objects</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_INV_EXT.4</h:td>
          <h:td>Detection of Unauthorized Connections</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_INV_EXT.5</h:td>
          <h:td>Signal Library</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_MAC_EXT.1</h:td>
          <h:td>Device Impersonation</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_RPT_EXT.1</h:td>
          <h:td>Intrusion Detection System - Reporting Methods</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_SAA.1</h:td>
          <h:td>Potential Violation Analysis</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_SIG_EXT.1</h:td>
          <h:td>Signature-Based Intrusion Detection</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_STG.1/PCAP</h:td>
          <h:td>Protected Audit Event Storage (Packet Captures)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_WID_EXT.1</h:td>
          <h:td>Wireless Intrusion Detection - Malicious Environmental Objects</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_WID_EXT.2</h:td>
          <h:td>Wireless Intrusion Detection - Passive Information Flow Monitoring</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_WID_EXT.3</h:td>
          <h:td>Wireless Intrusion Detection - Spectrum Monitoring</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_WID_EXT.4</h:td>
          <h:td>Wireless Intrusion Detection - Wireless Spectrum Analysis</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_WIP_EXT.1</h:td>
          <h:td>Wireless Intrusion Prevention</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FDP_IFC.1</h:td>
          <h:td>Subset Information Flow Control</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMF.1/WIDS</h:td>
          <h:td>Specification of Management Functions (WIDS)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_FLS.1</h:td>
          <h:td>Basic Internal TSF Data Transfer Protection</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
      </h:table>
    
  </appendix>

  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy sources beyond the requirements outlined in the Base-PP.  
  </appendix>

  <bibliography>
    <cc-entry/>
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/protectionprofiles/482">collaborative Protection Profile for
          Network Devices</h:a>, Version 3.0e, March 23, 2020
      </description>
    </entry>
    <entry id="bibNDSD">
      <tag>NDcPP SD</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/protectionprofiles/482">
          Supporting Document - Evaluation Activities for Network Device cPP</h:a>, Version 2.2, December 2019
      </description>
    </entry>
    
  </bibliography>
</Module>
