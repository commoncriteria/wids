<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>

<!-- Schema that is hosted on github. This can change separate of changes made to WIDS -->
<!--  
<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
-->

<!-- Local Schema. The schema here only changes if we pull transforms -->
<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<!-- TODO:
  Lauren
  - Are there any Use Cases??
  - FPT_ITA, FPT_ITC, FPT_ITI - exportability of TSF data 

  NIAP
  - Do we have to have Use Cases?
  - consistency rationales throughout document
  - ECDs throughout document
  - Does this Module claim any packages?
  - Distributed TOE - what do we need to do for ND?
  - Optional objectives
  - Do all new SFRs map to SOs

  Kevin
  - ND cPP is not in XML/github - how do I reference it?
 

-->


<Module boilerplate="yes" target-products="WIDS/WIPS" xmlns="https://niap-ccevs.org/cc/v1"
  name="802.11 Wireless Intrusion Detection/Prevention Systems"
  xmlns:h="http://www.w3.org/1999/xhtml">
  <PPReference>
    <ReferenceTable>
      <PPVersion>0.8</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2020-06-22</PPPubDate>
      <Keywords>WIDS/WIPS, Wireless Intrusion Detection/Prevention System</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2016-10-06</date>
      <subject>Initial Release - EP for NDcPP</subject>
    </entry>
  </RevisionHistory>
  <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview"> This Protection Profile Module (PP-Module) describes
      security requirements for a 802.11 Wireless Intrusion Detection System (WIDS) defined to be an
      IEEE 802.11 network intrusion detection product located at the edge of a private network that
      can collect, inspect, and analyze real-time network traffic and alert the administrator of
      policy violations. This PP-Module is intended to provide a minimal baseline set of
      requirements that are targeted at mitigating well defined and described threats.
      <h:br/><h:br/> This PP-Module contains optional requirements for a Wireless Intrustion
      Protection System (WIPS), a security product that in addition to the 802.11 WIDS capability,
      provides network security administrators with the additional ability to react in real-time to
      potentially malicious wireless (IEEE 802.11) network traffic. <h:br/><h:br/> This PP-Module
      extends the collaborative Protection Profile for Network Devices (NDcPP). </section>
    <tech-terms>
      <term abbr="AES" full="Advanced Encryption Standard"/>
      <term abbr="AP" full="Access Point"> A device that provides the network interface that enables
        802.11 wireless client hosts to access a wired network. </term>
      <term abbr="BSSID" full="Basic Service Set Identifier"/>
      <term abbr="DoS" full="Denial of Service"/>
      <term abbr="EUD" full="End User Device"> An 802.11 enabled device that has the ability to
        process, transmit, and/or store information. </term>
      <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/>
      <term abbr="IPsec" full="Internet Protocol Security"/>
      <term abbr="MAC" full="Media Access Control"/>
      <term abbr="SSH" full="Secure Shell"/>
      <term abbr="SSID" full="Service Set Identifier"> The primary name associated with an 802.11
        wireless local area network (WLAN). </term>
      <term abbr="TLS" full="Transport Layer Security"/>
      <term abbr="TKIP" full="Temporal Key Integrity Protocol"/>
      <term abbr="WEP" full="Wired Equivalent Protocol"/>
      <term abbr="WIDS" full="Wireless Intrustion Detection System"> A security product that
        provides network security administrators with the ability to monitor, collect, and log
        real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WIPS" full="Wireless Intrustion Prevention System"> A security product that
        provides network security administrators with the ability to monitor, collect, log, and
        react in real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WLAN" full="Wireless Local Area Network"> An 802.11 wireless computer network that
        links two or more devices using wireless communication to form a local area network (LAN)
        within a limited area such as a home, school, computer laboratory, campus, office building
        etc. </term>
      <term abbr="WPA" full="WLAN Protected Access"/>
    </tech-terms>
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <subsection title="TOE Boundary" id="TOEboundary"> This PP-Module specifically addresses
        WIDS/WIPS. A conformant WIDS is a product that can monitor, collect, inspect, and analyze
        real-time network traffic and alert the administrator of policy violations. WIPS
        functionality is not required to conform to this PP-Module, and it is optional for the TOE
        to have the additional ability to react in real-time to potentially malicious wireless (IEEE
        802.11) network traffic.<h:br/><h:br/> A WIDS/WIPS TOE consists of multiple sensors that
        passively scan the RF environment on the WLAN radio frequency spectrum and a centralized
        mechanism such as a Server or Controller that processes the data collected by the sensors.
        Conformant TOEs must use a secure communication path(s) between WIDS/WIPS components.
        <h:br/><h:br/> A WIDS/WIPS can be Integrated (be part of the WLAN infrastructure) or
        Standalone (independent from WLAN) architecture depending on vendor implementation. The two
        different architectures are illustrated in the <figref refid="toe"/> figure below. The TOE
        boundary is indicated by the yellow box.
        <h:br/><h:br/> A WIDS/WIPS is expected to inspect layers 1 and 2 network traffic, per the
        OSI network model, and monitor wireless frames in the RF spectrum utilized by IEEE 802.11 a,
        b, g, n, and ac. Monitoring and inspection of other technologies (e.g., cellular) and
        protocols are optional.<h:br/><h:br/> Conformant TOEs will detect potentially malicious
        network traffic using various approaches. Broadly speaking, the traffic analysis could be
        based on identification of ‘known’ threats, or ‘unknown’ threats. Identification of ‘known’
        threats may be performed through pattern matching, (e.g. by matching strings of characters
        within a frame with known patterns, or by matching traffic patterns common with
        reconnaissance or denial of service (DoS) attacks). Identification of ‘unknown’ threats may
        be performed through use of various forms of anomaly detection whereby the WIDS/WIPS is
        provided with (or learns/creates) a definition of expected/typical traffic patterns, such
        that it’s able to detect and react to anomalous (unexpected/atypical) traffic patterns.<h:br/><h:br/>
        <figure entity="images/TOE.jpg" title="General TOE" id="toe"/>
      </subsection>
    </section>
    <section title="Use Cases" id="usecases"><!-- NIAP: Do we have to have a use case? Todo: Need to either add a use case or delete this section -->
      <usecases>
        <usecase id="usecase1" title="Use Case 1">
          <description> A WIDS consists of sensors (preferably dedicated) and a central controller working together to provide 24/7 monitoring, primarily to the 
          802.11 Wireless Local Area Network (WLAN) spectrum and protocol, to detect, identify, and geo-locate WLAN devices within the controlled space. A WIDS is
          vital for the security of a WLAN access system deployed within a controlled space. A WIDS may be used to monitor controlled space without a CSfC WLAN Access System,
          but this use case is outside the scope of the CSfC guidance.<h:br/><h:br/> The WIDS may be capable of detecting or monitoring traffic other than 802.11 WLAN, such as
          802.15.4 based protocols, which enhances the security of the controlled space. However, a WIDS is not required to monitor additional protocols outside of 802.11 when
          supporting a WLAN Access Solution. A WIDS monitors all 802.11 WLAN traffic emanating from and traversing the controlled space, thus inadvertant collection of any 802.11
          signals is possible when operating a WIDS.</description> 
        </usecase>
      </usecases>
    </section>
  </chapter>

  <chapter title="Conformance Claims" id="ConformanceClaims">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description> This PP-Module inherits exact conformance as required from the specified
          Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).<h:br/><h:br/> The following PPs and PP-Modules
          are allowed to be specified in a PP-Configuration with this PP-Module. <h:ul>
            <h:li>Network Device cPP, version 2.2e</h:li>
          </h:ul>
        </description>
      </cclaim>
      <cclaim title="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim title="Package Claims">
        <description> This PP-Module does not claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </chapter>
  <chapter title="Security Problem Description" id="spd"> WIDS address a range of security threats
    related to detection of and reaction to potentially malicious WLAN traffic. The malicious
    traffic may pose a threat to one or more endpoints on the monitored networks, to the network
    infrastructure, or to the TOE itself. Attacks against a WLAN could compromise the
    confidentiality and integrity of WLAN users and system data as well as the availability of the
    WLAN to legitimate users. <h:br/><h:br/> The term “monitored network” is used here to represent
    any WLAN and/or wired network that the TOE is configured to monitor and detect intrusions on.
    This extends to the wired networks as intrusions on the wireless network can also be damaging to
    the wired infrastructure. The WIDS/WIPS also protect the wired infrastructure by detecting rogue
    devices that are directly connected to the wired infrastructure, which may expose the wired
    network, or unauthorized WLAN devices deployed in a no-wireless zone.<h:br/>
    <h:br/> The proper installation, configuration, and administration of the WIDS is critical to
    its correct operation. A site is responsible for developing its security policy and configuring
    a rule set that the WIDS will enforce and provide an appropriate response to meet their needs,
    relative to their own risk analysis and their perceived threats.<h:br/><h:br/> Note that this
    PP-Module does not repeat the threats identified in the NDcPP, though they all apply given the
    conformance and hence dependence of this PP-Module on the NDcPP. Note also that while the NDcPP
    contains only threats to the ability of the TOE to provide its security functions, this
    PP-Module addresses only threats to resources in the operational environment. Together the
    threats of the NDcPP and those defined in this PP-Module define the comprehensive set of
    security threats addressed by a WIDS TOE. <section title="Threats" id="threats">
      <threats>
        <threat name="T.UNAUTHORIZED_DISCLOSURE_OF_INFORMATION">
          <description> Unintended/unauthorized disclosure of sensitive information on a protected
            WLAN, such as sending unencrypted sensitive data. The WIDS will be capable of collecting
            and analyzing WLAN data to detect unauthorized disclosure of information. </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.SYSTEM_MONITORING as this provides for visibility into the network which enables
              detection of network violations.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.WIDS_ANALYZE as this provides detection of potential violations of approved network
              usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.WIPS_REACT as this provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.UNAUTHORIZED_ACCESS">
          <description> An attacker may attempt to gain unauthorized access to a network, endpoints,
            or services, by methods such as impersonation of an authorized AP to get an EUD to
            connect to the unauthorized AP If malicious external APs or EUDs are able to communicate
            with APs or EUDs on the protected WLAN, then those devices may be susceptible to the
            unauthorized disclosure of information. </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of unauthorized APs
              and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIDS_ANALYZE as this
              provides detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIPS_REACT as this
              provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.TOE_ADMINISTRATION">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by
              O.TOE_ADMINISTRATION.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.DISRUPTION">
          <description> Attacks against the WLAN infrastructure might lead to denial of service
            (DoS) attacks within a protected WLAN. A wireless DoS may occur in two ways: at the
            physical layer through RF Jamming, or at the data link layer through packet injection. </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.DISRUPTION is countered by O.SYSTEM_MONITORING as this provides
              for visibility into the network which enables detection of DoS attacks.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.DISRUPTION is countered by O.WIDS_ANALYZE as this provides for
              detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.DISRUPTION is countered by O.WIPS_REACT as this provides
              containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    <section title="Assumptions" id="assumption">
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner
            that ensures that the TOE's security policies will be enforced on all applicable network
            traffic flowing among the attached networks. </description>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The operational environment objective OE.CONNECTIONS is realized through
              A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale> The operational environment objective OE.PROPER_ADMIN is realized through
              A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="osp"> An organization deploying the TOE is
      expected to satisfy the organizational security policy listed below in addition to all
      organizational security policies defined by the claimed base PP. <OSPs>
        <OSP name="P.ANALYZE">
          <description>Analytical processes and information to derive conclusions about potential
            intrusions must be applied to WIDS data and appropriate response actions
            taken.</description>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The organizational security policy P.ANALYZE is facilitated through
              O.WIDS_ANALYZE. </rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </chapter>
  <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <!-- NIAP: Make sure new SFRs are mapped to SOs -->
      <SOs>
        <SO name="O.SYSTEM_MONITORING">
          <description> To be able to analyze and react to potential network policy violations, the
            WIDS must be able to collect and store essential data elements of network traffic on
            monitored networks.<h:br/>
          </description>
          <addressed-by>FAU_GEN.1/WIDS, FAU_STG_EXT.1/PCAP</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
        <SO name="O.WIDS_ANALYZE">
          <description> The WIDS must be able to analyze collected or observed WLAN activity on
            monitored network to identify potential violations of approved WLAN policies,
            unauthorized connections involving internal WLAN devices, and non-secure communications.
            <h:br/>
          </description>
          <addressed-by>FAU_ARP.1, FAU_ARP_EXT.2, FAU_ANO_EXT.1 (OPTIONAL), FAU_IDS_EXT.1,
            FAU_INV_EXT.1, FAU_INV_EXT.2, FAU_INV_EXT.3, FAU_INV_EXT.5
            (OPTIONAL), FAU_INV_EXT.6 (OPTIONAL), FAU_MAC_EXT.1 (OPTIONAL), FAU_SAA.1, FAU_SIG_EXT.1
            (OPTIONAL), FAU_WID_EXT.1, FAU_WID_EXT.2,
            FAU_WID_EXT.3 (OPTIONAL), FAU_WID_EXT.4 (OPTIONAL), FDP_IFC.1</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
        <SO name="O.WIPS_REACT">
          <!-- NIAP: All WIPS functionality is optional, so technically this is an optional objective. How should we handle this? -->
          <description> The TOE must be able to react as configured by the administrators to
            isolate/contain WLAN devices that have been determined to violate administrator-defined
            WIPS policies. <h:br/>
          </description>
          <addressed-by>FAU_WIP_EXT.1 (OPTIONAL)</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
        <SO name="O.TOE_ADMINISTRATION">
          <description> To address the threat of unauthorized administrator access that is defined
            in the base PP, Conformant TOEs will provide the functions necessary for an
            administrator to configure the WIDS Capabilities of the TOE. <h:br/>
          </description>
          <addressed-by>FMT_SMF.1/WIDS</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
        <SO name="O.INSECURE_OPERATIONS">
          <!-- NIAP: Optional objective, but ND has similar SFRs, but ND does not have SOs. Not sure how to handle this. -->
          <description> There may be instances where the TOE’s hardware malfunctions or the
            integrity of the TOE’s software is compromised, the latter being due to malicious or
            non-malicious intent. To address the concern of the TOE operating outside of its
            hardware or software specification, the TOE will log or produce an alert upon discovery
            of a problem reported via the self-test mechanism. <h:br/>
          </description>
          <addressed-by>FPT_FLS.1 (OPTIONAL)</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
        <SO name="O.TRUSTED_COMMUNICATIONS">
          <description> To further address the threat of untrusted communications channels that is
            defined in the base PP, conformant TOEs will provide trusted communications between
            distributed components if any exist. <h:br/>
          </description>
          <addressed-by>FPT_ITT.1, FTP_ITC.1</addressed-by>
          <rationale/>
          <consistency-rationale/>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment"> The following security objectives for the operational
      environment assist the TOE in correctly providing its security functionality. These track the
      assumptions about the environment. <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that
            will allow the TOE to effectively enforce its policies on the network traffic of
            monitored networks. </description>
          <consistency-rationale/>
        </SOE>
        <SOE name="OE.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
          <consistency-rationale/>
        </SOE>
      </SOEs>
    </section>
    <section title="Security Objectives Rationale" id="SOR">
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </chapter>
  <chapter title="Security Requirements" id="sfrs">
    <base-pp version="2.1" name="Network Device" product="Network Device" short="ND"
      url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=440&amp;id=440" xmlurl="test">
      <modified-sfrs>
        <subsection title="Protection of the TSF (FPT)" id="fpt">
          <f-component id="fpt_itt.1" name="Basic Internal TSF Data Transfer Protection"> <!-- NIAP: So now that we have added DTLS back it, this is no longer modified from how it is in ND. It is optional in ND, but needs to be mandatory for WIDS. -->
            <consistency-rationale/>
            <f-element>
              <title>The TSF shall protect TSF data from <h:u>disclosure and <h:b>detect its</h:b>
                  modification</h:u> when it is transmitted between separate parts of the TOE
                  <h:b>through the use of <selectables>
                    <selectable>IPsec</selectable>
                    <selectable>SSH</selectable>
                    <selectable>TLS</selectable>
                    <selectable>DTLS</selectable>
                    <selectable>HTTPS</selectable>                   
                  </selectables></h:b>. </title>
              <note role="application"> FPT_ITT.1 is optional in NDcPP, however, since a WIDS/WIPS
                TOE is distributed, FPT_ITT.1 shall be included in the ST and is applicable to the data transmitted between the sensors and
                controller.<h:br/><h:br/> 
                This requirement ensures all communications between
                components of a distributed TOE is protected through the use of an encrypted
                communications channel. The data passed in this trusted communication channel are
                encrypted as defined in the protocol chosen in the selection. The ST author chooses
                the mechanisms supported by the TOE, and then ensures that the detailed protocol
                requirements in Appendix B of NDcPP corresponding to their selection are included in
                the ST, if not already present. </note>
              <aactivity> The evaluator shall perform the evaluation activity specified in NDcPP for
                this SFR. <no-tests/>
              </aactivity>
            </f-element>
          </f-component>
        </subsection>
        <subsection title="Trusted Paths/Channels (FTP)" id="ftp">
          <f-component id="ftp_itc.1" name="Inter-TSF trusted channel"> <!-- DONE -->
            <consistency-rationale/>
            <f-element>
              <title> The TSF shall <h:b>be capable of using <selectables>
                <selectable>IPsec</selectable>
                <selectable>SSH</selectable>
                <selectable>TLS</selectable>
                <selectable>DTLS</selectable>
                <selectable>HTTPS</selectable>                
                  </selectables> to</h:b> provide a trusted communication channel between itself and
                  <h:b>authorized IT entities supporting the following capabilities: audit server, <selectables>
                    <selectable>database server</selectable>
                    <selectable><assignable>other capabilities</assignable></selectable>
                    <selectable>no other capabilities</selectable>
                  </selectables></h:b> that is logically distinct from other communication channels
                and provides assured identification of its end points and protection of the channel
                data from <h:b>disclosure and detection of modification of the channel data. The intent of the database server is to store WIDS/WIPS data that must
                be queryable, such as events/alarms, triangulation calculations, wireless spectrum analysis (including RF jammer/Denial of Service (DoS)),
                and packet capture analysis. Authorized Administrators must be permitted to view alarms, raw event data, and any other data stored in the database.
                The Administrator must access the database through a trusted channel if done so remotely.</h:b>
              </title>
            </f-element>
            <f-element>
              <title>The TSF shall permit <h:b><h:u>the TSF or the authorized IT
                  entities</h:u></h:b> to initiate communication via the trusted channel.</title>
            </f-element>
            <f-element>
              <title> The TSF shall initiate communication via the trusted channel for
                  <assignable>list of services for which the TSF is able to initiate
                  communications</assignable>.</title>
              <note role="Application"> The intent of the above requirement is to provide a means by
                which a cryptographic protocol may be used to protect external communications with
                authorized IT entities that the TOE interacts with to perform its functions. The TOE
                uses at least one of the listed protocols for communications with the server that
                collects the audit information. <h:br/><h:br/> If the TSF uses a separate database
                server, the database server selection must included in the ST.<h:br/><h:br/> If
                other authorized IT entities are protected, the ST author makes the appropriate
                assignments (for those entities) and selections (for the protocols that are used to
                protect those connections). The ST author selects the mechanism or mechanisms
                supported by the TOE, and then ensures that the detailed protocol requirements in
                Appendix B of NDcPP corresponding to their selection are included in the ST. </note>
              <aactivity> The evaluator shall perform the evaluation activity specified in NDcPP for
                this SFR, with the inclusion of test 4, which is objective in NDcPP. <no-tests/>
              </aactivity>
            </f-element>
          </f-component>
        </subsection>
      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module extends the Network Device cPP, the TOE type for the overall TOE
        is still WIDS/WIPS products. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
    </base-pp>
    <man-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        <f-component id="fau_arp.1" name="Security Alarms"> <!-- DONE -->
          <consistency-rationale/>
          <f-element id="fel-arp">
            <title> The TSF shall <h:i>display an alert to Authorized Administrator in sufficient
              detail to include identity of APs and EUDs involved, signal strength, accurate event timestamp, description of alert and severity level and</h:i>
              <selectables>
                <selectable id="pcap">capture raw frame traffic that triggered the violation</selectable>
                <selectable>no other actions</selectable>
              </selectables>upon detection of a potential security violation.</title>
            <note role="application"> If "capture raw frame traffic that triggers the violation" is
              selected then FAU_STG_EXT.1/PCAP shall be included in the ST. <h:br/><h:br/>
              FAU_SAA.1 defines the rules for monitoring the wireless traffic to detect for potential security violations. FAU_INV_EXT.2 defines the information the TOE needs to collect for all APs and EUDs within range of the the TOE's sensors. Device attributes can then be individually filtered
              and/or selected in order to be displayed as part of the alert.
            </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes where to find the WIDS alerts
                on the Administrator console/interface.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall use the operational guidance for instructions on where
                the alerts generated are displayed within the WIDS interface. If "capture raw frame traffic that triggers the violation is selected", the
                evaluator shall use the operational guidance to configure the traffic capture
                capabilities.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall perform a series of events or generate traffic that
                    would successfully trigger an alert for each of the rules defined in FAU_SAA.1. The evaluator should verify and record
                    whether the TOE generated the alert for each rule, and provided sufficient details. The evaluator should also record the events
                    or traffic that was generated as each alert was attempted to be triggered and
                    record the details provided by the TOE in the alert. </test>
                  <test><h:i>[conditional]</h:i> If capturing of raw frames was selected, verify
                    that the packet capture was triggered and stored as appropriate.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Security Alarm Filtering" fam-id="FAU_ARP_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_arp_ext.2" name="Security Alarm Filtering"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall provide the ability to apply <assignable>methods of
                selection</assignable> to selectively exclude alerts from being generated. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the ability of the TOE to
                transmit WIDS alerts.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance includes
                instructions on enabling and disabling alerts.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>                
                      <step>The evaluator shall use the operational guidance to enable/disable
                        detection of available detection capabilities through the WIDS administrator
                        interface. The evaluator shall then generate traffic that would successfully
                        trigger the alert. The evaluator should verify that the TOE generated the
                        alert. </step>
                      <step>The evaluator shall disable the alert. The evaluator shall then generate
                        events as in previous test that should successfully trigger the alert. The
                        evaluator shall verify that the TOE did not generate an alert. </step>                 
                </steplist>
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="fau_gen.1" name="Audit Data Generation" iteration="WIDS">  <!-- DONE -->      
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall be able to generate an audit record of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [not specified] level of audit;</h:li>
                <h:li><h:i>[Auditable events listed in <ctr-ref refid="auditWids"/>;</h:i></h:li>
                <h:li><h:i>Failure of wireless sensor communication].</h:i></h:li>
              </h:ol>
              <h:table>
                <h:tr class="header"><h:td>Requirement</h:td><h:td>Auditable
                    Events</h:td><h:td>Additional Audit Record Contents</h:td></h:tr>
                <h:tr><h:td>FAU_ANO_EXT.1 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_ARP.1</h:td><h:td>Actions taken due to potential security
                    violations</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_ARP_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_GEN.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_IDS_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.1</h:td><h:td>Presence of whitelisted
                    device</h:td><h:td>Type of device (AP or EUD), MAC Address</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>                
                <h:tr><h:td>FAU_INV_EXT.3</h:td><h:td>Location of AP or EUD</h:td><h:td>MAC Address,
                    device type, classification of device, sensor(s) that detected device, signal
                    strength as received by detecting sensor(s), proximity to detecting
                    sensor(s)</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.5 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.6 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_MAC_EXT.1 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_SAA.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_SIG_EXT.1 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_STG_EXT.1/PCAP
                  (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td rowspan="2">FAU_WID_EXT.1</h:td><h:td>Detection of rogue AP or
                    EUD</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>Detection of unauthorized SSID</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.2</h:td><h:td>Sensor wireless transmissions
                    capabilities.</h:td><h:td>Wireless transmission cappabilities are turned
                    on.</h:td></h:tr>               
                <h:tr><h:td>FAU_WID_EXT.3 (OPTIONAL)</h:td><h:td>Detection of network devices
                    operating in selected RF bands</h:td><h:td>Frequency band, channel used within
                    frequency band, identification information (MAC address if applicable or other
                    similar unique ID), device technology (i.e., cellular), sensor(s) that detected
                    devices</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.4 (OPTIONAL)</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WIP_EXT.1 (OPTIONAL)</h:td><h:td>Isolation of AP or
                    EUD</h:td><h:td>Description of violation, type of containment used, was
                    containment triggered manually or automatically, sensor performing the
                    containment (if wireless), details about the device (s) being contained
                    (classification, device type, MAC address).</h:td></h:tr>
                <h:tr><h:td>FDP_IFC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FMT_SMF.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FPT_FLS.1 (OPTIONAL)</h:td><h:td>Information about
                    failure.</h:td><h:td>Indication that there was a failure, type of failure,
                    device that failed, and time of failure.</h:td></h:tr>
                <h:tr><h:td>FPT_ITT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FTP_ITC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
              </h:table>
              <ctr ctr-type="Table" id="auditWids">: Auditable Events</ctr>
            </title>
            <note role="application"> The auditable events defined in <ctr-ref refid="auditWids"/>
              are for the SFRs that are explicitly defined in this PP-Module and are intended to
              extend FAU_GEN.1 in the Base-PP. The events in the <ctr-ref refid="auditWids"/> should
              be combined with those of the ND cPP in the context of a conforming Security
              Target.<h:br/><h:br/> The Auditable Events (<ctr-ref refid="auditWids"/>) includes
              optional and objective SFRs. The auditing of optional and objective SFRs is only
              required if that SFR is included in the ST. <h:br/><h:br/> Per FAU_STG_EXT.1 in the
              Base-PP, the TOE must support transfer of the audit data to an external IT entity
              using a trusted channel. </note>
          </f-element>
          <f-element>
            <title> The TSF shall record within each audit record at least the following
              information: <h:ol type="a">
                <h:li>Date and time of the event, type of event, and subject identity (if
                  applicable);</h:li>
                <h:li>For each audit event type, based on the auditable event definitions of the
                  functional components included in the PP/ST, [<h:i>auditable events listed in
                      <ctr-ref refid="auditWids"/></h:i>]. </h:li>
              </h:ol>
            </title>
            <note role="application"> The subject identity in this case is the whitelisted inventory
              item. </note>
            <aactivity>
              <TSS> There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall test the TOE’s ability to correctly generate audit records
                by having the TOE generate audit records in accordance with the assurance activities
                associated with the functional requirements in this PP-Module. When verifying the
                test results, the evaluator shall ensure the audit records generated during testing
                match the format specified in the administrative guide, and that the fields in each
                audit record have the proper entries. <h:br/><h:br/> Note that the testing here can
                be accomplished in conjunction with the testing of the security mechanisms directly.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Reporting Methods" fam-id="FAU_GEN_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component name="Intrusion Detection System – Reporting Methods" id="fau_gen_ext.1">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall provide <selectables linebreak="yes">
                <selectable>Syslog using <selectables>
                    <selectable>defined API</selectable>
                    <selectable>Syslog</selectable>
                    <selectable><assignable>other detection method</assignable></selectable>
                  </selectables></selectable>
                <selectable>SNMP trap reporting using <selectables>
                    <selectable>defined API</selectable>
                    <selectable>Simple Network Management Protocol (SNMP)</selectable>
                    <selectable><assignable>other detection method</assignable></selectable>
                  </selectables></selectable>
              </selectables>. </title>
            <note role="application"> Syslog and/or SNMP trap reporting can be used. At least one
              reporting method must be selected.
            </note>
          </f-element>
          <f-element>
            <title> The TSF shall provide the ability to import data, such as a whitelist of APs and EUDs, and WIDS/WIPS configuration files from the system: <selectables>
                <selectable>custom API</selectable>
                <selectable>Syslog</selectable>
                <selectable>common log format</selectable>
                <selectable>CSV</selectable>
                <selectable><assignable>vendor detection method</assignable></selectable>
              </selectables>
            </title>
            <note role="application"> The system shall provide the ability to interact with an
              extensible interface to a third party wireless monitoring system for the purposes of
              importing data from the wireless system.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes which method the TOE utilizes. </TSS>
              <Guidance> There are no operational guidance activities for this SFR. </Guidance>
              <Tests> Depending on the detection technique used by the TOE, the evaluator shall
                confirm and note the existence of the capability. <testlist>
                  <test>
                    <steplist> 
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Confirm that the TSF can utilize SNMP and Syslog reporting
                        mechanisms.</step>
                      <step>Verify that the TSF can import and export observable event data in any
                        of the following formats:</step>
                      <h:ul>
                        <h:li>comma separated values (CSV)</h:li>
                        <h:li>common log format (CLF)</h:li>
                        <h:li>JavaScript Object Notation (JSON)</h:li>
                        <h:li>syslog</h:li>
                      </h:ul>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Intrusion Detection Methods" fam-id="FAU_IDS_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_ids_ext.1"
          name="Intrusion Detection System – Intrusion Detection Methods">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element id="fel-ids-meth">
            <title> The TSF shall provide the following methods of intrusion detection <selectables>
                <selectable id="anoBased">anomaly-based</selectable>
                <selectable id="sigBased">signature-based</selectable>
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables>. </title>
            <note role="application"> At least one detection method must be selected. If multiple
              detection methods are supported, each method supported shall be selected.
              <h:br/><h:br/> If anomaly-based detection is selected, then FAU_ANO_EXT.1 shall be
              included in the ST. If signature-based detection is selected, then FAU_SIG_EXT.1 shall
              be included in the ST.<h:br/><h:br/>
            </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes which intrusion detection
                method(s) the TOE utilizes. If multiple methods are selected, the evaluator shall
                confirm that the TSS describes how the different methods are
                incorporated.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to configure the TOE in order for it to detect such
                intrusions.<h:br/><h:br/>
              </Guidance>
              <Tests> Depending on the detection technique used by the TOE, the evaluator shall
                confirm and note the existence of the capability and test for the appropriate
                selection-based requirements. </Tests>
            </aactivity>
          </f-element>

        </f-component>
        <ext-comp-def title="Environmental Inventory" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_inv_ext.1" name="Environmental Inventory">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall determine if a given AP is authorized based on <selectables>
              <selectable>MAC addresses</selectable>
              <selectable><assignable>other unique device identifier</assignable></selectable>
            </selectables>
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall determine if a given EUD is authorized based on <selectables>
              <selectable>MAC addresses</selectable>
              <selectable><assignable>other unique device identifier</assignable></selectable>
            </selectables>
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall detect the presence of non-whitelisted EUDs and APs in the Operational Environment. </title>
            <note role="application"> 
              This inventory is used as a whitelist to indicate to the WIDS which APs and EUDs are authorized members of the wireless network. The inventory of authorized APs and EUDs is configured by FMT_SMF.1/WIDS. <h:br/><h:br/> 
              The terminology used to describe an inventoried or whitelisted device may vary by vendor
              product. This PP-Module utilizes whitelisted to describe APs and EUDs that are part of
              the inventory and non-whitelisted to describe APs and EUDs that are not part of the
              inventory. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes how the presence of authorized
                EUDs and APs is presented by the TOE. The evaluator shall verify that the TSS
                includes where in the WIDS interface the list of detected APs and EUDs is
                displayed.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to view authorized and unathorized APs and EUDs that are within
                range of the TOE sensors.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Per guidance in FMT_SMF.1/WIDS, add MAC Addresses or other unique device identifier 
                        for an AP and EUD to the whitelist.</step>
                      <step>Deploy the AP and EUD that were added to whitelist within the range of
                        the TOE's sensors.</step>
                      <step>Verify that the devices are classified as authorized.</step>
                      <step>Remove the EUD from the whitelist.</step>
                      <step>Verify that the EUD is classified as unauthorized.</step>
                      <step>Remove the AP from the whitelist.</step>
                      <step>Verify that the AP is classified as unauthorized.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and EUD, and connect the EUD to the AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the whitelisted
                        AP and EUD that were just deployed. </step>
                      <step>If the AP and EUD are detected verify that they are classified as
                        whitelisted devices.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP and EUD and connect the EUD to the
                        AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the
                        non-whitelisted AP and EUD that were just deployed.</step>
                      <step>If the AP and EUD are detected verify that they are not classified as
                        whitelisted devices.</step>
                    </steplist></test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Characteristics of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_inv_ext.2" name="Characteristics of Environmental Objects"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the <h:ul>
              <h:li>Current RF band</h:li>
              <h:li>Current channel</h:li>
              <h:li>MAC Address</h:li>
              <h:li>Received signal strength</h:li>           
              <h:li>Device detection timestamps</h:li>
              <h:li>Classification of APs and EUDs</h:li>
              <h:li><selectables>
                    <selectable><assignable>other details</assignable></selectable>
                    <selectable>no other details</selectable>
                  </selectables></h:li>
              </h:ul>of all APs and EUDs within range of the TOE’s wireless sensors.</title>
          </f-element>
          <f-element>
            <title> The TSF shall detect the follow additional details for all APs within range of the TOE’s wireless sensors:<h:ul>
                <h:li>encryption</h:li>
                <h:li>number of connected EUDs.</h:li>
              <h:li>Received frames/packets</h:li>
              <h:li>Beacon rate</h:li>
              <h:li>SSID of AP (if not hidden)</h:li>
              </h:ul>
            </title>
            <note role="Application"> For detection of encryption type, the TSF should be able to
              differentiate between the different WLAN encryption methods and when no encryption is
              in use. </note>
          </f-element>
          <f-element>
            <title> The TSF shall detect the follow additional details for all EUDs within range of the TOE’s wireless sensors:<h:ul>
                <h:li>SSID and BSSID of AP it is connected to.</h:li>
              <h:li>DHCP configuration</h:li>
              </h:ul>
            </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS explains the capability of detecting the information specified in the requirements for all APs and EUDs within the TOE’s wireless range.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance in order to verify that
                there are instructions that show how to locate the device inventory mentioned
                above.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP, non-whitelisted AP and two whitelisted
                        EUDs.</step>
                      <step>Connect one whitelisted EUD to the whitelisted AP and one to the
                        non-whitelisted AP.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that current RF band, current channel, MAC Address, received signal strength, device detection timestamps, classification of device, are part of the information presented on the WIDS user interface for all the APs and EUDs detected. 
                        For APs verify that encryption, number of connected EUDs, SSID (if not hidden), received frames/packets and beacon rate are presented. 
                        For EUDs verify that the SSID and BSSID of AP it is connected and DHCP configuration is presented.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Location of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_inv_ext.3" name="Location of Environmental Objects"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the physical location of APs and EUDs to within
                <assignable>value equal or less than 25</assignable> feet of their actual
              location.</title>
          </f-element>
          <f-element>
            <title> The TSF shall detect received signal strength and <selectables>
                <selectable>RF power levels above a predetermined threshold</selectable>
                <selectable>no other characteristics</selectable>
              </selectables> of hardware operating within range of the TOE’s wireless sensors. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes information on location
                tracking, optimal number of sensors and sensor placement to meet the required level
                of accuracy.<h:br/><h:br/> The evaluator shall verify that the TSS contains
                information regarding the TSF’s ability to record signal strength of hardware
                operating within range of its sensors.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to configure location tracking, how to load a location map (if applicable), and
                where in the TSF administrator interface the location of APs and EUDs can be
                viewed.<h:br/><h:br/> If the option for detection of RF power levels above a
                predetermined threshold is selected, the evaluator shall use the operational
                guidance to set or check what the threshold is in a given test. The evaluator should
                also verify that the operational guidance provides instruction on how to configure
                the TOE to generate an alert when the threshold is exceeded.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Verify the TSF provides location tracking information about the
                        AP.</step>
                      <step>Verify the AP location presented is within 25 feet actual
                        location.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the current received signal strength is part of the
                        information presented on the WIDS user interface about the APs and
                        EUDs.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="fau_saa.1" name="Potential Violation Analysis"> 
          <consistency-rationale/>
          <f-element>
            <title>The TSF shall be able to apply a set of rules for monitoring <h:b>the wireless
                traffic</h:b> and based upon these rules indicate a potential <h:b>malicious
                action</h:b>.</title>
          </f-element>
          <f-element>
            <title>The TSF shall enforce the following rules for monitoring <h:b>wireless traffic:</h:b>
              <h:ol type="a">
                <h:li>Accumulation or combination of <assignable>subset of defined auditable
                    events</assignable> known to indicate a potential security violation;</h:li>
                <h:li><h:i>Detection of non-whitelisted AP</h:i>;</h:li>
                <h:li><h:i>Detection of non-whitelisted EUD</h:i>;</h:li>               
                <h:li><h:i>Detection of authorized EUD establishing peer-to-peer connection with any other EUD</h:i>;</h:li>
                <h:li><h:i>Detection of EUD bridging two network interfaces</h:i>;</h:li>
                <h:li><h:i>Detection of unauthorized point-to-point wireless bridges by whitelisted APs</h:i>;</h:li>        
                <h:li><h:i>Alert generated by violation of user defined signature</h:i>;</h:li>
                <h:li><h:i>Detection of ICS connection</h:i>;</h:li>
                <h:li><h:i>Detection of traffic with excessive transmit power level</h:i>;</h:li>         
                <h:li><h:i>Detection of MAC spoofing</h:i>;</h:li>
                <h:li><h:i>Detection of unauthorized AP broadcasting authorized SSIDs</h:i>;</h:li>
                <h:li><h:i>Detection of authorized AP broadcasting an unauthorized SSID</h:i>;</h:li>
                <h:li><h:i>Detection of whitelisted EUD connected to unauthorized SSID</h:i>;</h:li>
                <h:li><h:i>Detection of NULL SSID associations</h:i>;</h:li>              
                <h:li><h:i>Detection of active probing</h:i>;</h:li>
                <h:li><h:i>Detection of packet flooding/DoS/DDoS</h:i>;</h:li>
                <h:li><h:i>Detection of RF-based denial of service</h:i>;</h:li>
                <h:li><h:i>Detection of deauthentication flooding</h:i>;</h:li>
                <h:li><h:i>Detection of disassociation flooding</h:i>;</h:li>
                <h:li><h:i>Detection of request-to-send/clear-to-send abuse</h:i>;</h:li>             
                <h:li><h:i>Detection of unauthorized authentication scheme use</h:i>;</h:li>
                <h:li><h:i>Detection of unauthorized encryption scheme use</h:i>;</h:li>
                <h:li><h:i>Detection of unencrypted traffic</h:i>;</h:li>
                <h:li><h:i>Detection of whitelisted EUD or AP that is using weak/outdated WLAN protocols and protocol implementations</h:i>;</h:li>
                <h:li><h:i>Detection of extremely high numbers of client devices using a particular whitelisted AP</h:i>;</h:li> 
                <h:li><h:i>Detection of a high number of failed attempts to join the WLAN in a short period of time</h:i>;</h:li>
                <h:li><h:i>Detection of the use of active WLAN scanners (e.g. wardriving tools) to generate WLAN traffic, such as Probes, Auths, and Assoc frames</h:i>;</h:li>
                <h:li><h:i>Detection of the physical location of an identified WLAN threat by using triangulation</h:i>;</h:li>
                <h:li><h:i>Detection of an SSID using weak/unsupported/disallowed encryption options</h:i>;</h:li>
                <h:li><h:i>Detection of AP SSID larger than 32 bytes</h:i>;</h:li>
                <h:li><h:i>Detection of excessive WPS negotiations</h:i>;</h:li>
                <h:li><assignable>any other rules</assignable>.</h:li>
              </h:ol>           
            </title>
            <note role="Application">
              These rules are used to detect a potential security violation. Maintenance of the rules by adding, modifying or deletion of rules from the set of rules is handled by FMT_SMF.1/WIDS.<h:br/><h:br/>
              If a potential security violation is detected the alert generated for the Administrator is handled by FAU_ARP.1.
            </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes the ability of the TOE to detect the network behavior described by the SFR. The evaluator shall verify that the TSS describes the methods that the TOE uses to detect the presence of unauthorized connections and unauthorized network traffic. The evaluator shall examine the TSS to verify that it describes the denial of service attacks that can be detected by the TOE. The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized WLAN authentication schemes and encryption schemes are used. The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized APs and EUDs send or receive unencrypted data. <h:br/><h:br/>
              </TSS>
              <Guidance>                 
                If the ability of the TSF to detect the different potential security violations is configurable, the evaluator shall verify that the operational guidance provides instructions on how to configure the TOE.<h:br/><h:br/>                
              </Guidance>
              <Tests>  
                <testlist>
                  <test><h:b>Detection of non-whitelisted AP</h:b>: 
                    <steplist>
                      <step>Deploy a non-whitelisted AP.</step>
                      <step>Verify that the AP is detected as a non-whitelisted AP.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of non-whitelisted EUD</h:b>:
                    <steplist>
                      <step>Deploy a non-whitelisted EUD.</step> 
                      <step>Verify that the EUD is detected as an non-whitelisted EUD.</step>             
                    </steplist>
                    <h:br/>
                  </test>               
                  <test><h:b>Detection of authorized EUD establishing peer-to-peer connection with any other EUD</h:b>:
                    <testlist>
                      <test> Create the following connections between two whitelisted EUDs. <h:ul>
                        <h:li>Windows Ad Hoc Connection</h:li>
                        <h:li>Mac OS Ad Hoc</h:li>
                        <h:li>Linux Ad Hoc</h:li>
                        <h:li>Wi-Fi Direct</h:li>
                      </h:ul>
                      </test>
                      <test> Create the following connections between one whitelisted EUD and a
                        non-whitelisted EUD <h:ul>
                          <h:li>Windows Ad Hoc Connection</h:li>
                          <h:li>Mac OS Ad Hoc</h:li>
                          <h:li>Linux Ad Hoc</h:li>
                          <h:li>Wi-Fi Direct</h:li>
                        </h:ul>
                      </test>
                    </testlist> Verify that alerts were generated by each of the connections in each test. 
                    <h:br/><h:br/>
                  </test>
                  <test><h:b>Detection of EUD bridging two network interfaces</h:b>:<h:br/>
                     Bridge two network interfaces on a whitelisted EUD (one must be the wireless card listed as whitelisted).                  
                      <h:ul>
                        <h:li>Create a Windows Hosted Network with a whitelisted EUD. </h:li>
                        <h:li>Connect a different whitelisted EUD to the network.</h:li>
                      </h:ul>
                    Verify that alerts were generated by each of the connections in each test.
                    <h:br/><h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized point to point wireless bridges by whitelisted APs</h:b>:
                      <steplist>
                        <step>Setup a point-to-point wireless bridge using whitelisted APs in the
                          range of the wireless sensors.</step>
                        <step>Verift that the TSF detects the bridge.</step>
                      </steplist>
                    <h:br/>
                  </test>             
                  <test><h:b>Alert generated by violation of user defined signature</h:b>:
                      <steplist>
                        <step>Setup a user defined detection signature.</step>
                        <step>Verify that the TSF generates an alert once the rules of signature have been violated.</step>
                      </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of ICS connection</h:b>:                 
                       <steplist>
                         <step>Setup an Internet Connection Sharing (ICS) connection.</step>
                         <step>Verify that the TSF detects the establishment of the ICS connection.</step>
                       </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of traffic with excessive transmit power level</h:b>:                
                       <steplist>
                         <step>Configure a source of network traffic that can exceed the maximum transmit
                             power levels of 100mW on 2.4GHz and 200mW on 5GHz.</step>
                         <step>Configure a user defined signature to detects traffic with transmit power levels
                             that exceed the maximum.</step>
                         <step>Commence with the transmission of network traffic at excessive power levels.</step>
                         <step>Collect wireless traffic with range of the TSF.</step>
                         <step>Verify that the TSF detects wireless traffic that exceeds
                          100mW on 2.4GHz and 200mW on 5GHz.</step>
                       </steplist>
                    <h:br/>
                  </test>              
                  <test><h:b>Detection of MAC spoofing</h:b>:                
                    <testlist>
                      <test>
                        <steplist>
                          <step>Spoof mac address of whiteliste EUD connected to a whitelisted AP on a
                            second EUD. </step>
                          <step>Connect EUD with spoofed MAC address to another whitelisted AP while the
                            valid EUD it is spoofing is connected to the first AP. </step>
                          <step>Verify that the TSF detected the MAC spoofing.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Spoof mac address of whiteliste AP on a second AP. </step>
                          <step>Verify that the TSF detected the MAC spoofing.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized AP broadcasting authorized SSIDs</h:b>:
                    <steplist>
                      <step>Configure a non-whitelisted AP to operate on a set channel on the 2.4 GHz band broadcasting an authorized SSID.</step>
                      <step>Verify that the TSF detects the non-whitelisted AP broadcasting an authorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>                 
                  <test><h:b>Detection of authorized AP broadcasating an unathorized SSID</h:b>:
                    <steplist>
                      <step>Configure a whitelisted AP to operate on a set channel on the 2.4 GHz band broadcasting an unauthorized SSID.</step>
                      <step>Verify that the TSF detects the non-whitelisted AP broadcasting an authorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of whitelisted EUD connected to unauthorized SSID</h:b>: 
                    <steplist>                    
                      <step>Configure a whitelisted AP to operate on a set channel on the 2.4 GHz band with an unauthorized SSID.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Verify that the TSF detects the whitelisted EUD associated to the whitelisted AP broadcasting an unauthorized SSID.</step>
                      <step>Repeat the test utilizing the 5 GHz band.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of NULL SSID associations</h:b>:
                      <steplist>
                        <step>Deploy whitelisted AP.</step>
                        <step>Configure the AP to have null SSID.</step>
                        <step>Attempt to connect a whitelisted EUD to the AP without supplying the correct AP SSID.</step>
                        <step>Verify that the AP does not permit the EUD to complete an association by returning a Probe Request.</step>
                        <step>If an association does occur, confirm that an alert is triggered due to a violation of policy.</step>
                      </steplist>
                    <h:br/>
                  </test>              
                  <test><h:b>Detection of active probing</h:b>:
                    <steplist>
                      <step>Perform an active scan on the subnet of the WLAN.</step>
                      <step>Record tools used and type of scan performed. </step>
                      <step>Verify that the TSF detects the active probing.</step>
                    </steplist>
                    <h:br/>
                </test>
                  <test><h:b>Detection of packet flooding/DoS/DDoS</h:b>:
                    <steplist>
                      <step>Generate a large amount of TCP and UDP traffic from a single EUD.</step>
                      <step>Verify that the TSF detects the network-based DoS.</step>
                      <step>Generate a large amount of TCP and UDP traffic from multiple EUDs.</step>
                      <step>Verify that the TSF detects the network-based DDoS.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of RF-based denial of service</h:b>:                  
                    <steplist>
                      <step>Deploy a whitelisted AP and configure to stay in a particular channel.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Use an RF Jammer or signal generator on the same frequency as the AP and EUD to create a RF-based DoS.</step>
                      <step>Verify that the TOE detects the RF-based DoS.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of deauthentication flooding</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy whitelisted AP and configure to a set channel.</step>
                          <step>Connect a whitelisted EUD to the AP.</step>
                          <step>Send an flood of deauthentication frames to the EUD using the MAC address of whitelisted AP it is connected to.</step>
                          <step>Verify that the TSF detects the deauthentication flood.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy whitelisted AP and configure to a set channel.</step>
                          <step>Connect a whitelisted EUD to the AP.</step>
                          <step>Send an flood of deauthentication frames with the MAC address of whitelisted AP as the source and destination as a broadcast.</step>
                          <step>Verify that the TSF detects the deauthentication flood.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of disassociation flooding</h:b>:
                        <steplist>
                          <step>Deploy a whitelisted AP and connect authorized EUDs.</step>
                          <step>Generate disassociation frames from an unauthorized EUD.</step>
                          <step>Verify that the TSF detected the disassociation flooding.</step>
                        </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of request-to-send/clear-to-send abuse</h:b>:
                    <steplist>
                      <step>Deploy whitelisted AP and configure to a set channel.</step>
                      <step>Connect two whitelisted EUDs to the AP.</step>
                      <step>Send an flood of CTS frames to reserve RF medium.</step>
                      <step>Verify that the TSF detects the CTS abuse.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized authentication scheme use</h:b>:<h:br/>
                    The evaluator shall configure the TOE, per FMT_SMF.1/WIDS, with 802.1x authentication as the only mode of authorized WLAN authentication scheme. 
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy a whitelisted AP with open authentication.</step>
                          <step>Connect a whitelisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes. </step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy a whitelisted AP that uses pre-shared key authentication.</step>
                          <step>Connect a whitelisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of unauthorized encryption scheme use</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Configure the TOE with 128 bit AES encryption type as the only allowed encryption scheme.</step>
                          <step>Deploy a whitelisted AP with no encryption.</step>
                          <step>Connect a whitelisted EUD to AP.</step>
                          <step>Verify that the TOE detects the AP and the EUD using unauthorized encryption schemes.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Configure the TOE with 128 bit AES encryption type as the only allowed encryption scheme.</step>
                          <step>Deploy a whitelisted AP that uses TKIP encryption only.</step>
                          <step>Connect a whitelisted EUD to AP.</step>
                          <step>Verify that the TSF detects the AP and the EUD using unauthorized encryption schemes.</step>
                        </steplist>
                      </test>
                    </testlist> 
                    <h:br/>
                  </test>            
                  <test><h:b>Detection of unencrypted traffic</h:b>:
                    <testlist>
                      <test>
                        <steplist>
                          <step>Deploy a whitelisted AP with no encryption.</step>
                          <step>Connect a whitelisted EUD to AP and generate traffic.</step>
                          <step>Verify that the TOE detects unencrypted data frames being sent between the whitelisted AP and EUD.</step>
                          <step>Connect a non-whitelisted EUD to AP and generate traffic.</step>
                          <step>Verify that the TSF detects unencrypted data frames being sent between the whitelisted AP and non-whitelisted EUD.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy a non-whitelisted AP with no encryption.</step>
                          <step>Connect a whitelisted EUD to AP and generate traffic.</step>
                          <step>Verify that the TSF detects unencrypted data frames being between the non-whitelisted AP and whitelisted EUD.</step>
                        </steplist>
                      </test>
                    </testlist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of whitelisted EUD or AP that is using weak/outdated WLAN protocols and protocol implementations</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP that utilizes the 802.11g or older WLAN protocol.</step>
                          <step>Verify that the TSF detects the weak/outdated WLAN protocol and generates an alert.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of extremely high numbers of client devices using a particular whitelisted AP</h:b>:                   
                    <steplist>
                          <step>Deploy a whitelisted AP.</step>
                          <step>Configure a threshold amount of client devices that can use a particular AP.</step>
                          <step>Connect enough client devices to the AP to purposely exceed the defined threshold.</step>
                          <step>Verify that the TSF detects when the client usage exceeds the threshold.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of a high number of failed attempts to join the WLAN in a short period of time</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP.</step>
                          <step>Configure a threshold amount of connection attempts that can occur in a particular timeframe.</step>
                          <step>Attempt to authenticate to the AP with enough client devices to purposely exceed the defined threshold.</step>
                          <step>Verify that the TSF detects when the connection attempts within the specic timeframe exceeds the threshold.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of the use of active WLAN scanners (e.g. wardriving tools) to generate WLAN traffic</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP.</step>
                          <step>Verify that the TSF detects when WLAN scanners are the source of WLAN traffic.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of the physical location of an identified WLAN threat by using triangulation</h:b>:
                    <steplist>
                          <step>Deploy a non-whitelisted AP or EUD within range of the TSF.</step>
                          <step>Verify that the TSF can track and locate the AP or EUD to within 5 meters.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of an SSID using weak/unsupported/disallowed encryption options</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP and configure its encryption options.</step>
                          <step>Change the encryption options the AP advertises.</step>
                          <step>Verify that the TSF detects when the AP's encryption options change.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of AP SSID larger than 32 bytes</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP and configure its SSID to be larger than 32 bytes.</step>
                          <step>Configure a user defined signature on the WIDS to detect when an SSID is larger than 32 bytes.</step>
                          <step>Verify that the TSF detects when the AP's SSID is larger than 32 bytes.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  <test><h:b>Detection of excessive WPS negotiations</h:b>:
                    <steplist>
                          <step>Deploy a whitelisted AP and permit WPS authentication.</step>
                          <step>Configure a threshold amount of WPS connections that are allowed in a specific amount of time on the AP</step>
                          <step>Verify that the TSF detects when the AP's WPS connection threshold has been exceeded.</step>
                    </steplist>
                    <h:br/>
                  </test>
                  
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Malicious Environmental Objects" fam-id="FAU_WID_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.1" name="Wireless Intrusion Detection – Malicious Environmental Objects"> 
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall distinguish between benign and malicious APs and EUDs based on if the APs and EUDs are authorized and <selectables>
              <selectable>automatic detection metrics</selectable>
              <selectable>no other method</selectable>
            </selectables>.</title>
            <note role="Application"> 
              FAU_INV_EXT.1 defines that an AP or EUD is authorized based on if the AP/EUD is whitelisted as configured in FMT_SMF.1. A non-whitelisted device does not always have to be conducting malicious activity. However, it is acceptable to equate a whitelisted AP/EUD as both authorized/benign and a nonwhitelisted AP/EUD as both not authorized and thus malicious. If the TOE supports automatic malicious device detection, based on in-depth network traffic analysis, "automatic detection metrics" shall be selected. This can be used to further distinguish if the AP/EUD is benign or malicious. If the TOE does not support automatic detection metrics, "no other method" shall be selected.
            </note>
          </f-element>
          <f-element>
            <title> The TSF shall provide the ability to determine if a given SSID is authorized. </title>
            <note role="application"> FMT_SMF.1/WIDS defines the subset of authorized SSID(s). </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes how the TOE detects malicious
                APs/EUDs and whether the TOE supports automatic detection. The evaluator shall
                verify that the TSS includes how the TOE determines if a given SSID is authorized.
                <h:br/><h:br/>
              </TSS>
              <Guidance> If TOE supports automatic detection, the evaluator shall
                verify that the operational guidance contains instructions for configuring the
                automatic detection metrics. The evaluator shall verify that the operational guidance
                provides instructions on how to configure SSIDs as authorized.<h:br/><h:br/>
              </Guidance>
              <Tests>
                               
                  For test 1 and 2 below the evaluator shall verify that the TOE detects and appropriately classifies the APs and EUDs. It is acceptable if the TOE uses different but equivalent descriptors for the classification. If the TOE does not support automatic detection metrics and equates a non-whitelisted AP/EUD as malicious, than it is sufficient that the the classification given to the AP/EUD in step 1 is the same as in step 2. If the TOE supports automatic detection metrics and distinguishes between a non-whitelisted AP/EUD and a malicious AP/EUD, then the classification for the AP/EUD should differ between step 1 and step 2.
                    <testlist>                    
                      <test>
                        <steplist>
                          <step>Deploy a non-whitelisted AP in the area of the WIDS sensor, but take no action against the network. Verify that the AP is classified as non-authorized.</step>
                          <step>Deploy a non-whitelisted AP in the area of the WIDS sensor and launch an attack against the network. This can be any variation of Fake AP, Spoof AP, Flood or DoS attack.</step> 
                          <step>Verify that the AP is classified as malicious.</step>
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy a non-whitelisted EUD in the area of the WIDS sensor, but take no action against the network. Verify that the EUD is classified as non-authorized.</step>
                          <step>Launch an RF Flooding, DoD/DDoS, masqueraded or spoofing attack against authorized AP with an unauthorized EUD.</step> 
                          <step>Verify that the EUD is classified as malicious.</step>                        
                        </steplist>
                      </test>
                      <test>
                        <steplist>
                          <step>Deploy an AP with an unauthorized SSID in the area of the WIDS sensor.</step>
                          <step>Verify that the TOE detects the unauthorized SSID.</step>
                        </steplist>
                      </test>
                    </testlist>
                  
                
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Passive Information Flow Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.2" name="Wireless Intrusion Detection – Passive Information Flow Monitoring">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall <selectables>
                <selectable>simultaneously</selectable>
                <selectable>nonsimultaneously</selectable>
              </selectables> monitor and analyze network traffic matching the 802.11 monitoring SFP
              for all channels in the following RF frequencies: <h:ul>
                <h:li>2.4 GHz</h:li>
                <h:li>4.9/5.0 GHz</h:li>
              </h:ul>
              <selectables linebreak="yes">
                <selectable>channels outside regulatory domain</selectable>
                <selectable>non-standard channel frequencies</selectable>
                <selectable>no other domains</selectable>
              </selectables>. </title>
            <note role="Application"> 
              If "nonsimultaneously" is selected, then "Define the amount of
              time sensor monitors a specific channel" shall be selected in FMT_SMF.1/WIDS.
              <h:br/><h:br/> The "802.11 monitoring SFP" is a security function policy and the SFRs
              that reference this policy describe what the policy does. The "802.11 monitoring SFP"
              is established in FDP_IFC.1 and defined through FAU_WID_EXT.1, FAU_WID_EXT.2,
              in addition to optional SFRs
              FAU_WID_EXT.3 and FAU_WID_EXT.4. A vendor does not have to formally define this
              policy, it only needs to comply with the SFRs.</note>
          </f-element>
          <f-element>
            <title> The TSF shall provide wireless sensors to detect network traffic matching the
              802.11 monitoring SFP that <selectables>
                <selectable>can be configured to prevent transmission of data</selectable>
                <selectable>does not transmit data</selectable>
              </selectables>. </title>
            <note role="application"> 
              If "can be configured to prevent transmission of data" is
              selected then "Enable/Disable transmission of data by wireless sensor" shall be
              selected in FMT_SMF.1/WIDS. <h:br/><h:br/> 
              The intent of this SFR is to employ WIDS
              sensors that can have all wireless transmission capabilities disabled for instances
              where a site wishes to implement a no wireless policy. <h:br/><h:br/>  
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe
              what the policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1 and
              defined through FAU_WID_EXT.1, FAU_WID_EXT.2, in addition to optional SFRs FAU_WID_EXT.3 and FAU_WID_EXT.4. A vendor
              does not have to formally define this policy, it only needs to comply with the SFRs.
            </note>
          </f-element>
          <f-element>
            <title> The TSF shall perform stateful frame inspection and log attacks spanning
              multiple frames. </title>
            <note role="application"> 
              Attackers possess the capability to distribute an attack
              across multiple frames in an attempt to avoid traditional detection measures that
              solely focus on packet headers. Stateful frame inspection will allow for the
              identification of obfuscation techniques centered around spreading an attack across
              multiple frames.</note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes which channels the TOE can
                detect and monitor. Additionally, the TSS shall include whether the TOE
                simultaneously or nonsimultaneously monitors network traffic across these channels.
                The evaluator shall verify that the TSS includes information on if the sensors are
                completely passive, by default, or if the sensors ability to transmit data is
                configurable. <h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance for how to configure
                the TOE to monitor the channels as selected in the SFR. If the sensor ability to
                transmits data is configurable, the evaluator shall review the operational guidance
                for how to disable wireless transmissions from the sensor. The TOE shall have the
                ability to perform stateful frame inspection and log attacks spanning multiple
                frames. The evaluator shall verify that the operational guidance provides
                instructions on how to specify and confirm that stateful frame capture and
                inspection is being performed.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <h:b>Channels Monitored</h:b>
                <testlist>
                  <test> Channels on On 5GHz band <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy an AP on at least 2 different channels within the regulatory
                        domain on 5GHz band.</step>
                      <step>Deploy an AP on at least 2 different channels outside the regulatory
                        domain on 5GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Channels on 2.4GHz band <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels within the regulatory domain
                        on 2.4GHz band.</step>
                      <step>Deploy AP on at least 2 different channels outside the regulatory domain
                        on 2.4GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Non-standard channel frequencies <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels on non-standard channel
                        frequencies.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                </testlist>
                <h:b>Wireless Sensor Transmission of Data</h:b><h:br/><h:br/> 
                If the TOE provides the ability to disable wireless transmission, the evaluator shall follow the operational guidance to configure the sensor to not transmit wirelessly. The evaluator shall then deploy a signal analyzer in order to check for wireless emanations from the TOE. <h:br/> 
                Repeat the two tests below, for both the 2.4GHz and the 5 GHz band.<h:br/> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Boot a sensor and using the signal analyzer observe to check if any
                        eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>During normal sensor operations, observe the analyzer for about 10
                        minutes to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                </testlist>              
                <h:b>Stateful Frame Inspection</h:b>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy whitelisted AP.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Deploy a protocol analyzer or native capability within the WIDS Controller between the AP and EUD.</step>
                      <step>Verify from the network traffic packet capture that all frames are being inspected to validate their connection state from the TSF</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>        
      </subsection>

      <subsection title="User Data Protection (FDP)" id="fdp">
        <f-component id="fdp_ifc.1" name="Information Flow Control Policy">
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall enforce the <h:i>[802.11 monitoring SFP]</h:i> on <h:i>[all IEEE
                802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <h:ul>
                <h:li><h:i>authorized APs and authorized EUDs </h:i></h:li>
                <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                <h:li><h:i>unauthorized APs and authorized EUDs</h:i>].</h:li>
              </h:ul>
            </title>
            <note role="application"> “Authorized” EUDs/APs are those that are assigned to the
              whitelist as defined by FMT_SMF.1/WIDS. <h:br/><h:br/> The "802.11 monitoring SFP" is
              a security function policy and the SFRs that reference this policy describe what the
              policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1 and defined
              through FAU_WID_EXT.1, FAU_WID_EXT.2,
              in addition to optional SFRs FAU_WID_EXT.3 and FAU_WID_EXT.4. A vendor does not have
              to formally define this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS> There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> If this functionality is configurable, the evaluator shall verify that the
                operational guidance provides instructions on how to configure the TOE to monitor
                different types of IEEE 802.11 frame types and subtypes.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Set the WIDS sensor for a set channel</h:li>
                      <h:li>Start a traffic capture from the WIDS sensor</h:li>
                      <h:li>Send a set number of frames on the sensor's operating channel for all
                        IEEE 802.11 a, b, g, n, ac frame types and subtypes from/to the following: <h:ul>
                          <h:li><h:i>authorized APs and authorized EUDs</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs</h:i></h:li>
                        </h:ul></h:li>
                      <h:li>Verify that there are frames from all the types and subtypes in the
                        capture. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>

      <subsection title="Security Management (FMT)" id="fmt">
        <f-component id="fmt_smf.1" name="Specification of Management Functions (WIDS)"
          iteration="WIDS">
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall be capable of performing the following management functions for WIDS functionality: 
              <h:ul>
                <h:li>Define an inventory of authorized APs based on <selectables>
                  <selectable>MAC addresses</selectable>
                  <selectable><assignable>other unique device identifier</assignable></selectable>
                </selectables>,</h:li><!-- FAU_INV_EXT.1.1 -->
                <h:li>Define an inventory of authorized EUDs based on MAC addresses,</h:li><!-- FAU_INV_EXT.1.1 -->
                <h:li>Define rules for monitoring and alerting on the wireless traffic,</h:li><!-- FAU_SAA.1.1 -->
                <h:li>Define authorized SSID(s),</h:li><!-- FAU_WID_EXT.2.3 -->
                <h:li>Define authorized WLAN authentication schemes,</h:li><!-- FAU_SAA.1 -->
                <h:li>Define authorized WLAN encryption schemes,</h:li><!--FAU_SAA.1  -->
                <h:li>Define authorized and unauthorized TCP/IP and UDP traffic</h:li>
                <h:li>Define known malicious activity ports</h:li>
                <!-- New: (e.g. Floods of deauthentication frames or SYN packets should not be allowed). Defining authorized
                                and unauthorized TCP/IP and UDP traffic would be beneficial. Defining known malicious activity ports
                                that are used, or detecting the use of SSH tunneling techniques could be an appropriate mitigation strategy. 
                                This would of course also be accomplished at the network's boundary, and should not fall solely on the WIDS to
                                detect, but having some form of network traffic scheme-of-detection seems appropriate. Update: Having the WIDS track, manage, define
                                WLAN traffic schemes has been removed. This function should not reside on the WIDS, an an overlay solution has no visibility into 
                                WLAN traffic due to encryption. -->
                
                <h:li><selectables>
                    <selectable>Specification of periods of network activity that constitute baseline of expected behavior</selectable><!-- FAU_ANO_EXT.1-->
                    <selectable>Definition of anomaly activity</selectable><!-- FAU_ANO_EXT.1.2 -->
                    <selectable>Define classification rules to detect rogue APs</selectable><!-- FAU_WID_EXT.1.1 -->
                    <selectable><selectables>
                        <selectable>Enable</selectable>
                        <selectable>Disable</selectable>
                      </selectables> transmission of data by wireless sensor</selectable><!-- FAU_WID_EXT.2.2 -->
                    <selectable>Define attack signatures</selectable><!-- FAU_SIG_EXT.1.1 -->
                    <selectable>Define rules for overwriting previous packet captures</selectable><!-- FAU_STG_EXT.1.3/PCAP -->
                    <selectable>Define the amount of time sensor monitors a specific <selectables>
                        <selectable>frequency</selectable>
                        <selectable>channel</selectable>
                      </selectables></selectable>
                    <selectable>No other capabilities</selectable>
                  </selectables>.</h:li>
              </h:ul>
            </title>
            <note role="application"> 
              
              Define authorized WLAN authentication and encryption schemes
              does not enforce, but rather establishes a baseline to determine if an unauthorized
              scheme is used.<h:br/><h:br/> 
              If FAU_ANO_EXT.1 is included in the ST, "Specification
              of periods of network activity that constitute baseline of expected behavior" shall be
              selected. If FAU_ANO_EXT.1 is included in the ST and "manual configuration by
              administrators" is selected in FAU_ANO_EXT.1, then "Definition of anomaly activity"
              shall be selected.<h:br/><h:br/> 
              If "can be configured to prevent transmission of
              data" is selected in FAU_WID_EXT.2 then "Enable/Disable transmission of data by
              wireless sensor" shall be selected.<h:br/><h:br/> 
              It is expected that an Authorized
              Administrator will be responsible for configuring the AP to operate on a specific
              frequency persuaent to the 802.11 standard. The TSF will have the ability to adjust
              the amount of time it passively monitors and captures WLAN traffic on a given
              frequency and channel. </note>
            <aactivity>
             <TSS>
The evaluator shall review the TSS to verify that it includes information the
                ability of the TOE to define inventory of authorized APs and EUDs.<h:br/><h:br/> 
               The evaluator shall verify that the TSS describes the ability of the TOE to
               allow authorized administrators to define authorized WLAN authentication
               schemes.
</TSS>
<Guidance> 
                The evaluator shall review the operational guidance for instructions on how
                to configure and change clasification of APs and EUDs to indicate that they are part
                of the whitelist.<h:br/><h:br/> 
The evaluator shall review the operation guidance to determine how to configure which SSIDs are permitted on the network.<h:br/><h:br/>

The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN authentication scheme as authorized or
                unauthorized for the purposes of detection.<h:br/><h:br/>
  The evaluator shall examine the operational guidance to verify that it
  provides instructions on how to define a WLAN encryption scheme as authorized or
  unauthorized for the purposes of detection.<h:br/><h:br/>
</Guidance>

              <Tests> 
                <testlist>
                  <test> The evaluator shall define an inventory of authorized APs and EUDSs. The ability to detect whitelisted and non-whitelisted APs and EUDs will be tested in FAU_INV_EXT.1 and FAU_SAA.1.
                  </test>
                  <test>The evaluator shall define authorized SSIDs. The ability to detect authorized and unauthorized SSIDs will be tested in FAU_WID_EXT.2.3 and FAU_SAA.1.</test>
                
                <test>The evaluator shall configure the TSF with a set of allowed authentication and encryption
                  schemes. The ability to detect violation of this policy will be tested in FAU_SAA.1. </test>
                  <test> (conditional): If "Define the amount of time sensor monitors a specific frequency or channel" is selected:
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Verify that the TSF can be configured to capture traffic on a specific
                        channel for specific interval of time, and assign a specified frequency and
                        time interval.</step>
                      <step>Confirm that the TSF remains on the frequency and channel for the
                        time period specified.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </man-sfrs>
    <opt-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        <ext-comp-def title="Wireless Spectrum Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.3"
          name="Wireless Intrusion Detection – Non-Wireless Spectrum Monitoring">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the presence of network devices that operate in the
              following RF bands: <selectables>
                <selectable>3.6 GHz</selectable>
                <selectable>60 GHz</selectable>
                <selectable>sub-GHz (0-900 MHz)</selectable>
                <selectable id="cell">all cellular bands</selectable>
              </selectables>
            </title>
            <note role="application"> This SFR refers to Non-WLAN (IEEE 802.11 a, b, g, n, and ac)
              network devices that operate in the specified frequencies. There is an understanding that this 
              capability requires a TOE to use specialized, licensed radio systems. This SFR will allow for the introduction of an
              open API, set of defined interoperability standards, or other proprietary solution(s), to allow for third-party
              integrations.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the set of RF bands and
                technologies that the TSF can detect the use of. The TSS should also include
                instructions on how to enable and the hardware that is necessary for the additional
                band detection. <h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure detection of the technologies included in the ST as well as the
                hardware that is needed to perform this function.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall enable and configure detection of the selected
                technologies. <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects
                    the device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Wireless Spectrum Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.4"
          name="Wireless Intrusion Detection – Wireless Spectrum Analysis">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall provide a dedicated sensor for wireless spectrum analysis. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS to verify that the TOE provides a
                dedicated sensor for wireless spectrum analysis.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure dedicated spectrum analysis as well as the hardware that is
                needed to perform this function.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall enable and configure dedicated spectrum analysis and test
                the capabilities listed in the TSS. </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </opt-sfrs>
    <sel-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        <ext-comp-def title="Anomaly-Based Intrusion Detection" fam-id="FAU_ANO_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_ano_ext.1" name="Anomaly-Based Intrusion Detection">
          <selection-depends req="fel-ids-meth" ids="anoBased"/>
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall support the definition of <selectables>
                <selectable>baselines (‘expected and approved’)</selectable>
                <selectable>anomaly (‘unexpected’) traffic patterns</selectable>
              </selectables> including the specification of <selectables linebreak="yes">
                <selectable>throughput (data elements (e.g. bytes, packets, etc.) per time period
                  (e.g. minutes, hours, days))</selectable>
                <selectable>time of day</selectable>
                <selectable>frequency</selectable>
                <selectable>thresholds</selectable>
                <selectable><assignable>other methods</assignable></selectable>
              </selectables> and the following network protocol fields: <h:ul>
                <h:li>all management and control frame header elements.</h:li>
              </h:ul>
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall support the definition of anomaly activity through <selectables>
                <selectable>manual configuration by administrators</selectable>
                <selectable>automated configuration</selectable>
              </selectables>. </title>
            <note role="application"> The “baseline” and “anomaly” can be something manually
              defined/configured by a TOE administrator (or importing definitions), or something
              that the TOE is able to automatically define/create by inspecting network traffic over
              a period of time (a.k.a. “profiling”). </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the composition and
                construction of baselines or anomaly-based attributes specified in the SFR. The
                evaluator shall verify that the TSS provides a description of how baselines are
                defined and implemented by the TSF, or a description of how anomaly-based rules are
                defined and configured by the administrator. <h:br/><h:br/> The evaluator shall
                verify that the TSS describes the available modes of configuration (manual or
                automatic) and how to configure or import the baseline.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                configure baseline and/or anomalous traffic patterns based on what is stated in the
                TSS.<h:br/><h:br/> The evaluator shall verify that the operational guidance
                describes how to perform automatic and/or manual definition of anomaly activity
                based on what is selected in the ST.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall use the instructions in the operational guidance to
                configure baselines or anomaly-based rules through automated and/or manual means
                based on what is selected in the ST. The evaluator shall send traffic that does not
                match the baseline or matches the anomaly-based rule and verify the TSF detects the
                anomalous behavior and generates an alert. </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Signature-Based Intrusion Detection" fam-id="FAU_SIG_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_sig_ext.1" name="Signature-Based Intrusion Detection">
          <selection-depends req="fel-ids-meth" ids="sigBased"/>
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall support user-defined and customizable attack signatures. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the user-defined and
                customizable attack signatures that the TOE can define.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                information on how to configure user-defined and customizable attack signatures,
                including a description of the customization options that are
                available.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Craft a signature with the available fields indicated in the TSS.</step>
                      <step>Send a crafted frame that matches the signature to a whitelisted
                        EUD</step>
                      <step>Verify that the TSF triggers an alert based on the newly defined
                        signature.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Protected Audit Event Storage (Packet Captures)" fam-id="FAU_STG_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_stg_ext.1" iteration="PCAP"
          name="Protected Audit Event Storage (Packet Captures)">
          <!-- Later_TODO: Look at 1.2 in ND -->
          <!-- This component is copied from ND cPP and iterated to make a distintion between audit records and PCAPs -->
          <selection-depends req="fel-arp" ids="pcap"/>
          <!-- fau_arp.1.1 -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title>The TSF shall be able to transmit the captured/generated packets to an external IT
              entity hosting a protocol analyzer using a trusted channel according to FTP_ITC.1. </title>
            <note role="application"> Per FAU_STG_EXT.1 in the Base-PP, the TOE must support
              transfer of the audit data to an external IT entity using a trusted channel per
              FTP_ITC.1. Note that this PP-Module modifies FTP_ITC.1 from the Base-PP. If "capture
              raw frame traffic that triggers the violation" is selected in FAU_ARP.1, then this SFR
              shall be included in the ST, and this iteration is for the PCAPs generated as a
              selectable action completed upon detection of a potential security violation in
              FAU_ARP.1. </note>
          </f-element>
          <f-element>
            <!-- Later_TODO: Look at this element in NDcPP -->
            <title>The TSF shall be able to store generated packet captures on the TOE itself.
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall <selectables>
                <selectable>drop new packet capture data</selectable>
                <selectable>overwrite previous packet captures according to the following rule:
                    <assignable>rule for overwriting previous packet captures</assignable>
                </selectable>
                <selectable>
                  <assignable>other action</assignable>
                </selectable>
              </selectables> when the local storage space for packet capture data is full. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes the list of trusted channels
                (as specified in FTP_ITC.1) available in the TSF to transmit packet captures to an
                external entity. The evaluator shall verify that the TSS describes the ability of
                the TOE to store packet capture data within itself, how much storage space is
                available for packet capture data and where that data is stored. The evaluator shall
                verify that the TSS describes the behavior of the TOE when local storage space for
                packet capture data is exhausted and whether this behavior is
                configurable.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to configure the trusted channel. If the behavior of the TOE
                when local storage space for packet capture data is exhausted is configurable, the
                evaluator shall verify that the operational guidance provides information on what
                the configurable behaviors are and how they can be set.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure packet captures according to the guidance
                    specified. The evaluator shall then trigger an event that starts a capture and
                    verify through the tests in FTP_ITC.1 that the captured traffic being sent to
                    the external device is being sent through a trusted channel.</test>
                  <test>The evaluator shall configure packet captures to be stored on the TSF
                    according to the guidance specified. The evaluator shall then trigger an event
                    that starts a capture and verify that the packet capture was stored on the
                    TSF.</test>
                  <test>The evaluator shall define packet data retention and deletion rules on the
                    TSF according to the guidance specified and test the functionality of the
                    specified rules.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </sel-sfrs>
    <obj-sfrs>

      <subsection title="Security Audit (FAU)" id="fau">
        <!-- Originally I thought we needed to add this SFR, most likely do not need it, b/c ND cPP covers it.  -->
        <!-- <f-component id="fau_gen.1" name="Device Configuration - Exporting Event Data">         
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall allow for the for the export of all captured event logs. </title>
            <note role="application">It is expected that an Authorized Administrator will be
              responsible for providing event output from the TSF for the purposes of ingest into
              other analysis and reporting mechanisms. Having the ability to export event log data
              from the device is a necessary capability to satisfy this requirement. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.<h:br/><h:br/>
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> 
              <testlist>
                <test>
                  <steplist>
                    <step>Deploy a whitelisted AP and connect it to the protected wired
                      infrastructure via wire.</step>
                    <step>Confirm that the TSF can observe and capture traffic and events
                      generated by the AP.</step>
                    <step>Verify that the TSF can export its configuration and observable event
                      data in any of the following formats:</step>
                    <h:ul>
                      <h:li>comma separated values (CSV)</h:li>
                      <h:li>common log format (CLF)</h:li>
                      <h:li>JavaScript Object Notation (JSON)</h:li>
                      <h:li>syslog</h:li>
                    </h:ul>
                  </steplist>
                </test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>
          </f-component> -->
        <ext-comp-def title="Detection of Unauthorized Connections" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_inv_ext.5" name="Detection of Unauthorized Connections">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect when non-whitelisted APs have a wired connection to the
              internal corporate network.</title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes guidance on whether the TSF has
                the capability of detecting APs connecting to the protected wired network
                infrastructure. If the capability is present the TSS shall include configuration
                guidance for this feature.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to configure the WIDS to detect unauthorized APs connected to the protected wired
                infrastructure.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP.</step>
                      <step>Connect the AP via wire to the protected network infrastructure.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the rogue AP is detected and an alert generated on the
                        detection of an AP connected to the protected wired infrastructure.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <!-- NEW Component -->
        <ext-comp-def title="Signal Library" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_inv_ext.6" name="Signal Library">
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall include a signal library.</title>
            <note role="application">The TSF will need to have the ability to import, export, or
              update the exisiting signal library.</note>
            <aactivity>
              <TSS> There are no TSS assurance activities for this SFR. </TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to locate and verify that the WIDS comes preloaded with a signal library, as well as
                possesses the ability to import, export, and update the existing signal library if
                present.<h:br/><h:br/>
              </Guidance>
              <Tests> Depending on operation guidance provided for the TOE, the evaluator shall
                confirm and note the existence of the signal library, and test for the ability to
                import, export, and update the signal library. <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm and note whether the TSF has an existing signal library.</step>
                      <step>If existence is confirmed, verify that the TSF can import, export, and
                        update the existing signal library.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Device Impersonation" fam-id="FAU_MAC_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_mac_ext.1" name="Device Impersonation">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the same MAC address simultaneously.</title>
            <note role="application"> The intent of this SFR is to detect MAC spoofing where an
              attacker is able to cause the whitelisted EUD to disconnect and promptly connects a
              non-whitelisted device using the MAC address of the whitelisted EUD.</note>
          </f-element>
          <f-element>
            <title> The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the MAC addresses of non-whitelisted EUDs within an Authorized
              administrator-configurable timeframe based on distance between sensors.</title>
            <note role="application">The intent of this SFR is to allow the administrator to
              determine the time that should be allowed between a whitelisted EUD connecting in two
              distant locations.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the behavior of the TOE when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                instructions on how to deploy the TOE in a manner that allows the TSF to detect when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously (i.e. information about the range and placement of sensors to ensure
                non-overlapping coverage).<h:br/><h:br/> The evaluator shall verify that the
                operational guidance provides instructions on how to configure the timeframe that
                should be allowed between two subsequent attempts for an EUD to connect from two
                separate locations.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Setup a whitelisted AP (Location 1).</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-verlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the whitelisted AP in location 2. Make sure both EUDs
                        are connected at the same time.</step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Configure the timeframe allowed between connection of two EUDs in two
                        separate locations (Location 1, Location 2).</step>
                      <step>Setup a whitelisted AP (Location 1). </step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-verlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the whitelisted AP in location 2. Make sure that the
                        time between connections is shorter than the time timeframe
                        allowed/configured. </step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <!-- Removed-->
        <!-- <ext-comp-def title="Proprietary Traffic Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component id="fau_wid_ext.8" name="Wireless Intrusion Detection – Proprietary Traffic Monitoring">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the presence of all vendor proprietary network traffic
              matching the 802.11 monitoring SFP for all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:
              <h:ul>
                <h:li>authorized APs and authorized EUDs</h:li>
                <h:li>authorized APs and unauthorized EUDs</h:li>
                <h:li>unauthorized APs and authorized EUDs.</h:li>
              </h:ul></title>
            <note role="Application">
              The "802.11 monitoring SFP" is a security function policy and
              the SFRs that reference this policy describe what the policy does. The "802.11
              monitoring SFP" is established in FDP_IFC.1 and defined through FAU_WID_EXT.1, FAU_WID_EXT.2, in addition to optional SFRs FAU_WID_EXT.3 and FAU_WID_EXT.4. A vendor does not have to formally define
              this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS> 
                There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Set the WIDS sensor for a set channel.</step>
                      <step>Start a traffic capture from the WIDS sensor.</step>
                      <step>Send a set number of frames on the sensor's operating channel for all
                        IEEE 802.11 a, b, g, n, ac vendor propietary frame types and subtypes
                        from/to the following: <h:ol>
                          <h:li><h:i>authorized APs and authorized EUDs.</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs.</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs.</h:i></h:li>
                        </h:ol>
                      </step>
                      <step>Provide a list of the frames types and subtypos that were used for
                        testing and verify that they were all detected.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        -->
        <ext-comp-def title="Wireless Intrusion Prevention" fam-id="FAU_WIP_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component id="fau_wip_ext.1" name="Wireless Intrusion Prevention">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall allow an Authorized Administrator to isolate a wireless AP or EUD
              from the network monitored by the TSF using the following methods: <selectables>
                <selectable>wireless containment</selectable>
                <selectable>wire-side containment of an unauthorized AP connected to the internal
                  corporate wired network.</selectable>
              </selectables>
            </title>
            <note role="application">It is expected that an Authorized Administrator will be
              responsible for confirming the AP or EUD as a rogue AP or EUD to initiate wireless
              containment. <h:br/><h:br/> In this SFR the containment of an an unauthorized AP
              connected to the internal corporate wired network refers to an unauthorized AP that is
              physically connected (via wire) to the protected internal wired infrastructure. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.<h:br/><h:br/>
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> Configure the containment methods available on the TSF and perform the
                following test for each method. <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP and connect to the protected wired
                        infrastructure via wire (make sure it gets classified as rogue, or manually
                        classify as such).</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Verify that TSF generates an alert, breaks the connection of the
                        whitelisted EUD from the rogue AP, and contains the rogue AP.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>

      <subsection title="Protection of the TSF (FPT)" id="fpt">
        <f-component id="fpt_fls.1" name="Basic Internal TSF Data Transfer Protection">
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall preserve a secure state when the following types of failures
              occur: [<h:i>sensor functionality failure, potential compromise of the TSF</h:i>]. </title>
            <note role="application"> At minimum, the preservation of a secure state requires the
              generation of audit records when the defined failure conditions occur. </note>
            <aactivity>
              <TSS> The evaluator shall review the TSS section to determine that the TOE’s
                implementation of the fail secure functionality is documented. The evaluator shall
                examine the TSS section to ensure that all failure modes specified in the ST are
                described.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance to verify that it
                identifies the potential TOE failures, how the TSF preserves a secure state
                following these failures, and any actions that are required to restore the TOE to
                normal operation following the transition to a failure state. <h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each failure mode specified in the ST, the evaluator shall ensure that
                    the TOE attains a secure state after initiating each failure mode type.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </obj-sfrs>
  </chapter>


  <bibliography>
    <cc-entry/>
  </bibliography>
  <acronyms/>
</Module>
<!-- 
 20190930     
  - Split apart any generic reference to WIDS/WIPS. It should be clear if something is for WIDS or WIPS
  - Push #1: Added requirements to FAU_WID_EXT.2 Wireless Intrusion Detection – Passive Information Flow Monitoring (FAU_WID_EXT.2.5 and FAU_WID_EXT.2.6 (Lines 1107 - 1123))
  - Push #2: Added requirements to FAU_IDS_EXT.1 Wireless Intrusion Detection – Intrusion Detection System – Intrusion Detection and Reporting  Methods (FAU_IDS_EXT.1.2 and FAU_IDS_EXT.1.3 (Lines 1107 - 1123))
  - Push #3: Updated Updated FAU_IDS_EXT.1.3
  - Push #4: Updated technical terms  and replaced 46 out of 58 referenced to "WIDS/WIPS" with  "WIDS"
  
  20191002
  - Push #1: Added requirement to Objective SFRs (FAU_INV_EXT.4 Precise Location of Environmental Objects) for the inclusion of a signal library.
  - Push #2: Made some grammar and punctuation changes. 

20191003
  - Push # 1: Added a component requirment under Objective SFRs ("PLACEHOLDER" element name) for TSF Device Configurations - Monitoring Time and Frequency. (Lines: 2332 - 2371)
  - Push # 2: Added a component requirment under Objective SFRs ("PLACEHOLDER" element name) for TSF Device Configurations - Device Configuration - Exporting Configuration and Event Data.
    (Lines: 2375 - 2421)
    Corrected formatting issue.
  - Push # 3: Push to synchronize changes.
     # Need to troubleshoot why I don't see the changes for Push #2, but I see the other ones. Commited and pushed changes twice, but when I refresh the https://commoncriteria.github.io/pp/wids/wids-release.html
         page, the changes aren't there. I see the push in GitHub, and all the other changes pushed today were successfully changed and verified.
20191004
  - Fixed build issue. Removed extra <steplist> tag that had no closing tag. Added </f-component> closing tag that was missing.

  20191009
   - Push # 1: Added WLAN Definition
   - Push # 2: Comments: Lauren - I identified the purpose behind "FAU_GEN.2(WIDS) Alerts Data Generation (WIDS/WIPS)"" table we had questions about yesterday, and I've changed my opinion about it usefullness. 
                      I now support it's inclusion for the following reason (please argue against if you think I'm missing something here):

                      The "FAU_SAA.1 Potential Violation Analysis - Potential Security Violations" table simply labels the types of auditable events the TSF should trigger off of, and whether it's a mandatory,
                       objective, or optional SFR.  Applying a set of rules for monitoring the wireless traffic, and based upon these rules, indicating a potential malicious action is different than actually identifying 
                       what information should be contanied within the triggered alert. If an event is triggerable, the "FAU_GEN.2(WIDS) Alerts Data Generation (WIDS/WIPS)" table specifically identifies what 
                      attributes (i.e. MAC address, SSID, signal strength, BSSID) should be captured and contained within the alert, and then eventually parsed and displayed by a reporting mechanism (e.g. SIEM, 
                      syslog, 3rd party solution). This table sperately provides a space within the mudule to define the specific device and event attributes that should be monitored for and captured 
                      within a triggerable event. Not all of the SFRs trigger an actual alert, hence why some requirements within the table have "None" specified under the "Auditable Events" column.

                      Let me know if you see and holes in my logic and understanding. 
 
 20191011
 - Push # 1: Added Assurance Activity to "fau_wid_ext.2.5" and "fau_wid_ext.2.6" 

 20191018
 - Push #1: Added additional aactivity testing and responded to 4 out 6 of Lauren's comments. 

 DONE:
 - Moved fpt_itt and ftp_itc to modified sfrs
 - Selection-Depends
 - Table ctr
 
 Arnolds Comments
 1. Title: Specify 802.11 WIDS/WIPS
 2. Section 1: Plance 802.11 in front of Wireless Intrusion Detection System
 3. Section 1.1: Added "in addition to the 802.11 WIDS capability" to  statement
 4. Section 1.2.2: Add 802.11 to "AP, "EUD", and "WLAN" definitions
 5. Section 1.3.1: Replace Wireless Intrusion Detection/Prevention System with "WIDS/WIPS"
 6. Section 1.3.1: Change the word "Overlay" to "Standalone"
 7. Section 1.3.1 - 3: Corrected 3 punctuation errors
 8. Section 3: Removed the last sentence reference the to "Wi-Fi" spelling variances/permutations. 
 Change everything instance of "Wi-Fi" (2) to "WLAN"


Lauren's Notes:
Q: does the EUD have to make a connection attempt to any network for the WIDS to see it? Or will the WIDS see it if it is just powered on? 
Response: The WIDS will detect any EUD that's powered on, within geospacial range, and emitting probe requests; regardless of connection status.

Q: Is an unauthorized SSID being broadcasted by an authorized AP different than if it was broadcasted from an unauthorized AP?
Response: Yes, this would imply two different scenarios; one being a threat and the other being a compromise. An unauthorized SSID being broadcast from an unauthorized AP would indicate a possible masquerade or deauth attempt. An unauthorized SSID being broadcast from an authorized AP would indicate either a malfunction in the authorized AP, a compromised AP, or a spoofed or rogue AP present within the WLAN. 

-->



<!-- 
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them. <h:br/><h:br/>
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR. <h:br/><h:br/>
              </Guidance>
              <Tests>
            
              </Tests>
               -->
