<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/pp2html.xsl"?>
<?xml-model href="../transforms/schemas/CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<PP xmlns="http://common-criteria.rhcloud.com/ns/cc" name="WIDS/WIPS EP"
    xmlns:h="http://www.w3.org/1999/xhtml">
  <!-- <inline-comment color='green'> Hello World QQQQ </inline-comment> -->
  <!-- <inline-comment color='blue' linebreak='yes'> Hello World QQQQ </inline-comment> -->
  <PPReference title="PP Reference">
    <ReferenceTable>
      <PPTitle>collaborative Protection Profile for Network Devices Extended Package (EP) for
				Wireless Intrusion Detection/Prevention Systems (WIDS/WIPS)
	  </PPTitle>
      <PPVersion>0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate></PPPubDate>
      <PPCertificationID>unassigned</PPCertificationID>
      <CCVersion>3.1R4</CCVersion>
      <Keywords>WIDS/WIPS, Wireless Intrusion Detection/Prevention System</Keywords>
      <entry>
        <name>Registration</name>
        <description>National Information Assurance Partnership</description>
      </entry>
    </ReferenceTable>
  </PPReference>

<RevisionHistory role="draft">
    <entry>
      <version>Draft 2</version>
      <date>08/21/16</date>
      <subject></subject>
    </entry>
  </RevisionHistory>

  <!-- <RevisionHistory role="final">
    <entry>
      <version>4.0</version>
      <date>2015-08-14</date>
      <subject>Release - significant revision</subject>
    </entry>
  </RevisionHistory>
  -->
 
 <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview">
      This Extended Package (EP) describes security requirements for a Wireless Intrusion/Prevention System (WIDS/WIPS)
      (defined to be a IEEE 802.11 network intrusion prevention product located at the edge of a private network that 
      can collect, inspect, analyze, and react to network traffic in real-time) and is intended to provide a minimal 
      baseline set of requirements that are targeted at mitigating well defined and described threats. This EP is not 
      complete in itself, but rather extends the collaborative Protection Profile for Network Devices (NDcPP). 
      This introduction will describe the features of a compliant Target of Evaluation (TOE), and will also discuss 
      how this EP is to be used in conjunction with the NDcPP. 
    </section>
    <section title="Terms" id="glossary"> The following sections provide both Common Criteria and
      technology terms used in this Protection Profile. <subsection title="Common Criteria Terms"
        id="ccterms">
        <glossary>
          <entry>
            <term><abbr title="Common Criteria">CC</abbr></term>
            <description>Common Criteria for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Common Evaluation Methodology">CEM</abbr></term>
            <description>Common Evaluation Methodology for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Extended Package">EP</abbr></term>
            <description>An implementation-independent set of security requirements for a product category that extend 
              the requirements from a base PP to cover security requirements that are specific to a product type. In this case, 
            the WIDS/WIPS EP extends the NDcPP.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile">PP</abbr></term>
            <description>An implementation-independent set of security requirements for a category
              of products.</description>
          </entry>
          <entry>
            <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
            <description>A requirement to assure the security of the <abbr linkend="TOE"/>.</description>
          </entry>
          <entry>
            <term><abbr title="Security Functional Policy">SFP</abbr></term>
            <description>The security policy enforced by a security function.</description>
          </entry>
          
          <entry>
            <term><abbr title="Security Functional Requirement">SFR</abbr></term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.</description>
          </entry>
          <entry>
            <term><abbr title="Security Target">ST</abbr></term>
            <description>A set of implementation-dependent security requirements for a specific
              product.</description>
          </entry>
          <entry>
            <term><abbr title="Target of Evaluation">TOE</abbr></term>
            <description> The product under evaluation. In this case, the Wireless Intrusion
                Detection/Prevention System in section <xref linkend="TOEboundary"/> and its
              supporting documentation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Security Functionality">TSF</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Summary Specification">TSS</abbr></term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs in a <abbr
                linkend="ST"/>. </description>
          </entry>
         

        </glossary>
      </subsection>
      <subsection title="Technology Terms" id="techterms">
        <glossary>
          <entry>
            <term><abbr title="Wireless Intrustion Detection/Prevention System">WIDS/WIPS</abbr></term>
            <description>A security product that provides network security administrators with the ability to monitor, collect,
              log, and react in real-time to potentially malicious wireless (IEEE 802.11) network traffic.</description>
          </entry> 
        </glossary>
      </subsection>
	  </section>
   
   <section title="Conformance Claims" id="ConformanceClaims">
         The collaborative Protection Profile for Network Devices (NDcPP) defines the baseline Security 
         Functional Requirements (SFRs) and Security Assurance Requirements (SARs) for network infrastructure
         devices in general. This EP serves to extend the requirements and activities defined in the NDcPP, with additional SFRs and associated 
         'Assurance Activities' specific to <abbr linkend="WIDS/WIPS"/> devices. Assurance Activities are 
         the actions that the evaluator performs in order to determine a TOE’s compliance to the SFRs.
         <h:br/><h:br/>
         This EP is conformant to Parts 2 (extended) and 3 of Common Criteria
         Version 3.1, Revision 4 <cite linkend="bibCC"/>.
   </section>
   
   <section title="How to Use This Extended Package" id="Usage">
     As an EP of the NDcPP it is expected that the content of both this EP and the base PP be appropriately 
       combined in the context of each product-specific Security Target. This EP has been specifically defined 
       such that there should be no difficulty or ambiguity in so doing. An ST must identify the applicable 
       version of the NDcPP (see http://www.niap-ccevs.org/pp/ for the current version) and this EP in its 
       conformance claims. 
   </section>


    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      This EP specifically addresses Wireless Intrusion Detection/Prevention Systems (WIDS/WIPS). A conformant 
      <abbr linkend="WIDS/WIPS"/> is a product that provides network security administrators with the ability to monitor, collect,
      log, and react in real-time to potentially malicious network traffic.  A WIDS typically consists of multiple
      sensors that passively scan their surrounding RF environment on the WLAN radio frequency spectrum for 
      IEEE 802.11 traffic and a centralized mechanism such as a Server or Controller that processes the data 
      collected by the sensors. The <abbr linkend="WIDS/WIPS"/> could use an Embedded (be part of the WLAN infrastructure) or 
      Overlay (independent from WLAN) architecture depending on vendor implementation.<h:br/><h:br/>
      
      This EP is focused on inspecting layers 1 and 2 of the OSI network model as the traffic that the WIDS/WIPS 
      monitors is wireless frames in the RF spectrum utilized by IEEE 802.11 a, b, g, n, and ac. Requirements for other 
      technologies (e.g., cellular) and protocols are optional.<h:br/><h:br/>
      
      Conformant TOEs will detect potentially malicious network traffic using various approaches. Broadly speaking,
      the traffic analysis could be based on identification of ‘known’ threats, or ‘unknown’ threats. Identification 
      of ‘known’ threats may be performed through pattern matching, e.g. by matching strings of characters within a frame,
      or by matching traffic patterns common with reconnaissance or denial of service (DoS) attacks. Identification of 
      ‘unknown’ threats may be performed through use of various forms of ‘anomaly’ detection whereby the <abbr linkend="WIDS/WIPS"/> is 
      provided with (or ‘learns’/creates) a definition of ‘expected/typical’ traffic patterns, such that it’s able to 
      detect and react to ’anomalous’ (unexpected/atypical) traffic patterns.<h:br/><h:br/>
      
      The following are to be part of the evaluation:
      <h:ul>
        <h:li>Monitoring, detection and reporting capabilities offered by the WIDS/WIPS.</h:li>
        <h:li>Use of secure communication paths between WIDS/WIPS components</h:li>
        <h:li>Use of secure communication paths for WIDS/WIPS management and event monitoring.</h:li>
        <h:li>Use of secure communication paths with external components (e.g., database and log server)</h:li>
      </h:ul> <h:br/>
      
      <figure entity="images/TOE.jpg" title="Figure 1: General TOE " id="toe"/>
    </section>
  
  </chapter>  
  
  <chapter title="Security Problem Definition" id="spd">
    <abbr linkend="WIDS/WIPS"/> address a range of security threats related to detection of and reaction to potentially malicious WLAN 
    traffic. The malicious traffic may pose a threat to one or more endpoints on the monitored networks, or to the 
    network infrastructure, or to the TOE itself. Attacks against a WLAN could compromise the confidentiality and 
    integrity of WLAN user and system data as well as the availability of the WLAN to legitimate users. <h:br/><h:br/> 
    
    The term “monitored network” is used here to represent any WLAN and/or wired network that the TOE is configured to monitor and detect 
    intrusions on. This extends to the wired networks as intrusions on the wireless network can also be damaging to the wired infrastructure. 
    The WIDS/WIPS also protects the wired infrastructure by detecting rogue devices that are directly connected to the wired infrastructure,
    which may expose the wired network, or unauthorized WLAN devices deployed in a no-wireless zone. The terms "Wi-Fi", “Wi-Fi Network” and 
    “WLAN” will be used interchangeably to represent an IEEE 802.11 network.<h:br/> <h:br/> 
    
    The proper installation, configuration, and administration of the <abbr linkend="WIDS/WIPS"/> are critical to its correct operation. 
    A site is responsible for developing its security policy and configuring a rule set that the <abbr linkend="WIDS/WIPS"/> will enforce 
    and provide an appropriate response to meet their needs, relative to their own risk analysis and their perceived threats.<h:br/><h:br/> 
    
    Note that this EP does not repeat the threats identified in the NDcPP, though they all apply given the conformance 
    and hence dependence of this EP on the NDcPP. Note also that while the NDcPP contains only threats to the ability of
    the TOE to provide its security functions, this EP addresses only threats to resources in the operational environment. 
    Together the threats of the NDcPP and those defined in this EP define the comprehensive set of security threats 
    addressed by a <abbr linkend="WIDS/WIPS"/> TOE.
    
    
    <section title="Threats" id="threats">
      <threats>
        <threat id="T.UNAUTHORIZED_DISCLOSURE_OF_INFORMATION">
          <description> Sensitive information on a protected WLAN might be disclosed resulting from disclosure/transmitted 
            information in violation of policy, such as sending unencrypted sensitive data. The <abbr linkend="WIDS/WIPS"/> will be capable 
            of collecting and analyzing WLAN data to detect unauthorized disclosure of information.
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of network violations.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.WIDS_ANALYZE as this
              provides for detection potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.WIPS_REACT as this
              provides containment of unauthorized devices.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.UNAUTHORIZED_ACCESS">
          <description> An attacker may attempt to gain inappropriate access to one or more networks, endpoints, or services, 
            such as by getting an end user device to connect to an unauthorized AP by impersonating an authorized AP. If 
            malicious external devices are able to communicate with devices on the protected WLAN, then those devices may be
            susceptible to the unauthorized disclosure of information.
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of unauthorized network devices.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIDS_ANALYZE as this
              provides for detection potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIPS_REACT as this
              provides containment of unauthorized devices.</rationale>
          </objective-refer>
          <objective-refer ref="O.TOE_ADMINISTRATION">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.TOE_ADMINISTRATION.</rationale>
          </objective-refer>
          
        </threat>
        <threat id="T.DISRUPTION">
          <description> Attacks against the WLAN infrastructure might lead to denial of services (DoS) within a protected WLAN. A 
            wireless DoS may occur in two ways: at the physical layer through RF Jamming, or at the data link layer through 
            packet injection. 
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.DISRUPTION is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of DoS attacks.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.DISRUPTION is countered by O.WIDS_ANALYZE as this
              provides for detection potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.DISRUPTION  is countered by O.WIPS_REACT as this
              provides containment of unauthorized devices.</rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    
    <section title="Assumptions" id="assumptions">
      <assumptions>
        <assumption id="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner that ensures that the TOE 
            security policies will be enforced on all applicable network traffic flowing among the attached networks. </description>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The operational environment objective OE.CONNECTIONS is realized through A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_ADMIN">
          <description> The administrator of the WIDS/WIPS is not careless, willfully negligent or hostile, and administers 
            the WIDS/WIPS within compliance of the applied enterprise security policy. </description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale> The operational environment objective OE.PROPER_ADMIN is realized through A.PROPER_ADMIN.</rationale>
        </objective-refer>
        </assumption>
      </assumptions>
    </section>
  </chapter>
  
  <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.SYSTEM_MONITORING">
          <description> 
            To be able to analyze and react to potential network policy violations, the WIDS/WIPS must be able to 
            collect and store essential data elements of network traffic on monitored networks. <h:br/>
            </description>
          <!--<component-refer ref="fau_gen.1.1/WIDS"/>-->
        </SO>
        <SO id="O.WIDS_ANALYZE">
          <description> 
            The WIDS/WIPS must be able to analyze collected or observed WLAN activity on monitored networld to identify potential
            violations of approved WLAN policies, unauthorized connections involving internal WLAN devices, and non-secure communications. <h:br/><h:br/>
            </description>
          <!--<component-refer ref=""/>-->
        </SO>
        <SO id="O.WIPS_REACT">
          <description> The TOE must be able to react as configured by the administrators to isolate/contain 
            WLAN devices that have been determined to violate administrator-defined WIPS policies.  <h:br/>
           </description>
          <!--<component-refer ref=""/>-->
        </SO>
        <SO id="O.TOE_ADMINISTRATION">
          <description> To address the threat of unauthorized administrator access that is defined in the base PP, 
            Conformant TOEs will provide the functions necessary for an administrator to configure the WIDS/WIPS 
            Capabilities of the TOE.
            <h:br/>
          </description>
          <!--<component-refer ref=""/>-->
        </SO>
        <SO id="O.INSECURE_OPERATIONS">
          <description> There may be instances where the TOE’s hardware malfunctions or the integrity of the TOE’s software is compromised, 
            the latter being due to malicious or non-malicious intent. To address the concern of the TOE operating outside of its hardware 
            or software specification, the TOE will shut down upon discovery of a problem reported via the self-test mechanism.
            <h:br/>
          </description>
          <!--<component-refer ref=""/>-->
        </SO>
        <SO id="O.TRUSTED_COMMUNICATIONS">
          <description> To further address the threat of untrusted communications channels that is defined in the base PP, conformant TOEs 
            will provide trusted communications between distributed components if any exist. <h:br/>
          </description>
          <!--<component-refer ref=""/>-->
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment">The following security objectives for the operational
      environment assist the TOE in correctly providing its security functionality.
      These track with the assumptions about the environment. 
      <SOEs>
        <SOE id="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that will allow the TOE to effectively 
            enforce its policies on network traffic of monitored networks. </description>
        </SOE>
        <SOE id="OE.PROPER_ADMIN">
          <description> The administrator of the is not careless, willfully
            negligent or hostile, and administers the WIDS/WIPS within compliance of the applied enterprise
            security policy. </description>
        </SOE>
      </SOEs></section>
    <section title="Security Objectives Rationale" id="SOR">This section describes how the
      assumptions, threats, and organizational security policies map to the security objectives.
      <InsertSPDCorrespondence/></section>
  </chapter>
  
  <chapter title="Security Requirements" id="req">This chapter describes the security requirements
    which have to be fulfilled by the <abbr linkend="WIDS/WIPS"/>. Those requirements comprise functional
    components from Part 2 and assurance components from Part 3 of <cite linkend="bibCC"/>. The
    following notations are used: <h:ul>
      <h:li>
        <h:b>Refinement</h:b> operation (denoted by <h:b>bold text</h:b>): is used to add details to a
        requirement, and thus further restricts a requirement.</h:li>
      <h:li>
        <h:b>Selection</h:b> (denoted by <h:i>italicized text</h:i>): is used to select one or more options
        provided by the [CC] in stating a requirement.</h:li>
      <h:li>
        <h:b>Assignment</h:b> operation (denoted by <h:span class="assignable-content">italicized text</h:span>): is used to assign a
        specific value to an unspecified parameter, such as the length of a password. Showing the
        value in square brackets indicates assignment.</h:li>
      <h:li>
        <h:b>Iteration</h:b> operation: are identified with a number inside parentheses (e.g.
        "(1)")</h:li>
    </h:ul>
    <section title="Security Functional Requirements" id="SFRs">The Security Functional Requirements
      included in this section are derived from Part 2 of the Common Criteria for Information
      Technology Security Evaluation, Version 3.1, Revision 4, with additional extended functional
      components. 
      <subsection title="Security Audit" id="FAU">
        <f-component id="fau_arp.1" name="Security Alarms" status="threshold">
          <f-element id="fau_arp.1.1">
            <title> The TSF shall take <h:i>[the following actions: display alert to Authorized Administrator in 
              sufficient detail to show identity of devices involved, description of alert and severity level, </h:i><selectables>
                <selectable>capture raw frame traffic that triggers the violation</selectable>
                <selectable>no other actions</selectable>
              </selectables>] upon detection of a potential security violation.
              
            </title>
            <note role="application">The capturing of raw frames that triggers the violation is an objective
              requirement. If the ST author selects capturing of raw frames that triggers the violation, 
              the ST author must include the following SFRs: <linkref linkend="FAU_STG_EXT.1.1/pcap"/>, <linkref linkend="FAU_STG_EXT.1.2/pcap"/>, 
              <linkref linkend="FAU_STG_EXT.1.3/pcap"/>.</note>
            <aactivity>	
              <tss>The evaluator shall verify that the TSS describes where to find the WIDS/WIPS alerts on the Administrator console/interface.</tss>
              <guidance>The evaluator shall use the operational guidance for instructions on where the alerts generated are displayed within the 
                WIDS/WIPS interface. If the objective requirement to capture the raw frame that triggered an alert is selected, the evaluator must 
                also test for corresponding selection-based requirements. The evaluator shall use the operational guidance to configure the traffic
                capture capabilities. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>The evaluator shall perform a series of events or generate traffic that would successfully trigger an alert. 
                    The evaluator should verify and record whether the TOE generated the alert. The evaluator should also record the events or traffic 
                    that was generated and what alert was attempted to be triggered and record the details provided by the TOE in the alert.<h:br/>
                  </test>
                  <test>
                    If capturing of raw frames was selected, verify that the packet capture was triggered and stored as appropriate. 
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_arp_ext.2" name="Security Alarm Filtering" status="threshold">
          <f-element id="fau_arp_ext.2.1">
            <title> The TSF shall provide the ability to apply <assignable>methods of selection</assignable> 
              to selectively exclude alerts from being generated.  
            </title>
      
            <aactivity>	
              <tss>The evaluator shall verify that the TSS describes how the WIDS/WIPS detection features and alerts can be configured.</tss>
              <guidance>The evaluator shall verify that the Operational Guidance includes instructions on enabling and disabling alerts. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>
                    The evaluator shall use the operational guidance to enable/disable detection of available detection capabilities through the WIDS/WIPS 
                    administrator interface. The evaluator shall then generate traffic that would successfully trigger the alert. The evaluator should verify 
                    that the TOE generated the alert. The evaluator shall record the attack/intrusion that was generated and indicate which alert was triggered
                    as well as the details that were provided by the WIDS about the alert.
                   </test>
                  <test>
                    The evaluator shall disable the alert. The evaluator shall then generate events as in previous test that should successfully 
                    trigger the alert. The evaluator should check if the the TOE generated an alert for the attack and record the findings. 
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component id="fau_ids_ext.1" name="Intrusion Detection System – Intrusion Detection Methods" status="threshold">
          <f-element id="fau_ids_ext.1.1">
            <title> The TSF shall provide the following methods of intrusion detection: 
              <selectables>
                <selectable>anomaly-based</selectable>
                <selectable>signature-based</selectable>
                <selectable>behavior-based</selectable>
                <selectable>hybrid</selectable>
                <selectable><assignable>proprietary vendor detection method</assignable></selectable>
              </selectables>
            </title>
            <note role="application">At least one detection method must be selected based on the selection made in 
              this SFR, the following SFRs must also be included: <h:br/>
              If anomaly-based detection is selected:   <linkref linkend="FAU_ANO_EXT.1.1"/> and <linkref linkend="FAU_ANO_EXT.1.2"/><h:br/>
              If signature-based detection is selected:   <linkref linkend="FAU_SIG_EXT.1.1"/><h:br/><h:br/>
              A hybrid detection method is one that incorporates two or more detection methods (e.g., both anomaly and signature based or signature and 
              another method). If one of the detection methods in a hybrid solution includes either anomaly-based or signature-based detection methods, the
              corresponding selection based requirements must also be met.        
              
             </note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on which intrusion detection technique(s) the TOE utilizes. 
                If a hybrid intrusion detection is selected as the intrusion detection method, the TSS should provide details on the detection techniques utilized.
                Furthermore, when using a hybrid detection method that includes detection methods other than anomaly or signature based, the TSS shall include more 
                details about such detection methods. If vendor proprietary vendor detection method is selected, technical details on the method must be provided. 
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests> Depending on the detection technique used by the TOE the evaluator shall note detection technique used and test 
                for the appropriate selection-based requirements.
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_inv_ext.1" name="Environmental Inventory" status="threshold">
          <f-element id="fau_inv_ext.1.1">
            <title> The TSF shall provide Authorized Administrators with the ability to define an inventory 
              of <h:i>[authorized WLAN network devices]</h:i> based on <h:i>[EUD MAC addresses, AP MAC addresses]</h:i>.
            </title>
            <note role="application">This inventory is used as a whitelist to indicate to the WIDS/WIPS which 
              devices are legitimate members of the wireless network.</note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to configure a whitelist of devices. 
                If the list is configured automatically the operational guidance should include how this must be configured and how to modify the whitelist.
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to configure and change clasification 
                of devices to indicate that they are part of the whitelist. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  Deploy devices that should be classified as authorized devices. <h:br/>
                  <test>
                    If the whitelist is configured automatically:
                    <ul>
                      <li>Check the list of inventoried devices and verify that the list is correct. Record the classification of the devices. </li>
                      <li>Remove or reclassify a device from the inventory. Record the classification of the device as displayed on inventory after change.</li>
                    </ul>
                    
                  </test>
                  <test>
                    If the list is configured manually:
                    <ul>
                      <li>Add a device to the list. Record whether device is displayed on inventory. </li>
                      <li>Remove a device from the inventory. Record whether the device is displayed on inventory after removal.</li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_inv_ext.1.2">
            <title> The TSF shall detect the presence and current information of<h:i>[EUDs, APs]</h:i> in the Operational Environment that are 
              part of the defined inventory.
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on where in the WIDS/WIPS interface the list of detected devices is displayed</tss>
              <guidance>There are no guidance activities for this SFR.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy a whitelisted AP and client, and connect the client to the AP.</test>
                  <test>Check the list of detected devices to comfirm that the whitelisted devices appear on the list of detected devices. Record result.</test>
                  <test>If the devices are detected verify that they are classified as whitelisted devices. Record classification.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          
          <f-element id="fau_inv_ext.1.3">
            <title> The TSF shall detect the presence and current information of <h:i>[EUDs, APs]</h:i> in the Operational Environment that are 
              not part of the defined inventory.
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on where in the WIDS/WIPS interface the list of detected devices is displayed</tss>
              <guidance>There are no guidance activities for this SFR.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an AP and client not connected to the WLAN infrastructure and not marked as whitelisted, and connect the client to the AP.</test>
                  <test>Check the list of detected devices to comfirm that the deployed devices appear on the list of detected devices. 
                    Record whether the devices appear on the list of detected devices.</test>
                  <test>If the devices are detected verify that they are not classified as whitelisted devices. Record classification.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_inv_ext.2" name="Characteristics of Environmental Objects" status="threshold">
          <f-element id="fau_inv_ext.2.1">
            <title> The TSF shall detect information on the current physical location of <h:i>[inventoried and malicious EUDs, APs]</h:i> within 
              <h:i>[range of the TOE’s wireless sensors]</h:i>.
            </title>
            <note role="application">This SFR only checks for the ability to place the location of wireless devices on the map but does not mandate the accuracy 
              of the location. Objective requirement <linkref linkend="FAU_INV_EXT.4"/> is more stringent on the accuracy of the location tracking capabilities.</note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on how to configure location tracking and optimal
                sensor placement. 
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to load a location map and where in the TSF administrator interface 
                the location of devices can be viewed.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an AP within range of the sensors</test>
                  <test>Check that the device appears on the location map. Record whether the device appears on the map.</test>
                  <test>Record the accuracy of the location as it appears on the map.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_inv_ext.2.2">
            <title> The TSF shall detect <h:i>[received signal strength,</h:i> <selectables>
              <selectable>RF power levels above a predetermined threshold</selectable>
              <selectable>no other characteristics</selectable>
            </selectables>] of hardware operating within <h:i>[range of the TOE’s wireless sensors]</h:i>.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.
              </tss>
              <guidance>If the option for detection of RF power levels above a predetermined threshold is selected the evaluator should use the operational
                guidance to set or check what the threshold is. The evaluator should also perform the tests to verify that an alert is generated when the threshold
                is exceeded.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an AP within range of the sensors</test>
                  <test>Check the WIDS/WIPS user interface for a list of detected devices</test>
                  <test>Verify and record whether the current received signal strength is part of the information presented on the 
                    WIDS/WIPS user interface about the devices.</test>
                </testlist>
              </tests>
    <!--          
              <tests> Tests to be performed by the evaluator if detection of RF power levels above a predetermined threshold is selected:<h:br/>
                <testlist>
                  <test>Deploy an AP within range of the sensors</test>
                  <test>Check the WIDS/WIPS user interface for a list of detected devices</test>
                  <test>Verify and record whether the current received signal strength is part of the information presented on the 
                    WIDS/WIPS user interface about the devices.</test>
                </testlist>
              </tests>
    -->          
            </aactivity>
          </f-element>
          <f-element id="fau_inv_ext.2.3">
            <title> The TSF shall detect the <h:i>current RF band, current channel, MAC Address, classification of device, </h:i> <assignable>other details</assignable> of 
              <h:i>[all devices]</h:i> within <h:i>range of the TOE’s wireless sensors</h:i>. For <h:i>[APs]</h:i> the TOE shall detect the following additional details:
              <h:i>encryption, number of connected clients</h:i>. For <h:i>[EUDs]</h:i> the TOE shall detect the following additional details:
              <h:i>SSID and BSSID of AP it is connected to.</h:i>. 
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.
              </tss>
              <guidance>There are no guidance activities for this SFR.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy a whitelisted AP, non-whitelisted AP and two whitelisted clients.</test>
                  <test>Connect one whitelisted client to the whitelisted AP and one to the non-whitelisted AP.</test>
                  <test>Check the WIDS/WIPS user interface for a list of detected devices.</test>
                  <test>Verify that current RF band, current channel, MAC Address, classification of device, are part of the information presented on the 
                    WIDS/WIPS user interface for all the devices detected. For APs encryption, number of connected clients should also be presented.
                    For EUDs SSID and BSSID of AP it is connected to should also be presented. Record the details that are presented about the devices.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component  id="fau_inv_ext.3" name="Behavior of Environmental Objects" status="threshold">
          <f-element id="fau_inv_ext.3.1">
            <title>
              The TSF shall detect when <h:i>[inventoried devices]</h:i> exhibit the following behavior: [ 
              <ul>
                <li><h:i>A client establishes a peer-to-peer connection with any other device.</h:i></li>
                <li><h:i>A device bridges two network interfaces</h:i></li>
                <li><h:i> 
                  <selectables>
                    <selectable>A device uses internet connection sharing.</selectable>
                  </selectables>
                </h:i></li>
                <li><h:i>
                  <selectables>
                    <selectable>other connection types.</selectable>
                    <selectable>no other connections</selectable>
                  </selectables>               
                </h:i></li>
              </ul>   
            </title>       
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> contains information about the 
                capabilities of the TSF to detect the type of connections listed in the SFR. 
              </tss>
              <guidance>The evaluator shall also review the Operational Guidance on what the alerts for each of the connections
                presented in the SFR will look like. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <h:br/>
                    Create the following connections between two whitelisted clients. 
                        <ul>
                          <li>Windows Ad Hoc Connection</li>
                          <li>Mac OS Ad Hoc</li>
                          <li>Linux Ad Hoc</li>
                          <li>Wi-Fi Direct</li>
                        </ul>
                    <h:br/>
                    Create the following connections between one whitelisted client and a non-whitelisted client 
                    <ul>
                      <li>Windows Ad Hoc Connection</li>
                      <li>Mac OS Ad Hoc</li>
                      <li>Linux Ad Hoc</li>
                      <li>Wi-Fi Direct</li>
                    </ul>
                  </test>
                  <test>
                    Bridge two network interfaces on a whitelisted device (one must be the wireless card listed as whitelisted).                    
                  </test>
                  <test>
                    <ul>
                      <li>Create a Windows Hosted Network with a whitelisted client. </li>
                      <li>Connect a different whitelisted client to the network.</li>
                    </ul>
                  </test>
                </testlist>
                  Record if alerts were generated by each of the connections. Provide a description of the alert. 
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_inv_ext.4/Cell" name="Location of Environmental Objects (Cellular Devices)" status="sel-based">
          <selection-depends req="fau_wid_ext.6.1"/>
          <f-element id="fau_inv_ext.4.1/Cell">
            <title> The TSF shall detect the physical location of [<h:i>detected cellular devices</h:i>] to within 
              <assignable>distance degree of accuracy</assignable> of their actual location.
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on how to configure location tracking and optimal
                sensor placement. 
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to load a location map (if applicable and where in the TSF administrator interface 
                the location of devices can be viewed.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an cellular device within range of the sensors.</test>
                  <test>Check location map for the location device.</test>
                  <test>Record level of accuracy in feet.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_inv_ext.4" name="Precise Location of Environmental Objects" status="objective">
          <f-element id="fau_inv_ext.4.1">
            <title> The TSF shall detect the physical location of [<h:i>EUDs, APs</h:i>] to within [<h:i>15 feet</h:i>] of their actual location.
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on how to configure location tracking and optimal
                sensor placement. 
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to load a location map (if applicable and where in the TSF administrator interface 
                the location of devices can be viewed.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an cellular device within range of the sensors.</test>
                  <test>Check location map for the location device.</test>
                  <test>Record actual level of accuracy in feet.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_inv_ext.5" name="Detection of Unauthorized Connections" status="objective">
          <f-element id="fau_inv_ext.5.1">
            <title> The TSF shall detect when [<h:i>non-whitelisted APs as defined in <linkref linkend="FAU_INV_EXT.1"/></h:i>] have the following connections: 
              [<h:i>wired connection to the internal corporate network</h:i>].</title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on whether the TSF has the capability of 
                detecting devices connecting to the protected wired network infrastructure. If the capability is present the TSS shall include
                configuration guidance for this feature. 
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to configure the WIDS/WIPS to detect
                unauthorized devices connected to the protected wired infrastructure.
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy a non-whitelisted AP. </test>
                  <test>Connect the AP via wire to the protected network infrastructure.</test>
                  <test>Check the WIDS/WIPS user interface for a list of detected devices.</test>
                  <test>Verify that the rogue AP is detected and an alert generated on the detection of an AP connected to the wire.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_mac_ext.1" name="Device Impersonation" status="objective">
          <f-element id="fau_mac_ext.1.1">
            <title> The TSF shall detect when two sensors in non-overlapping locations receive traffic from the same MAC address simultaneously.
            </title>
            <note role="application">The intent of this SFR is to detect MAC spoofing where an attacker is able to cause the whitelisted device 
              to disconnect and promptly connects a non-whitelisted device using the MAC address of the whitelisted device.</note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> contains guidance on how to configure this detection (ie. how to
                label locations of sensors). 
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall perform the following tests:<h:br/>
                <ul>
                  <li>Setup a whitelisted AP (Location 1). </li>
                  <li>Connect a whitelisted client to AP.</li>
                  <li>Setup a second whitelisted AP and a non-whitelisted client in a separate non-overlapping location where the WIDS 
                    also has sensors. Or simulate the distant non-verlapping locations by deploying the second AP in a shielded environment 
                    connected to the valid network (Location 2).
                  </li>
                  <li>Spoof the MAC address of the client in location 1 with the client device in location 2 and connect it to the 
                    whitelisted AP in location 2. Make sure both EUDs are connected at the same time. </li>
                  <li>Record whether the TSF detected and generated an alert. </li>             
                </ul>
               
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_mac_ext.1.2">
            <title> The TSF shall detect when two sensors in non-overlapping locations receive traffic from the MAC addresses of 
              [<h:i>non-whitelisted devices as defined in <linkref linkend="FAU_INV_EXT.1"/></h:i>] within 
              [<h:i>an Authorized administrator-configurable timeframe based on distance between sensors</h:i>].      
            </title>
            <note role="application">The intent of this SFR is to allow the administrator to determine the time that should be 
              allowed between a whitelisted device connecting in two distant locations.</note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> contains guidance on how to configure the timeframe that should 
                be allowed between a device connecting in two separate locations. 
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall perform the following tests:<h:br/>
                <ul>
                  <li>Configure the timeframe allowed between connection of two devices in two separate locations (Location 1, Location 2).</li>
                  <li>Setup a whitelisted AP (Location 1). </li>
                  <li>Connect a whitelisted client to AP.</li>
                  <li>Setup a second whitelisted AP and a non-whitelisted client in a separate non-overlapping location where the WIDS 
                    also has sensors. Or simulate the distant non-verlapping locations by deploying the second AP in a shielded environment 
                    connected to the valid network (Location 2).
                  </li>
                  <li>Spoof the MAC address of the client in location 1 with the client device in location 2 and connect it to the 
                    whitelisted AP in location 2. Make sure that the time between connections is shorter than the time timeframe 
                    allowed/configured. </li>
                  <li>Record whether the TSF detected and generated an alert. </li>             
                </ul>
                
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component  id="fau_saa.1" name="Potential Violation Analysis" status="threshold">
          <f-element id="fau_saa.1.1">
            <title>The TSF shall be able to apply a set of rules in monitoring the <h:b>wireless traffic</h:b> and based 
              upon these rules indicate a potential <h:b>malicious action</h:b>.</title>
          </f-element>
          <f-element id="fau_saa.1.2">
            <title>The TSF shall enforce the following rules for monitoring wireless traffic:
              <ol type="a">
                <li>Accumulation or combination of [assignment: subset of defined auditable events] known to indicate a 
                potential security violation;
                </li>
                <li><h:i>[other potential security violations as defined by Table 1 below]</h:i>.</li>
              </ol>
              <table>
                <tr class="header">
                  <td>SFR</td>
                  <td>Potential Security Violation.</td>
                </tr>
                <tr>
                  <td>FAU_INV_EXT.3</td>
                  <td>Detection of authorized EUD establishing peer-to-peer connection with any other device.</td>
                </tr>
                <tr>
                  <td>FAU_INV_EXT.3</td>
                  <td>Detection of device bridging two network interfaces.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.1</td>
                  <td>Detection of rogue AP.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.1</td>
                  <td>Detection of malicious EUD.</td>
                </tr>                
                 <tr>
                  <td>FAU_WID_EXT.2</td>
                  <td>Detection of traffic with excessive transmit power level.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.2</td>
                  <td>Detection of active probing.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.2</td>
                  <td>Detection of MAC spoofing.</td>
                </tr>   
    	
                <tr>
                  <td>FAU_WID_EXT.3</td>
                  <td>Detection of RF-based denial of service.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.3</td>
                  <td>Detection of deauthentication flooding.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.3</td>
                  <td>Detection of disassociation flooding.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.3</td>
                  <td>Detection of request-to-send/clear-to-send abuse.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.4</td>
                  <td>Detection of unauthorized authentication scheme use.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.5</td>
                  <td>Detection of unauthorized encryption scheme use.</td>
                </tr>                
                <tr>
                  <td>FAU_WID_EXT.5</td>
                  <td>Detection of unencrypted traffic.</td>
                </tr>
              </table>
              <table>
                <tr>
                  <td><h:b>Table 1: Potential Security Violations.</h:b></td>
                </tr>
              </table> 
            </title>
          </f-element>
        </f-component>
        
        <f-component id="fau_wid_ext.1" name="Wireless Intrusion Detection – Malicious Environmental Objects" status="threshold">
          <f-element id="fau_wid_ext.1.1">
            <title> The TSF shall apply <assignable>user-defined, automatic</assignable> classification rules to detect the following 
              types of malicious environmental objects: <h:i>[rogue APs]</h:i>.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>The evaluator shall review the Operational Guidance for instructions on how to configure user-defined classification rules.
              </guidance>
              <tests> The evaluator shall perform configure an AP classifcation rule, then perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy an AP following the user-defined classification rule.</test>
                  <test>Check that the AP gets correctly classified.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.1.2">
            <title> The TSF shall distinguish between benign and malicious <h:i>[APs, EUDs]</h:i> based on 
              <h:i>[automatic detection metrics]</h:i>.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.</tss>
              
              
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                <test>Deploy a non-whitelisted AP in the area of the WIDS sensor but take no action against the network. </test>
                <test>Deploy a non-whitelisted AP in the area of the WIDS sensor and connect it to the wire if available. </test>
                <test>Connect a whitelisted client to an unauthorized AP. </test>
                <test>Connect a non-whitelisted client to a whitelisted AP.</test>
                <test>Launch an attack against authorized AP with an unauthorized client.</test>

                  For each test above verify that the TSF detects devices and how they are classified.
               </testlist> 
              </tests>
            </aactivity>
          </f-element>
        </f-component>
  
        <f-component id="fau_wid_ext.2" name="Wireless Intrusion Detection – Passive Information Flow Monitoring" status="threshold">
          <f-element id="fau_wid_ext.2.1">
            <title>
              The TSF shall monitor and analyze 
              <selectables>
                <selectable>simultaneously monitor and analyze</selectable>
                <selectable>no other behavior</selectable>
              </selectables> network traffic matching the <h:i>[802.11 monitoring <abbr linkend="SFP"/>]</h:i> for all channels in the following RF Frequencies:
               2.4 GHz and 4.9/5.0 GHz 
              <selectables>
                 <selectable>channels outside regulatory domain</selectable>
                 <selectable>non-standard channel frequencies</selectable>
                 <selectable>no other domains</selectable>
               </selectables>
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on the channels the TSF can detect. 
              </tss>
              <guidance>The evaluator shall review the Operational Guidance for the channels that the TSF is able to monitor and how to configure 
              the TSF to monitor the channels as selected in the SFR.  Depending on the channel dwelling times implemented by the vendor it might 
              take a while for the detection of devices. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Configure the TSF to monitor the channels as selected in the SFR.</test>
                  <test>Deploy AP on at least 2 different channels within the regulatory domain, on both 2.4GHz and 4.9/5.0GHz bands.</test>
                  <test>Deploy AP on at least 2 different channels outside the regulatory domain, on both 2.4GHz and 4.9/5.0GHz bands.</test>
                  <test>Deploy AP on at least 2 different channels on non-standard channel frequencies.</test>
                  Record the channels used for testing for each test and whether the AP gets detected on each channel tested.
                </testlist>
              </tests>
                        
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.2.2">
            <title> 
              The TSF shall provide wireless sensors to detect network traffic matching the <h:i>[802.11 monitoring <abbr linkend="SFP"/>]</h:i> that 
              <selectables>
                <selectable>can be configured to prevent transmission of data</selectable>
                <selectable>does not transmit data</selectable>
              </selectables>.
            </title>
            <note role="application">The intent of this SFR is to employ WIDS/WIPS sensors that can have all wireless transmission 
              capabilities disabled for instances where a no wireless policy is in place. 
            </note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on how to configure the sensors
                as completely passive. This can either be how to configure as dedicated sensor with prevention disabled
                or if the sensor transmits even when no prevention capabilities are turned off, how to turn off wireless transmissions.
              </tss>
              <guidance>There are no guidance activities for this SFR. 
              </guidance>
              <tests> The evaluator shall perform the following tests:<h:br/>
                Configure the sensor to not transmit wirelessly. <h:br/> 
                  
                With a signal analyzer check for RF energy in the following scenarios. <h:br/>
                <h:b>On 2.4 GHz band</h:b> 
                <testlist>
                  <test>at sensors boot up</test>
                  <test>during normal "operations, watch for about 10 minutes on this band.</test>
                </testlist>
                 <h:b>On 5GHz band</h:b> 
                <testlist>
                  <test>at sensors boot up</test>
                  <test>during normal operations, watch for about 10 minutes on this band.</test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.2.3">
            <title> 
              The TSF shall provide the ability to define a subset of <h:i>[SSID(s)]</h:i> as authorized.
            </title>
            <note role="application">The administrator should have the ability to configure which SSIDs are permitted
            on the network. </note>
            <aactivity>	
              <guidance>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to set the allowed SSIDs.</guidance>
              <tests>The evaluator shall configure the TSF with a set of authorized channels and SSIDs. The ability to detect violation
                of this policy will be tested in <linkref linkend="FAU_WID_EXT.2.4"/>.</tests>
              
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.2.4">
            <title> 
              The TSF shall detect the presence of unauthorized traffic on the network through the following methods: [
              <ul>
                <li>detection of unauthorized APs broadcasting authorized SSIDs,</li>
                <li>detection of unauthorized devices spoofing the MAC address of whitelisted devices,</li>
                <li>detection of authorized clients associating to unauthorized SSIDs,</li>
                <li>detection of unauthorized clients associating to authorized APs,</li>
                <li>detection of unauthorized point to point wireless bridges by whitelisted APs,</li>
                <li>detection of active probing,</li>
                <li>
                  <selectables>
                    <selectable>illegal state transitions</selectable>
                    <selectable>protocol violations 
                      <selectables>
                        <selectable>802.11</selectable>
                        <selectable>802.1X</selectable>
                        <selectable><assignable>proprietary vendor protocol(s)</assignable></selectable>
                      </selectables>
                    </selectable>
                    <selectable>no other methods.</selectable>
                  </selectables>
                  ]
                </li>
              </ul>
            </title>
            <note role="application">“Authorized” clients/APs are those that are assigned to the whitelist as 
              defined by FAU_INV_EXT.1.1. Detection of illegal state transitions and protocol violations are 
              objective requirements and will be mandatory in future PP versions.
            </note>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to set the allowed SSIDs.
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall configure the TSF with a set of authorized SSIDs and perform the following tests:<h:br/>
                <testlist>
                  <h:b>Unauthorized SSID, Unauthorized Connections - 2.4 GHz band</h:b>
                  <test>
                    <ul>
                      <li>Configure a whitelisted AP to operate on a set channel on the 2.4 GHz band. </li>
                      <li>Connect a non-whitelisted client to AP.</li>
                      <li>Change SSID to one not on the authorized list.</li>    
                      <li>Connect a whitelisted client to AP.</li>
                      <li>Verify that the TSF detects the whitelisted AP using unauthorized SSID
                        and client associating to a unauthorized SSID.</li>
                    </ul>
                  </test>              
                  <test>
                    <ul>
                      <li>Place an non-whitelisted AP on unauthorized channel on the 2.4 GHz band.</li>
                      <li>Connect whitelisted client to the non-whitelisted AP.</li>
                      <li>Verify that the TSF detects whitelisted client connecting to AP on unauthorized channel.</li>
                    </ul>
                  </test>
                </testlist>
                
                <testlist>
                  <h:b>Unauthorized SSID, Unauthorized Connections - 5 GHz band</h:b>
                  <test>
                    <ul>
                      <li>Configure a whitelisted AP to operate on a set channel on the 5 GHz band. </li>
                      <li>Connect a non-whitelisted client to AP.</li>
                      <li>Change SSID to one not on the authorized list.</li>    
                      <li>Connect a whitelisted client to AP.</li>
                      <li>Record the authorized SSID, SSID used for testing and results of each test (Whether the TSF detects the whitelisted AP using unauthorized SSID
                        and client associating to a unauthorized SSID).</li>
                    </ul>
                  </test>           
                </testlist>
                
                <testlist>
                  <h:b>MAC Spoofing</h:b>
                  <test>
                    <ul>
                      <li>Spoof mac address of valid client device connected to a whitelisted AP on a non-whitelisted client device. </li>
                      <li>Connect client with spoofed MAC address to a whitelisted AP. </li>
                      <li>Record procure used and whether the TSF detected the MAC spoofing.</li>
                    </ul>          
                  </test>                 
                </testlist>
                
                <testlist>
                  <h:b>Active Probing</h:b>
                  <test>
                    <ul>
                      <li>Perform an active scan on the subnet of the WLAN.</li>
                      <li>Record tools used and type of scan performed. Record whether the TSF detects the active probing.</li>
                    </ul>          
                  </test>                 
                </testlist>
                
                <testlist>
                  <h:b>Point-to-Point Wireless Bridges</h:b>
                  <test>
                    <ul>
                      <li>Setup a point-to-point wireless bridge using whitelisted APs in the range of the wireless sensors.</li>
                      <li>Record whether the TSF detects the bridge.</li>
                    </ul>          
                  </test>                 
                </testlist>
 
              </tests>
            </aactivity>
          </f-element>
          
        </f-component>
        <f-component id="fau_wid_ext.3" name="Wireless Intrusion Detection – Denial of Service" status="threshold">
          <f-element id="fau_wid_ext.3.1">
            <title> The TSF shall detect the following intrusions: 
              <h:i>[RF-based denial of service, deauthentication flooding, disassociation flooding, request-to-send/clear-to-send abuse, <assignable>other DoS methods</assignable>]</h:i>.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                <testlist>
                  <h:b>RF-based DoS</h:b>
                  <test>
                    <ul>
                      <li>Deploy whitelisted AP and configure to stay in a particular channel.</li>
                      <li>Connect a whitelisted client to the AP.</li>
                      <li>Use an RF Jammer or signal generator on the same frequency as the devices to create a DoS.</li>
                      <li>Verify that the TSF detects the RF-based DoS.</li>
                    </ul>          
                  </test>                 
                </testlist>
                <testlist>
                  <h:b>Traffic injection based DoS</h:b>
                  <test> <h:b>Deauthentication Flood</h:b>
                    <ul>
                      <li>Deploy whitelisted AP and configure to stay in a particular channel.</li>
                      <li>Connect a whitelisted client to the AP.</li>
                      <li>Send an flood of deauthentication frames to the client device using the MAC address of whitelisted AP it is connected to.</li>
                      <li>Verify that the TSF detects the deauthentication flood.</li>
                      <li>Send an flood of deauthentication frames with the MAC address of whitelisted AP as the source and destination as a broadcast.</li>
                      <li>Verify that the TSF detects the deauthentication flood.</li>             
                    </ul>          
                  </test>
                  <test> <h:b>Dissasociation Flood</h:b>
                    <ul>
                      <li>Deploy whitelisted AP and configure to stay in a particular channel.</li>
                      <li>Connect two whitelisted clients to the AP.</li>
                      <li>Send an flood of CTS frames to reserve RF medium.</li>
                      <li>Verify that the TSF detects the CTS abuse.</li>
                    </ul>          
                  </test> 
                </testlist>

              </tests>
            </aactivity>
          </f-element>
        </f-component>

        <f-component id="fau_wid_ext.4" name="Wireless Intrusion Detection – Unauthorized Authentication Schemes" status="threshold">
          <f-element id="fau_wid_ext.4.1">
            <title> 
              The TSF shall provide Authorized Administrators the ability to define authorized WLAN authentication schemes.
            </title>
            <aactivity>	
              <guidance>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to set the allowed authentication schemes.
              </guidance>
              <tests>The evaluator shall configure the TSF with a set of authorized WLAN authentication schemes. The ability to detect violation
                of this policy will be tested in <linkref linkend="FAU_WID_EXT.4.2"/></tests>.
              
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.4.2">
            <title> 
              The TSF shall detect when <h:i>[whitelisted devices defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> attempt to use WLAN authentication 
              schemes that are not authorized.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall configure the TSF with 802.1x authentication as the only mode of authorized WLAN authentication schemes and perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <ul>
                      <li>Deploy a whitelisted AP with open authentication.</li>
                      <li>Connect a whitelisted client to AP. </li>
                      <li>Verify that the TSF detects the AP and the client using unauthorized authentication schemes. </li>
                      <li>Deploy a whitelisted AP that uses pre-shared key authentication.</li>
                      <li>Connect a whitelisted client to AP. </li>
                      <li>Verify that the TSF detects the AP and the client using unauthorized authentication schemes. </li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>

          </f-element>
        </f-component>
        
        <f-component id="fau_wid_ext.5" name="Wireless Intrusion Detection – Unauthorized Encryption Schemes" status="threshold">
          <f-element id="fau_wid_ext.5.1">
            <title> 
              The TSF shall provide Authorized Administrators the ability to define authorized WLAN encryption schemes.
            </title>
            <aactivity>	
              <guidance>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to set the allowed encryption schemes.
              </guidance>
              <tests>The evaluator shall configure the TSF with a set of allowed encryption schemes. The ability to detect violation
                of this policy will be tested in <linkref linkend="FAU_WID_EXT.5.2"/></tests>.
              
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.5.2">
            <title> 
              The TSF shall detect when <h:i>[whitelisted devices defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> attempt to use WLAN encryption schemes 
              that are not authorized.
            </title>
            <aactivity>	
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              
              <tests> The evaluator shall configure the TSF with 128 bit AES encryption type as the only allowd encryption scheme 
                and perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <ul>
                      <li>Deploy a whitelisted AP with no encryption.</li>
                      <li>Connect a whitelisted client to AP. </li>
                      <li>Verify that the TSF detects the AP and the client using unauthorized encryption schemes. </li>
                      <li>Deploy a whitelisted AP that uses TKIP encryption only.</li>
                      <li>Connect a whitelisted client to AP. </li>
                      <li>Verify that the TSF detects the AP and the client using unauthorized encryption schemes. </li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>          </f-element>
          <f-element id="fau_wid_ext.5.3">
            <title> 
              The TSF shall detect when <h:i>[whitelisted devices defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> send or receive unencrypted data.
            </title>
            <note role="application">When referring to unencrypted data being received by a whitelisted device it refers to unencrypted data 
              being sent to a whitelisted device from either a non-whitelisted or whitelisted device.</note>
            <aactivity>
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                <testlist>
                  <test>
                  <ul>
                    <li>Send a set of crafted unencrypted data frames to a whitelisted client device. </li>
                    <li>Verify that the TSF detects unecrypted data frames being addressed to the whitelisted client.</li>
                    <li>Send a set of crafted unencrypted data frames with the mac address of a whitelisted client device to another client device.</li>
                    <li>Verify that the TSF detects unecrypted data frames being sent from the whitelisted client.</li>
                  </ul>
                </test>
               </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
     
        <f-component id="fau_wid_ext.6" name="Wireless Intrusion Detection – Wireless Spectrum Monitoring" status="optional">
          <f-element id="fau_wid_ext.6.1">
            <title> 
              The TSF shall detect the presence of network devices that operate in the following RF bands: 
              <selectables>
                <selectable>3.6 GHz</selectable>
                <selectable>60 GHz</selectable>
                <selectable>sub-GHz (0-900 MHz)</selectable>
                <selectable>all cellular bands</selectable>
              </selectables>
            </title>
            <note role="application">This SFR refers to Non-WiFi (IEEE 802.11 a, b, g, n, and ac) network devices that operate 
              in the specified frequencies. If the ST author selects detection of devices in the cellular bands, the ST author 
              must include selection-based requirement <linkref linkend="FAU_INV_EXT.4.1"/></note>.
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes the set of RF bands and 
                technologies that the TSF detect devices on. The TSS should also include instructions on how to enable and the hardware
                that is necessary for the additional band detection. 
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                The evaluator shall enable and configure detection of the selected technologies.
                <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects the device.</test>
                </testlist>               
              </tests>
              
            </aactivity>
          </f-element>
          <f-element id="fau_wid_ext.6.2">
            <title> 
              The TSF shall provide a dedicated sensor for wireless spectrum analysis.
            </title>
            <aactivity>	
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to enable and configure dedicated spectrum analysis
                as well as the the hardware needed. The TSS should also include details on the spectrum analysis capabilities of the TSF.
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                The evaluator shall enable and configure dedicated spectrum analysis and test the capabilities listed in the TSS.             
              </tests>              
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_wid_ext.7" name="Wireless Intrusion Detection – Proprietary Traffic Monitoring" status="objective">
          <f-element id="fau_wid_ext.7.1">
            <title> The TSF shall detect the presence of all vendor proprietary network traffic matching the [<h:i>802.11 monitoring <abbr linkend="SFP"/></h:i>]
              for [<h:i>all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <ol>
                <li><h:i>authorized APs and authorized clients.</h:i></li>
                <li><h:i>authorized APs and unauthorized clients.</h:i></li>
                <li><h:i>unauthorized APs and authorized clients.</h:i></li>
              </ol>]            
            </title>
            <aactivity>
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                <testlist>
                  <test>
                    <ul>
                      <li>Set the wids sensor for a set channel.</li>
                      <li>Start a traffic capture from the WIDS sensor.</li>
                      <li>Send a set number of frames on the channel the sensor's operating channel for all IEEE 802.11 a, b, g, n, ac 
                        vendor propietaryframe types and subtypes from/to the following:
                        <ol>
                          <li><h:i>authorized APs and authorized clients.</h:i></li>
                          <li><h:i>authorized APs and unauthorized clients.</h:i></li>
                          <li><h:i>unauthorized APs and authorized clients.</h:i></li>
                        </ol>
                      </li>
                      <li>
                        Provide a list of the frames types and subtypos that were used for testing and record whichones where detected. 
                      </li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_wip_ext.1" name="Wireless Intrusion Prevention" status="objective">
          <f-element id="fau_wip_ext.1.1">
            <title> The TSF shall allow an Authorized Administrator to isolate a wireless device from the network monitored 
              by the TSF using the following methods: 
              <selectables>
                <selectable>wireless containment.</selectable>
                <selectable>wireside containment of an unauthorized AP connected to the internal corporate wired network.</selectable>
              </selectables>     
            </title>
            <note role="application">It is expected that an Authorized Administrator will be responsible for confirming the 
              device as a rogue device to initiate wireless containment. <h:br/> 
              In this SFR the containment of an an unauthorized AP connected to the internal corporate wired network refers to an unauthorized AP 
              that is physically connected (via wire) to the protected internal wired infrastructure. 
            </note>
            <aactivity>
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes a list of available containment methods on the TSF and 
              how to configure them.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests> Configure the containment methods available on the TSF and perform the following test for each method.
                <testlist>
                  <test>
                    <ul>
                      <li>Deploy a non-whitelisted AP and connect to wire. (make sure it gets classified as rogue, or manually classify).</li>
                      <li>Connect a whitelisted client device to the AP.</li>
                      <li>Verify that TSF generates an alert, brakes the connection of the whitelisted device from the rogue AP, and contains the rogue AP.</li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="fau_gen.1/wids" name="Audit Data Generation" status="threshold">
          <f-element id="fau_gen.1.1/wids">
            <title> The TSF shall be able to generate an audit record of the following auditable events:
              <ol type="a">
                <li>Start-up and shutdown of the audit functions;</li>
                <li>All auditable events for the [not specified] level of audit;</li>
                <li><h:i>[Auditable events listed in Table 3;</h:i></li>
                <li><h:i>Failure of wireless sensor communication].</h:i></li>
              </ol>
              <table>
                <tr><td><h:b>Requirement</h:b></td><td><h:b>Auditable Events</h:b></td><td><h:b>Additional Audit Record Contents</h:b></td></tr>
                <tr><td>FAU_ANO_EXT.1.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_ANO_EXT.1.2</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_ARP.1.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_ARP_EXT.2.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_GEN.1.1/WIDS</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_GEN.1.2/WIDS</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_IDS_EXT.1.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.1.1</td>
                  <td>whitelisted devices information</td>
                  <td>Type of device (AP or EUD), MAC Address.</td></tr>
                <tr><td>FAU_INV_EXT.1.2</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.1.3</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.2.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.2.2</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.2.3</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_INV_EXT.3.1</td>
                    <td>Unexpected behavior by whitelisted device alert</td>
                    <td>Description of behavior detected (i.e., bridge, ICS connection), 
                         MAC address of whitelisted device,
                         MAC address of the device that the whitelisted device made a connection with,
                         connection start and end.</td></tr>
                <tr><td>FAU_INV_EXT.4.1</td>
                    <td>Information on location of device</td>
                  <td>Device MAC address, device type, classification of device, sensors that detected device, 
                    signal strength as received by detecting sensor(s), proximity to detecting sensor(s) (in meters). </td></tr>
                <tr><td>FAU_INV_EXT.4.1/CELL</td>
                    <td>Information on location of device</td>
                  <td>device MAC address, device type, classification of device, sensors that detected device, 
                    signal strength as received by detecting sensor(s), proximity to detecting sensor(s) (in meters). </td></tr>
                <tr><td>FAU_INV_EXT.5.1</td>
                    <td>Alert generated by detection of rogue device.</td>
                    <td>Description of alert, 
                      type of device (AP or EUD),
                      MAC Address, 
                      associations made between authorized devices (which APs are EUDs connected to), 
                      channel detected on, 
                      RF Band detected on, 
                      encryption type used by rogue, 
                      IEEE 802.11 standard used (a, b, g, n, ac), 
                      SSID (if AP).
                    </td></tr>
                <tr><td>FAU_MAC_EXT.1.1</td>
                    <td>Alert generated by detection of mac spoofing.</td>
                  <td>Description of alert, 
                    type of device (AP or EUD),
                    MAC Address, 
                    associations made between authorized devices (which APs are EUDs connected to), 
                    channel detected on, 
                    RF Band detected on, 
                    encryption type used by rogue, 
                    IEEE 802.11 standard used (a, b, g, n, ac), 
                    SSID (if AP).</td></tr>
                <tr><td>FAU_MAC_EXT.1.2</td>
                    <td>Alert generated by detection of mac spoofing.</td>
                    <td>Description of alert, location as labeled by administrator, time elapsed between connection in different locations,
                      type of device (AP or EUD),
                      MAC Address, 
                      associations made between authorized devices (which APs are EUDs connected to), 
                      channel detected on, 
                      RF Band detected on, 
                      encryption type used by rogue, 
                      IEEE 802.11 standard used (a, b, g, n, ac), 
                      SSID (if AP).</td></tr>
                <tr><td>FAU_SAA.1.1</td>
                    <td>None</td>
                    <td>None</td></tr>
                <tr><td>FAU_SAA.1.2</td>
                    <td>None</td>
                    <td>None</td></tr>                    
                <tr><td>FAU_SIG_EXT.1.1</td>
                    <td>Alert generated by violaton of user defined signature.</td>
                  <td>Name of alert being triggered(as provided when creating the signature), description of alert (as provided when creating the signature),
                      MAC address of devices involved. 
                  </td></tr>
                <tr><td>FAU_STG_EXT.1.1/PCAP</td>
                    <td>None</td>
                    <td>None</td></tr>
                <tr><td>FAU_STG_EXT.1.2/PCAP</td>
                    <td>None</td>
                    <td>None</td></tr>
                <tr><td>FAU_STG_EXT.1.2/pcap,</td>
                    <td>None</td>
                    <td>None</td></tr>
                <tr><td>FAU_STG_EXT.1.3/PCAP</td>
                    <td>None</td>
                    <td>None</td></tr>
                <tr><td>FAU_WID_EXT.1.1</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_WID_EXT.1.2</td><td>None</td><td>None</td></tr>
                <tr><td>FAU_WID_EXT.2.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FAU_WID_EXT.2.2</td>
                  <td>Failure of wireless sensor communication alert.</td>
                  <td>Indicate sensor failure, name of sensor (or other sensor identifier), and when the sensor was last seen online.</td></tr>
                <tr><td>FAU_WID_EXT.2.3</td>
                  <td>Details about what SSIDs and channels are set as authorized.</td>
                  <td>SSIDs and channels set by administrator as authorized.</td></tr>
                <tr><td>FAU_WID_EXT.2.4</td>
                  <td>Unauthorized activity</td>
                  <td>description of violation (i.e. illegal channel used by whitelisted device), identity information of the devices involved.</td></tr>
                <tr><td>FAU_WID_EXT.3.1</td>
                  <td>Alert generated for DoS.</td>
                  <td>MAC Address of victim, device type, classification of both attacker and victim, DoS details (RF or injection based), for injection-based, 
                    indicate type (i.e., deauth flood). </td></tr>
                <tr><td>FAU_WID_EXT.4.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FAU_WID_EXT.4.2</td>
                  <td>Information about devices and unauthorized authentication methods.</td>
                  <td>MAC Address, device type, and classification of devices involved, authentication method used.</td></tr>
                <tr><td>FAU_WID_EXT.5.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FAU_WID_EXT.5.2</td>
                  <td>Information about devices and unauthorized encryption methods.</td>
                  <td>MAC Address, device type, and classification of devices involved, encryption method used.</td></tr>
                <tr><td>FAU_WID_EXT.5.3</td>
                  <td>Information about devices involved.</td>
                  <td>MAC Address, device type, and classification of devices involved (sending and receiving devices).</td></tr>
                <tr><td>FAU_WID_EXT.6.1</td>
                  <td>Information about detected devices.</td>
                  <td>Frequency band, channel used within frequency band, identification information (MAC address if applicable or other similar unique ID), device technology (i.e.,cellular), 
                    sensor(s) that detected devices.</td></tr>
                <tr><td>FAU_WID_EXT.6.2</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FAU_WID_EXT.7.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FAU_WIP_EXT.1.1</td>
                  <td>Information about action taken.</td>
                  <td>description of violation,the type of containment used, was containment triggered manually or automatically, 
                      sensor performing the containment (if wireless), details about the device (s) being contained (classification, 
                      device type, MAC address).</td></tr>
                <tr><td>FDP_IFC.1.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FMT_SMF.1.1/WIDS</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FPT_FLS.1.1</td>
                  <td>Information about failure.</td>
                  <td>Indication that there was a failure, type of failure, details about device that failed (MAC address, or other identifiers like device name), time of failure.</td></tr>
                <tr><td>FPT_ITT.1.1</td>
                  <td>None</td>
                  <td>None</td></tr>
                <tr><td>FTP_ITC.1.1</td>
                  <td>None</td>
                  <td>None</td></tr>
              </table>
              <table><tr>
                <td><h:b>Table 3: Auditable Events</h:b></td>
              </tr></table>
           </title>         
            <note role="application">The Auditable Events table includes optional and objective requirements. 
              The auditing of optional and objective requirements is only required if the vendor chooses to have the requirement evaluated by NIAP. </note>
          </f-element>
          <f-element id="fau_gen.1.2/wids">
            <title> The TSF shall record within each audit record as 
              <selectables>
                <selectable>comma separated values (CSV)</selectable>
                <selectable>common log format (CLF)</selectable>
                <selectable>JavaScript Object Notation (JSON)</selectable>
                <selectable>syslog</selectable>
              </selectables>
              at least the following information:
              <ol type="a">
                <li>Date and time of the event, type of event, subject identity (if applicable), and the outcome (success or failure) of the event;</li>
                <li>For each audit event type, based on the auditable event definitions of the functional components included in the PP/ST, 
                  [<h:i>auditable events listed in Table 3</h:i>].
                </li>
              </ol>              
            </title>
          </f-element>
        </f-component>
        
        <f-component id="FAU_ANO_EXT.1" name="Anomaly-Based Intrusion Detection" status="sel-based">
          <selection-depends req="fau_ids_ext.1.1"/>
          <f-element id="fau_ano_ext.1.1">
            <title> The TSF shall support the definition of 
              <selectables atleastone="yes">
                <selectable>baselines (‘expected and approved’)</selectable>
                <selectable>anomaly (‘unexpected’) traffic patterns</selectable>
              </selectables>including the specification of 
              <selectables linebreak="yes">
                <selectable>throughput ([assignment: data elements (e.g. bytes, packets, etc.) per time period (e.g. minutes, 
                  hours, days)])</selectable>
                <selectable>time of day</selectable>
                <selectable>frequency; </selectable>
                <selectable>thresholds</selectable>
                <selectable><assignable>other methods</assignable></selectable>
              </selectables>  
              and the following network protocol fields: 
                <ul>
                  <li>all management and control frame header elements </li>
                </ul>
              
            </title>
            <aactivity>	
              <tss>
                The evaluator shall verify that the TSS describes the composition, construction, and application of baselines or 
                anomaly-based attributes specified in the SFR. The evaluator shall verify that the TSS provides a description of 
                how baselines are defined and implemented by the TSF, or a description of how anomaly-based rules are defined 
                and configured by the administrator.            
              </tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                <testlist>
                  <test>
                    <ul>
                      <li>The evaluator shall use the instructions in the operational guidance to configure baselines or anomaly-based rules</li>
                      <li>The evaluator shall send traffic that does not match the baseline or matches the anomaly-based rule 
                        and verify the TSF detects the anomalous behavior and generates an alert.</li>              
                    </ul></test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_ano_ext.1.2">
            <title> 
              The TSF shall support the definition of anomaly activity through 
              <selectables>
                <selectable>manual configuration by administrators</selectable>
                <selectable>automated configuration</selectable>
              </selectables>. 
            </title>
            <note role="application">
              The “baseline” and “anomaly” can be something manually defined/configured by a TOE administrator 
              (or importing definitions), or something that the TOE is able to automatically define/create by inspecting
              network traffic over a period of time (a.k.a. “profiling”). 
            </note>
            <aactivity>	
              <tss>
                The evaluator shall verify that the <abbr linkend="TSS"/> describes the available modes of configuration (manual or automatic) and how to configure or import the baseline. 
              </tss>
              <guidance>The evaluator shall verify that the options indicated are available. </guidance>
             </aactivity>
          </f-element>
        </f-component>
        <f-component id="FAU_SIG_EXT.1" name="Signature-Based Intrusion Detection" status="sel-based">
          <selection-depends req="fau_ids_ext.1.1"/>
          <f-element id="fau_sig_ext.1.1">
            <title> 
              The TSF shall support user-defined and customizable attack signatures.
            </title>
            <aactivity>	
              <tss>
                The evaluator shall verify that the <abbr linkend="TSS"/> includes instructions on how to how to configure user-defined attack signatures and the frame types 
                and subtypes that are available for the administrator to craft the signatures.            
              </tss>
              <guidance>The evaluator shall verify that the options indicated are available.</guidance>
              <tests>
                <testlist>
                  <test>
                    <ul>
                      <li>Craft a an signature with the available fields indicated in the TSS.</li>
                      <li>Send a crafted frame that matches the signature to a whitelisted EUD.</li>
                      <li>Verify that the TSF triggers an alert based on the newly define signature.</li>
                    </ul></test>
                </testlist>
              </tests>
             </aactivity>
          </f-element>
        </f-component>      
      
        <f-component id="fau_stg_ext.1/pcap" name="Protected Audit Event Storage (Packet Captures)" status="sel-based">
          <selection-depends req="fau_arp.1.1"/>
          <f-element id="fau_stg_ext.1.1/pcap">
            <title>The TSF shall be able to transmit the generated <h:b>packet captures</h:b> to an external IT entity using a 
              trusted channel according to FTP_ITC.1.
             </title>
            <note role="application">FTP_ITC.1 is inherited from the NDcPP.</note>
             <aactivity>	
              <tss>
                The evaluator shall verify that the <abbr linkend="TSS"/> include the list of trusted channels (as specified in FTP_ITC.1) available in the TSF to 
                transmit packet catpures to an external entity. The TSS shall also include instructions on how to configure the trusted channel.
              </tss>
               <guidance>
                 There are no guidance activities for this SFR.
               </guidance>
               <tests> 
                   The evaluator shall configure packet captures according to the guidance specified
                   in the TSS. The evaluator shall then trigger an event that starts a capture and verify through the tests in FTP_ITC.1 that the
                   captured traffic being sent to the external device is being sent through a trusted channel.
               </tests>
             </aactivity>
           </f-element>
          <f-element id="fau_stg_ext.1.2/pcap">
            <title>The TSF shall be able to store generated <h:b>packet captures</h:b> on the TOE itself.
            </title>
            <aactivity>
              <tss>The evaluator shall verify that the <abbr linkend="TSS"/> includes configuration guidance for storing a packet
                capture on the TOE.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests> 
                The evaluator shall configure packet captures to be stored on the TSF according to the guidance specified
                in the TSS. The evaluator shall then trigger an event that starts a capture and verify that the packet capture was stored on the TSF.
              </tests>
            </aactivity>
          </f-element>
          <f-element id="fau_stg_ext.1.3/pcap">
            <title> The TSF shall 
              <selectables>
                <selectable>drop new packet capture data</selectable>
                <selectable>overwrite previous packet captures according to the following rule
                  <assignable>rule for overwriting previous packet captures</assignable>
                </selectable>
                <selectable>
                  <assignable>other action</assignable>
                </selectable> 
              </selectables> when the local storage space for packet capture data is full.             
            </title>
            <aactivity>
              <tss>The evaluator shall confirm that the TSS includes instructions on how to set rules for for packet data retention and deletion on the TSF.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>The evaluator shall packet data retention and deletion rules on the TSF as specified in the TSS and test the functionality of the specified rules.</tests>
            </aactivity>
          </f-element>
         </f-component>
      </subsection>
      
      
      <subsection title="User Data Protection" id="FDP">
        <f-component id="FDP_IFC.1" name="Information Flow Control Policy" status="threshold">
          <f-element id="FDP_IFC.1.1">
            <title> 
              The TSF shall enforce the <h:i>[802.11 monitoring <abbr linkend="SFP"/>]</h:i> for <h:i>[all IEEE 802.11 a, b, g, n, ac frame types 
              and subtypes between:</h:i>
              <ul>
                <li><h:i>authorized APs and authorized clients </h:i></li>
                <li><h:i>authorized APs and unauthorized clients</h:i></li>
                <li><h:i>unauthorized APs and authorized clients</h:i>].</li>
              </ul>     
            </title>
            <note role="application">“Authorized” clients/APs are those that are assigned to the whitelist as defined by <linkref linkend="FAU_INV_EXT.1.1"/>. </note>
            <aactivity>
              <tss>There are no TSS assurance activities for this SFR.</tss>
              <guidance>There are no guidance activities for this SFR.</guidance>
              <tests>
                <testlist>
                  <test>
                    <ul>
                      <li>set the wids sensor for a set channel</li>
                      <li>Start a traffic capture from the WIDS sensor</li>
                      <li>Send a set number of frames on the channel the sensor's operating channel for all IEEE 802.11 a, b, g, n, ac frame 
                        types and subtypes from/to the following:
                        <ol>
                          <li><h:i>authorized APs and authorized clients</h:i></li>
                          <li><h:i>authorized APs and unauthorized clients</h:i></li>
                          <li><h:i>unauthorized APs and authorized clients</h:i></li>
                        </ol>]   
                      </li>
                      <li>
                        Verify that there are frames from all the types and subtypes in the capture.
                      </li>
                    </ul>
                  </test>
                </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      
      <subsection id="FMT" title="Security Management">
        <f-component id="FMT_SMF.1/WIDS" name="Specification of Management Functions (WIDS)" status="threshold">
          <f-element id="FMT_SMF.1.1/WIDS">
            <title> 
              The TSF shall be capable of performing the following management functions for WIDS functionality: 
              [<h:i>management functions listed in Table 2</h:i>].        
              <table>
                <tr>
                  <td>SFR</td>
                  <td>Management Function</td>
                </tr>
                <tr>
                  <td>FAU_ANO_EXT.1</td>
                  <td>Specification of periods of network activity that constitute baseline of expected behavior (optional).</td>
                </tr>
              </table>
              <table>
                <tr>
                  <td>Table 2: Management Functions</td>
                </tr>
              </table>     
            </title>
          </f-element>
        </f-component>
       </subsection>
      
      <subsection id="FPT" title="Protection of the TSF">
        <f-component id="FPT_ITT.1" name="Basic Internal TSF Data Transfer Protection" status="threshold">
          <f-element id="FPT_ITT.1.1 Refinement">
            <title> 
              The TSF shall <h:b>use</h:b> <selectables atleastone="yes">
                <selectable>IPsec</selectable>
                <selectable>SSH</selectable>
                <selectable>TLS</selectable>
                <selectable>TLS/HTTPS</selectable>
              </selectables> <h:b>with security strength commensurate with all other trusted communications to</h:b> protect TSF data from 
              disclosure and modification when it is transmitted between separate parts of the TOE.
            </title>
            <note role="application">This requirement ensures all communications between components of a distributed TOE is protected 
              through the use of an encrypted communications channel.  The data passed in this trusted communication channel are encrypted 
              as defined in the protocol chosen in the selection.  The ST author chooses the mechanisms supported by the TOE, and then 
              ensures the appropriate requirements from the NDcPP corresponding to their selection are copied to the ST if not already 
              present. For the purposes of this requirement, security strength is defined by NIST SP 800-57, “commensurate” means that 
              the strengths must, at a minimum, meet the requirements for the cryptographic primitives listed in the EP, and “other 
              trusted communications” refers to the mechanisms specified in FPT_ITC.
            </note>
            <aactivity>
              <tss>
                The evaluator shall examine the TSS to determine that the methods and protocols used to protect
                distributed TOE components are described. The evaluator shall also confirm that all protocols listed in
                the TSS in support of TOE administration are consistent with those specified in the requirement, and are
                included in the requirements in the ST.                 
              </tss>
              <guidance>
                The evaluator shall confirm that the operational guidance contains instructions for establishing the
                communication paths for each supported method. 
              </guidance>
              <tests>
                The evaluator shall also perform the following tests:
                <testlist>
                  <test>The evaluators shall ensure that communications using each specified (in the operational
                guidance) communications method is tested during the course of the evaluation, setting up the
                connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of communication, the channel data is not sent in
                plaintext.</test>
                </testlist>

                Further assurance activities are associated with the specific protocols.
                
              </tests>
              
            </aactivity>
          </f-element>
        </f-component> 
        <f-component id="fpt_fls.1" name="Basic Internal TSF Data Transfer Protection" status="objective">
          <f-element id="fpt_fls.1.1">
            <title> The TSF shall preserve a secure state when the following types of failures occur: 
              [<h:i>sensor functionality failure, potential compromise of the TSF</h:i>].
            </title>
            <note role="application">At minimum, the preservation of a secure state requires the generation of audit records when 
              the defined failure conditions occur.
            </note>
            <aactivity>	
              <tss>
                The evaluator shall review the TSS section to determine that the TOE’s implementation of the fail secure 
                functionality is documented. The evaluator shall examine the TSS section to ensure that all failure modes 
                specified in the ST are described.
              </tss>
              <guidance>There are no guidance activities for this SFR.
              </guidance>
              <tests> 
                For each failure mode specified in the ST, the evaluator shall ensure that the TOE attains a secure state
                after initiating each failure mode type.
              </tests>
            </aactivity>
          </f-element>
        </f-component>  
      </subsection>
      <subsection id="FTP" title="Trusted Paths/Channels">
        <f-component id="FTP_ITC.1" name="Inter-TSF trusted channel" status="threshold">
          <f-element id="FTP_ITC.1.1 Refinement">
            <title> 
              The TSF shall be capable of using [selection: IPsec,  SSH,  TLS, HTTPS] to provide   a   trusted   communication   channel
              between   itself   and authorized   IT   entities supporting  the  following  capabilities:  audit  server  
              <selectables>
                <selectable><h:b>database server</h:b><assignable>other   capabilities</assignable></selectable>
                <selectable></selectable>
              </selectables> that   is   logically   distinct   from   other   communication channels  and  provides  assured  identification
              of  its end  points  and  protection  of  the  channel  data from disclosure and detection of modification of the channel data.
            </title>
            <aactivity>
              The evaluator shall perform the following activities in addition to the assurance activity specified in the
              base NDcPP for this SFR: 
              <tss>
                The evaluator shall examine the TSS to determine that, for all communications with authorized IT
                entities identified in the requirement, each communications mechanism is identified in terms of the
                allowed protocols for that IT entity. The evaluator shall also confirm that all protocols listed in the TSS
                are specified and included in the requirements in the ST. 
              </tss>
              <guidance>
                The evaluator shall confirm that the guidance documentation contains instructions for establishing the
                allowed protocols with each authorized IT entity, and that it contains recovery instructions should a
                connection be unintentionally broken. 
                
              </guidance>
              <tests>
                <testlist>
                 <test>
                   The evaluators shall ensure that communications using each protocol with each authorized IT
                entity is tested during the course of the evaluation, setting up the connections as described in the
                guidance documentation and ensuring that communication is successful.
                 </test> 
                  <test>
                    For each protocol that the TOE can initiate as defined in the requirement, the evaluator shall
                follow the guidance documentation to ensure that in fact the communication channel can be initiated
                from the TOE.
                  </test>
                 <test>
                   The evaluator shall ensure, for each communication channel with an authorized IT entity, the
                channel data is not sent in plaintext.
                 </test>
                  <test>The evaluators shall, for each protocol associated with each authorized IT entity tested during
                test 1, physically interrupt an established connection. The evaluator shall ensure that when physical
                connectivity is restored, communications are appropriately protected.
                  </test>
                </testlist>
                Further assurance activities are associated with the specific protocols.
              </tests>
            </aactivity>
          </f-element>
        </f-component>  
      </subsection>
     </section>
  </chapter>
 
  <chapter title="Security Assurance Requirements" id="SARs">
    <h:p>This EP does not define any SARs beyond those defined within the NDcPP. It is important 
      to note that a TOE that is evaluated against this EP is inherently evaluated against NDcPP. 
      When evaluating the TOE, it is necessary to apply the SARs defined for the base PP to the 
      entire TOE and not just the portion that is described by the base PP.</h:p>   
  </chapter>

  
  <appendix title="Optional Requirements" id="optional"> 
    As indicated in <secref linkend="ConformanceClaims"/>,
    the baseline requirements (those that must be performed by the <abbr linkend="WIDS/WIPS"/>) are
    contained in the body of this EP. Additionally, there are three other types of requirements
    specified in <appref linkend="optional"/>, <appref linkend="sel-based"/>, and <appref
      linkend="objective"/>. The first type (in this Appendix) are requirements that can be included
    in the <abbr linkend="ST"/>, but are not required in order for a WIDS/WIPS to claim conformance to
    this EP. The second type (in <appref linkend="sel-based"/>) are requirements based on selections
    in the body of the EP: if certain selections are made, then additional requirements in that
    appendix must be included. The third type (in <appref linkend="objective"/> are components that
    are not required in order to conform to this EP, but will be included in the baseline
    requirements in future versions of this EP, so adoption by vendors is encouraged. Note that the
    ST author is responsible for ensuring that requirements that may be associated with those in
    <appref linkend="optional"/>, <appref linkend="sel-based"/>, and <appref linkend="objective"/>
    but are not listed (e.g., FMT-type requirements) are also included in the ST. 
  </appendix>

  <appendix title="Selection-Based Requirements" id="sel-based"> As indicated in the introduction to
    this EP, the baseline requirements (those that must be performed by the OS or its underlying
    platform) are contained in the body of this EP. There are additional requirements based on
    selections in the body of the EP: if certain selections are made, then additional requirements
    below will need to be included. 
  </appendix>

  <appendix title="Objective Requirements" id="objective"> This appendix includes requirements that 
    specify security functionality which also addresses threats. The requirements are not currently 
    mandated in the body of this EP as they describe security functionality not yet widely-available 
    in commercial technology. However, these requirements may be included in the ST such that the 
    WIDS/WIPS is still conformant to this EP. It is expected that these requirements will transition 
    from objective requirements to baseline requirements in future versions of this EP.
   </appendix>

  <appendix title="References" id="biblio">
    <bibliography>
      <entry id="bibCC">
        <tag>CC</tag>
        <description>Common Criteria for Information Technology Security Evaluation - <h:ul>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R4.pdf">Part
                1: Introduction and General Model</h:a>, CCMB-2012-09-001, Version 3.1 Revision 4,
              September 2012.</h:li>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R4.pdf">Part
                2: Security Functional Components</h:a>, CCMB-2012-09-002, Version 3.1 Revision 4,
              September 2012.</h:li>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R4.pdf">Part
                3: Security Assurance Components</h:a>, CCMB-2012-09-003, Version 3.1 Revision 4,
              September 2012.</h:li>
          </h:ul></description>
      </entry>
      <entry id="bibCEM">
        <tag>CEM</tag>
        <description>
          <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CEMV3.1R4.pdf">Common
            Evaluation Methodology for Information Technology Security - Evaluation Methodology</h:a>,
          CCMB-2012-09-004, Version 3.1, Revision 4, September 2012. </description>
      </entry>
  </bibliography>
  </appendix>

  <appendix title="Acronyms" id="acronyms">
    <acronyms>
      <entry>
        <term>AES</term>
        <description>Advanced Encryption Standard</description>
      </entry>
       <entry>
        <term>EP</term>
        <description>Extended Package</description>
      </entry>
      <entry>
        <term>HTTPS</term>
        <description>Hypertext Transfer Protocol Secure</description>
      </entry>
      <entry>
        <term>NIAP</term>
        <description>National Information Assurance Partnership</description>
      </entry>
      <entry>
        <term>NIST</term>
        <description>National Institute of Standards and Technology</description>
      </entry>
      <entry>
        <term>PP</term>
        <description>Protection Profile</description>
      </entry>
      <entry>
        <term>RFC</term>
        <description>Request for Comment</description>
      </entry>
      <entry>
        <term>TLS</term>
        <description>Transport Layer Security</description>
      </entry>
    </acronyms>
  </appendix>
  
</PP>
