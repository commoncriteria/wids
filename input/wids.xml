<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>

<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>


<!-- TODO:
    
  Justin
  - Are there other technical terms that need to be defined?
      * Added "Access Point (AP)"
      * Added "End User Device (EUD)"
      * Seperately defined WIDS and WIPS
      * SSID

 20190930     
  - Split apart any generic reference to WIDS/WIPS. It should be clear if something is for WIDS or WIPS
  - Push #1: Added requirements to FAU_WID_EXT.2 Wireless Intrusion Detection – Passive Information Flow Monitoring (FAU_WID_EXT.2.5 and FAU_WID_EXT.2.6 (Lines 1107 - 1123))
  - Push #2: Added requirements to FAU_IDS_EXT.1 Wireless Intrusion Detection – Intrusion Detection System – Intrusion Detection and Reporting  Methods (FAU_IDS_EXT.1.2 and FAU_IDS_EXT.1.3 (Lines 1107 - 1123))
  - Push #3: Updated Updated FAU_IDS_EXT.1.3
  - Push #4: Updated technical terms  and replaced 46 out of 58 referenced to "WIDS/WIPS" with  "WIDS"
  
  20191002
  - Push #1: Added requirement to Objective SFRs (FAU_INV_EXT.4 Precise Location of Environmental Objects) for the inclusion of a signal library.
  - Push #2: Made some grammar and punctuation changes. 

20191003
  - Push # 1: Added a component requirment under Objective SFRs ("PLACEHOLDER" element name) for TSF Device Configurations - Monitoring Time and Frequency. (Lines: 2332 - 2371)
  - Push # 2: Added a component requirment under Objective SFRs ("PLACEHOLDER" element name) for TSF Device Configurations - Device Configuration - Exporting Configuration and Event Data.
    (Lines: 2375 - 2421)
    Corrected formatting issue.
  - Push # 3: Push to synchronize changes.
     # Need to troubleshoot why I don't see the changes for Push #2, but I see the other ones. Commited and pushed changes twice, but when I refresh the https://commoncriteria.github.io/pp/wids/wids-release.html
         page, the changes aren't there. I see the push in GitHub, and all the other changes pushed today were successfully changed and verified.
20191004
  - Fixed build issue. Removed extra <steplist> tag that had no closing tag. Added </f-component> closing tag that was missing.

  20191009
   - Push # 1: Added WLAN Definition
   - Push # 2: Comments: Lauren - I identified the purpose behind "FAU_GEN.2(WIDS) Alerts Data Generation (WIDS/WIPS)"" table we had questions about yesterday, and I've changed my opinion about it usefullness. 
                      I now support it's inclusion for the following reason (please argue against if you think I'm missing something here):

                      The "FAU_SAA.1 Potential Violation Analysis - Potential Security Violations" table simply labels the types of auditable events the TSF should trigger off of, and whether it's a mandatory,
                       objective, or optional SFR.  Applying a set of rules for monitoring the wireless traffic, and based upon these rules, indicating a potential malicious action is different than actually identifying 
                       what information should be contanied within the triggered alert. If an event is triggerable, the "FAU_GEN.2(WIDS) Alerts Data Generation (WIDS/WIPS)" table specifically identifies what 
                      attributes (i.e. MAC address, SSID, signal strength, BSSID) should be captured and contained within the alert, and then eventually parsed and displayed by a reporting mechanism (e.g. SIEM, 
                      syslog, proprietary 3rd party solution). This table sperately provides a space within the mudule to define the specific device and event attributes that should be monitored for and captured 
                      within a triggerable event. Not all of the SFRs trigger an actual alert, hence why some requirements within the table have "None" specified under the "Auditable Events" column.

                      Let me know if you see and holes in my logic and understanding. 
 
 20191011
 - Push # 1: Added Assurance Activity to "fau_wid_ext.2.5" and "fau_wid_ext.2.6" 

 20191018
 - Push #1: Added additional aactivity testing and responded to 4 out 6 of Lauren's comments.

  Lauren
  - Are there any Use Cases??
  - Selection-Depends
  - Table ctr
  - Audit table
  - FPT_ITA, FPT_ITC, FPT_ITI - exportability of TSF data 
  FAU_WIDS_EXT.3 - need to update and put assignment in the selection??

  NIAP
  - consistency rationales throughout document
  - ECDs throughout document
  - Does this Module claim any packages?

  Kevin
  - Iterations as '/' - need Kevin to allow '/' in component id. Need to update boilerplate text that defines iteration as (#)
  - ND cPP is not in XML/github - how do I reference it?
  - Can we mark SFRs as (optional, sel-based, objective) in objective mapping?
  - Can you define abbr in the acronyms section?
 
 DONE:
 - Moved fpt_itt and ftp_itc to modified sfrs
 
 
-->


<Module boilerplate="yes" target-products="WIDS/WIPS" xmlns="https://niap-ccevs.org/cc/v1" name="Wireless Intrusion Detection/Prevention Systems" xmlns:h="http://www.w3.org/1999/xhtml">
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2019-07-06</PPPubDate>
      <Keywords>WIDS/WIPS, Wireless Intrusion Detection/Prevention System</Keywords>
    </ReferenceTable>
  </PPReference>
<RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2016-10-06</date>
      <subject>Initial Release - EP for NDcPP</subject>
    </entry>
</RevisionHistory>
 <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview">
      This Protection Profile Module (PP-Module) describes security requirements for a Wireless Intrusion Detection System (WIDS) defined to be an IEEE 802.11 network intrusion detection product located at the edge of a private network that can collect, inspect, and analyze real-time network traffic and alert the administrator of policy violations. This PP-Module is intended to provide a minimal baseline set of requirements that are targeted at mitigating well defined and described threats. <h:br/><h:br/>
      This PP-Module contains optional requirements for a Wireless Intrustion Protection System (WIPS) a security product that provides network security administrators with the additional ability to react in real-time to potentially malicious wireless (IEEE 802.11) network traffic.     
      <h:br/><h:br/>
      This PP-Module extends the collaborative Protection Profile for Network Devices (NDcPP).
    </section>
   <section title="Terms" id="glossary">
     <subsection title="Common Criteria Terms">
       <glossary>
         <entry>
           <term><abbr title="Base Protection Profile">Base-PP</abbr></term>
           <description>Protection Profile used to build a PP-Configuration.</description>
         </entry>
         <entry>
           <term><abbr title="Common Criteria">CC</abbr></term>
           <description>Common Criteria for Information Technology Security Evaluation
             (International Standard ISO/IEC 15408).</description>
         </entry>
         <entry>
           <term>Common Criteria Testing Laboratory</term>
           <description>Within the context of the Common Criteria Evaluation and Validation Scheme
             (CCEVS), an IT security evaluation facility, accredited by the National Voluntary
             Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to
             conduct Common Criteria-based evaluations.</description>
         </entry>
         <entry>
           <term><abbr title="Common Evaluation Methodology">CEM</abbr></term>
           <description>Common Evaluation Methodology for Information Technology Security
             Evaluation.</description>
         </entry>
         <entry>
           <term><abbr title="Protection Profile">PP</abbr></term>
           <description>An implementation-independent set of security requirements for a category
             of products.</description>
         </entry>
         <entry>
           <term><abbr title="Protection Profile Configuration">PP-Configuration</abbr></term>
           <description>A comprehensive set of security requirements for a product type that consists of at least one Base-PP and at least one PP-Module.</description>
         </entry>
         <entry>
           <term><abbr title="Protection Profile Module">PP-Module</abbr></term>
           <description>An implementation-independent statement of security needs for a TOE type
             complementary to one or more Base Protection Profiles. </description>
         </entry>
         <entry>
           <term><abbr title="Security Functional Requirement">SFR</abbr></term>
           <description>A requirement for security enforcement by the TOE".</description>
         </entry>
         <entry>
           <term><abbr title="Security Target">ST</abbr></term>
           <description>A set of implementation-dependent security requirements for a specific
             product.</description>
         </entry>
         <entry>
           <term><abbr title="Target of Evaluation">TOE</abbr></term>
           <description>The security functionality of the product under evaluation.</description>
         </entry>
         <entry>
           <term><abbr title="TOE Security Functionality">TSF</abbr></term>
           <description>The security functionality of the product under evaluation.</description>
         </entry>
         <entry>
           <term><abbr title="TOE Summary Specification">TSS</abbr></term>
           <description>A description of how a TOE satisfies the SFRs in an ST.</description>
         </entry>
       </glossary>
     </subsection>
     <subsection title="Technical Terms">
       <glossary>
         <entry>
           <term><abbr title="Access Point">AP</abbr></term>
           <description>A device that provides the network interface that enables wireless client hosts to access a wired network.</description>
         </entry> 
         <entry>
           <term><abbr title="End User Device">EUD</abbr></term>
           <description>A device that has the ability to process, transmit,  and/or store information.</description>
         </entry> 
         <entry>
           <term><abbr title="Media Access Control">MAC</abbr></term>
           <description>Media Access Control</description>
         </entry>      
         <entry>
           <term><abbr title="Service Set Identifier">SSID</abbr></term>
           <description>The primary name associated with an 802.11 wireless local area network (WLAN).</description>
         </entry>         
         <entry>
           <term><abbr title="Wireless Intrustion Detection System">WIDS</abbr></term>
           <description>A security product that provides network security administrators with the ability to monitor, collect, and log real-time to potentially malicious wireless (IEEE 802.11) network traffic.</description>
         </entry>
         <entry>
           <term><abbr title="Wireless Intrustion Prevention System">WIPS</abbr></term>
           <description>A security product that provides network security administrators with the ability to monitor, collect, log, and react in real-time to potentially malicious wireless (IEEE 802.11) network traffic.</description>
         </entry> 
         <entry>
           <term><abbr title="Wireless Local Area Network">WLAN</abbr></term>
           <description>A wireless computer network that links two or more devices using wireless communication to form a local area network (LAN) within a limited area such as a home, school, computer laboratory, campus, office building etc. </description>
         </entry>
       </glossary>
     </subsection>
   </section>  
   <section title="Compliant Targets of Evaluation" id="TOEdescription">
     <subsection title="TOE Boundary" id="TOEboundary"> 
       This PP-Module specifically addresses Wireless Intrusion Detection/Prevention Systems (WIDS/WIPS). A conformant WIDS is a product that can monitor, collect, inspect, and analyze real-time network traffic and alert the administrator of policy violations. <!-- TODO: add something about being able to detect the location of the endpoint -->WIPS functionality is not required to conform to this PP-Module, and it is optional for the TOE to have the additional ability to react in real-time to potentially malicious wireless (IEEE 802.11) network traffic.<h:br/><h:br/>
       A WIDS/WIPS TOE consists of multiple sensors that passively scan the RF environment on the WLAN radio frequency spectrum and a centralized mechanism such as a Server or Controller that processes the data collected by the sensors. Conformant TOEs must use a secure communication path(s) between WIDS/WIPS components.
       <h:br/><h:br/>
       A WIDS/WIPS can be Integrated (be part of the WLAN infrastructure) or Overlay (independent from WLAN) architecture depending on vendor implementation. The two different architectures are illustrated in the <xref linkend="toe"/> figure below. <h:br/><h:br/>
       A WIDS/WIPS is expected to inspect layers 1 and 2 network traffic, per the OSI network model and monitor wireless frames in the RF spectrum utilized by IEEE 802.11 a, b, g, n, and ac. Monitoring and inspection of other technologies (e.g., cellular) and protocols are optional.<h:br/><h:br/>
       Conformant TOEs will detect potentially malicious network traffic using various approaches. Broadly speaking, the traffic analysis could be based on identification of ‘known’ threats, or ‘unknown’ threats. Identification of ‘known’ threats may be performed through pattern matching, (e.g. by matching strings of characters within a frame with known patterns, or by matching traffic patterns common with reconnaissance or denial of service (DoS) attacks). Identification of ‘unknown’ threats may be performed through use of various forms of anomaly detection whereby the WIDS/WIPS is provided with (or learns/creates) a definition of expected/typical traffic patterns, such that it’s able to detect and react to anomalous (unexpected/atypical) traffic patterns.<h:br/><h:br/>
     
       <figure entity="images/TOE.jpg" title="General TOE" id="toe"/>
     </subsection>
   </section>
   <section title="Use Cases" id="usecases">
     <usecases>
       <usecase id="usecase1" title="Use Case 1">
         <description></description>
       </usecase>
     </usecases>
   </section>
 </chapter>
 <chapter title="Conformance Claims" id="ConformanceClaims">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description> This PP-Module inherits exact conformance as required from the specified Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based SFRs, and Optional SFRs (dated May 2017).<h:br/><h:br/>           
          The following PPs and PP-Modules are allowed to be specified in a PP-Configuration with this PP-Module. <h:ul>
            <h:li>Network Device cPP, version 2.1</h:li>
          </h:ul>
        </description>
      </cclaim>
      <cclaim title="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common Criteria Version 3.1, Release 5 [CC].
        </description>
      </cclaim>
      <cclaim title="Package Claims">
        <description><!-- NIAP: Does this module need to claim any packages? -->
          <!-- If YES: This PP-Module is <package name> Conformant. -->
            This PP-Module does not claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </chapter>
 <chapter title="Security Problem Description" id="spd">
   WIDS address a range of security threats related to detection of and reaction to potentially malicious WLAN traffic. The malicious traffic may pose a threat to one or more endpoints on the monitored networks, to the network infrastructure, or to the TOE itself. Attacks against a WLAN could compromise the confidentiality and integrity of WLAN users and system data as well as the availability of the WLAN to legitimate users. <h:br/><h:br/> 

The term “monitored network” is used here to represent any WLAN and/or wired network that the TOE is configured to monitor and detect intrusions on. This extends to the wired networks as intrusions on the wireless network can also be damaging to the wired infrastructure. The WIDS/WIPS also protect the wired infrastructure by detecting rogue devices that are directly connected to the wired infrastructure, which may expose the wired network, or unauthorized WLAN devices deployed in a no-wireless zone. 
   
   The terms "Wi-Fi", “Wi-Fi Network” and “WLAN” will be used interchangeably to represent a Wi-Fi network.<h:br/> <h:br/> 
    
    The proper installation, configuration, and administration of the WIDS are critical to its correct operation. A site is responsible for developing its security policy and configuring a rule set that the WIDS will enforce and provide an appropriate response to meet their needs, relative to their own risk analysis and their perceived threats.<h:br/><h:br/> 
    
    Note that this PP-Module does not repeat the threats identified in the NDcPP, though they all apply given the conformance and hence dependence of this PP-Module on the NDcPP. Note also that while the NDcPP contains only threats to the ability of the TOE to provide its security functions, this PP-Module addresses only threats to resources in the operational environment. Together the threats of the NDcPP and those defined in this PP-Module define the comprehensive set of security threats addressed by a WIDS TOE.
    <section title="Threats" id="threats">
      <threats>
        <threat id="T.UNAUTHORIZED_DISCLOSURE_OF_INFORMATION">
          <description> Unintended/unauthorized disclosure of sensitive information on a protected WLAN, such as sending unencrypted sensitive data. The WIDS will be capable of collecting and analyzing WLAN data to detect unauthorized disclosure of information.
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.SYSTEM_MONITORING as this provides for visibility into the network which enables detection of network violations.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.WIDS_ANALYZE as this provides detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by O.WIPS_REACT as this provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.UNAUTHORIZED_ACCESS">
          <description> An attacker may attempt to gain unauthorized access to a network, endpoints, or services, 
            by methods such as impersonation of an authorized AP to get an EUD to connect to the unauthorized AP 
            If malicious external APs or EUDs are able to communicate with APs or EUDs on the protected WLAN, then those devices may be
            susceptible to the unauthorized disclosure of information.
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of unauthorized APs and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIDS_ANALYZE as this
              provides detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIPS_REACT as this
              provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.TOE_ADMINISTRATION">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.TOE_ADMINISTRATION.</rationale>
          </objective-refer>         
        </threat>
        <threat id="T.DISRUPTION">
          <description> Attacks against the WLAN infrastructure might lead to denial of service (DoS) attacks within a protected WLAN. A 
            wireless DoS may occur in two ways: at the physical layer through RF Jamming, or at the data link layer through 
            packet injection. 
          </description>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.DISRUPTION is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of DoS attacks.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.DISRUPTION is countered by O.WIDS_ANALYZE as this
              provides for detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.DISRUPTION  is countered by O.WIPS_REACT as this
              provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>       
      </threats>
    </section>
    <section title="Assumptions" id="assumption">
      <assumptions>
        <assumption id="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner that ensures that the TOE's 
            security policies will be enforced on all applicable network traffic flowing among the attached networks. </description>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The operational environment objective OE.CONNECTIONS is realized through A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or hostile, and administers 
            the WIDS within compliance of the applied enterprise security policy. </description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale> The operational environment objective OE.PROPER_ADMIN is realized through A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="osp">
      An organization deploying the TOE is expected to satisfy the organizational security policy listed below in addition to all organizational 
      security policies defined by the claimed base PP.
      <OSPs>
        <OSP id="P.ANALYZE">
          <description>Analytical processes and information to derive conclusions about potential intrusions must be applied to WIDS 
            data and appropriate response actions taken.</description>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The organizational security policy P.ANALYZE is facilitated through O.WIDS_ANALYZE. </rationale>
          </objective-refer>
        </OSP>
      </OSPs>    
    </section>
  </chapter>
 <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.SYSTEM_MONITORING">
          <description> 
            To be able to analyze and react to potential network policy violations, the WIDS must be able to collect and store essential data elements of network traffic on monitored networks.<h:br/>
          </description>    
          <!-- Mandatory -->
          <component-refer ref="FAU_GEN.1/WIDS"/>
          <!-- Optional -->
          <component-refer ref="FAU_STG_EXT.1/PCAP"/>
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.WIDS_ANALYZE">
          <description> 
The WIDS must be able to analyze collected or observed WLAN activity on monitored network to identify potential
            violations of approved WLAN policies, unauthorized connections involving internal WLAN devices, and non-secure communications. <h:br/><h:br/>
          </description>
          <!-- Mandatory -->
          <component-refer ref="FAU_ARP.1"/>
          <component-refer ref="FAU_ARP_EXT.2"/>
          <component-refer ref="FAU_IDS_EXT.1"/>
          <component-refer ref="FAU_INV_EXT.1"/>
          <component-refer ref="FAU_INV_EXT.2"/>
          <component-refer ref="FAU_INV_EXT.3"/>
          <component-refer ref="FAU_SAA.1"/>
          <component-refer ref="FAU_WID_EXT.1"/>
          <component-refer ref="FAU_WID_EXT.2"/>
          <component-refer ref="FAU_WID_EXT.3"/>
          <component-refer ref="FAU_WID_EXT.4"/>
          <component-refer ref="FAU_WID_EXT.5"/>
          <component-refer ref="FDP_IFC.1"/>
          <!-- Optional -->
          <component-refer ref="FAU_ANO_EXT.1"/>
          <component-refer ref="FAU_INV_EXT.4"/>
          <component-refer ref="FAU_INV_EXT.4/CELL"/>
          <component-refer ref="FAU_INV_EXT.5"/>
          <component-refer ref="FAU_MAC_EXT.1"/>
          <component-refer ref="FAU_SIG_EXT.1"/>
          <component-refer ref="FAU_WID_EXT.6"/>
          <component-refer ref="FAU_WID_EXT.7"/>
          <consistency-rationale></consistency-rationale>
        </SO>
        <!-- NIAP: WIPS functionality is optional, so technically this is an optional objective - that's not allowed right? -->
        <SO id="O.WIPS_REACT">
          <description> The TOE must be able to react as configured by the administrators to isolate/contain 
            WLAN devices that have been determined to violate administrator-defined WIPS policies.  <h:br/>
          </description>
          <!-- Mandatory -->
          
          
          <!-- Optional -->
          <component-refer ref="FAU_WIP_EXT.1"/>
          
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.TOE_ADMINISTRATION">
          <description> To address the threat of unauthorized administrator access that is defined in the base PP, 
            Conformant TOEs will provide the functions necessary for an administrator to configure the WIDS 
            Capabilities of the TOE.
            <h:br/>
          </description>
          <!-- Mandatory -->
          <component-refer ref="FMT_SMF.1/WIDS"/>
          
          <!-- Optional -->
          
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.INSECURE_OPERATIONS">
          <description> There may be instances where the TOE’s hardware malfunctions or the integrity of the TOE’s software is compromised, 
            the latter being due to malicious or non-malicious intent. To address the concern of the TOE operating outside of its hardware 
            or software specification, the TOE will log or produce an alert upon discovery of a problem reported via the self-test mechanism.
            <h:br/>
          </description>
          <!-- Mandatory -->
          
          <!-- Optional -->
          <component-refer ref="FPT_FLS.1"/>
          
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.TRUSTED_COMMUNICATIONS">
          <description> To further address the threat of untrusted communications channels that is defined in the base PP, conformant TOEs 
            will provide trusted communications between distributed components if any exist. <h:br/>
          </description>
          <!-- Mandatory -->
          <component-refer ref="FPT_ITT.1"/>
          <component-refer ref="FTP_ITC.1"/>
          
          <!-- Optional -->
          
          <consistency-rationale></consistency-rationale>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment" id="SecurityObjectivesTOEorEnvironment">
      The following security objectives for the operational environment assist the TOE in correctly providing its security functionality. These track the assumptions about the environment. 
      <SOEs>
        <SOE id="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that will allow the TOE to effectively enforce its policies on the network traffic of monitored networks. </description>
          <consistency-rationale></consistency-rationale>
        </SOE>
        <SOE id="OE.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or hostile, and administers the WIDS within compliance of the applied enterprise security policy. </description>
          <consistency-rationale></consistency-rationale>
        </SOE>
      </SOEs>    
    </section>
    <section title="Security Objectives Rationale" id="SOR">
      <!-- Note: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </chapter>
 <chapter title="Security Requirements" id="sfrs">
   <!-- Kevin: What to do if base is not in github?? --> 
   <base-pp version="2.1" name="Network Device" product="Network Device" short="ND" url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=440&amp;id=440" xmlurl="test">
      <modified-sfrs>
        <subsection title="Protection of the TSF (FPT)" id="fpt" >
          <f-component id="fpt_itt.1" name="Basic Internal TSF Data Transfer Protection">
            <consistency-rationale></consistency-rationale>
            <f-element>
              <title>The TSF shall protect TSF data from <h:u>disclosure and <h:b>detect its</h:b> modification</h:u> when it is transmitted between separate parts of the TOE <h:b>through the use of <selectables>
                  <selectable>IPsec</selectable>
                  <selectable>SSH</selectable>
                  <selectable>TLS</selectable>
                  <selectable>TLS/HTTPS</selectable>
                </selectables></h:b>.         
                <!-- Old:
                Refinement: The TSF shall use [selection: IPsec, SSH, TLS, TLS/HTTPS] with security strength commensurate with all other trusted communications to protect TSF data from disclosure and modification when it is transmitted between separate parts of the TOE.
                -->              
              </title>
              <note role="application">
                <!-- NIAP: WRT how ND defines a distributed TOE, would a WIDS (Sensors and controller) be considered a distributed TOE?-->
                FPT_ITT.1 is optional in NDcPP, however, since a WIDS/WIPS TOE is distributed, FPT_ITT.1 shall be included in the ST as modified in this PP-Module and is applicable to the data transmitted between the sensors and controller.<h:br/><h:br/>
                This requirement ensures all communications between components of a distributed TOE is protected through the use of an encrypted communications channel.  The data passed in this trusted communication channel are encrypted as defined in the protocol chosen in the selection.  The ST author chooses the mechanisms supported by the TOE, and then ensures that the detailed protocol requirements in Appendix B of NDcPP corresponding to their selection are included in the ST, if not already present. 
                <!-- NIAP -->
                <!--  For the purposes of this requirement, security strength is defined by NIST SP 800-57, “commensurate” means that the strengths must, at a minimum, meet the requirements for the cryptographic primitives listed in the PP-Module, and “other trusted communications” refers to the mechanisms specified in FPT_ITC.-->
              </note>
              <aactivity>
                <!-- TODO: Need to remove TSS tags, but currently does not render if not in a tag   -->
                <TSS>The evaluator shall perform the evaluation activity specified in NDcPP for this SFR.</TSS>                                    
              </aactivity>
            </f-element>
          </f-component> 
        </subsection>          
        <subsection title="Trusted Paths/Channels (FTP)" id="ftp" >
          <f-component id="ftp_itc.1" name="Inter-TSF trusted channel">
            <consistency-rationale></consistency-rationale>
            <f-element>
              <title>  Refinement:
                The TSF shall <h:b>be capable of using <selectables>
                  <selectable>IPsec</selectable>
                  <selectable>SSH</selectable>
                  <selectable>TLS</selectable>
                  <selectable>HTTPS</selectable>  
                </selectables> to</h:b> provide a trusted communication channel between itself and <h:b>authorized IT entities supporting the following capabilities:  audit server, <selectables>
                  <selectable>database server</selectable>
                  <selectable><assignable>other capabilities</assignable></selectable>
                  <selectable>no other capabilities</selectable>
                </selectables></h:b> that is logically distinct from other communication channels  and  provides  assured  identification
                of its end  points  and  protection  of  the  channel  data from <h:b>disclosure and detection of modification of the channel data.</h:b>
              </title>
              
            </f-element>
            <f-element>
              <title>The TSF shall permit <h:b><h:u>the TSF or the authorized IT entities</h:u></h:b> to initiate communication via the trusted channel.</title>
            </f-element>
            <f-element>
              <title>The TSF shall initiate communication via the trusted channel for [assignment: list of services for which the TSF is able to initiate communications].</title>
              <note role="Application">
                <!-- NIAP: Should I copy the entire App note from ND? -->
                The intent of the above requirement is to provide a means by which a cryptographic protocol may be used to protect external communications with authorized IT entities that the TOE interacts with to perform its functions. The TOE uses at least one of the listed protocols for communications with the server that collects the audit information. <h:br/><h:br/> 
                If the TSF uses a separate database server, the database server selection must included in the ST.<h:br/><h:br/>
                If other authorized IT entities are protected, the ST author makes the appropriate
              assignments (for those entities) and selections (for the protocols that are used to protect those
              connections). The ST author selects the mechanism or mechanisms supported by the TOE, and
              then ensures that the detailed protocol requirements in Appendix B of NDcPP corresponding to their
              selection are included in the ST.            
              </note>
              <aactivity>
                <!-- TODO: Need to remove TSS tags once this issue is fixed -->
                <TSS>The evaluator shall perform the evaluation activity specified in NDcPP for this SFR, with the inclusion of test 4, which is objective in NDcPP.  </TSS>
              </aactivity>
            </f-element>
          </f-component>  
        </subsection>         
      </modified-sfrs>   
      <additional-sfrs/>
      <con-toe>
        When this PP-Module extends the Network Device cPP, the TOE type for the overall TOE is still WIDS/WIPS products. 
      </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
    </base-pp> 
   
   <man-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        <f-component id="fau_arp.1" name="Security Alarms">       
          <consistency-rationale></consistency-rationale>
          <f-element>
            <title> The TSF shall take <h:i>[the following actions: display alert to Authorized Administrator in sufficient detail to show identity of APs and EUDs involved, description of alert and severity level, </h:i><selectables>
                <selectable id="pcap">capture raw frame traffic that triggers the violation</selectable>
                <selectable>no other actions</selectable>
              </selectables>] upon detection of a potential security violation.          
            </title>
            <note role="application">
              If "capture raw frame traffic that triggers the violation" is selected then <linkref linkend="FAU_STG_EXT.1/pcap"/> shall be included in the ST.</note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes where to find the WIDS alerts on the Administrator console/interface.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall use the operational guidance for instructions on where the alerts generated are displayed within the WIDS interface. If the objective requirement to capture the raw frame that triggered an alert is selected, the evaluator must also test for corresponding selection-based requirements. The evaluator shall use the operational guidance to configure the traffic capture capabilities.<h:br/><h:br/> 
              </Guidance>         
              <Tests> The evaluator shall perform the following tests:<h:br/>             
                <testlist>           
                  <test>The evaluator shall perform a series of events or generate traffic that would successfully trigger an alert. 
                    The evaluator should verify and record whether the TOE generated the alert. The evaluator should also record the events or traffic 
                    that was generated and what alert was attempted to be triggered and record the details provided by the TOE in the alert.<h:br/>
                  </test>
                  <test>
                    If capturing of raw frames was selected, verify that the packet capture was triggered and stored as appropriate. 
                  </test>
                </testlist>
              </Tests>           
            </aactivity>
          </f-element>
        </f-component>             
        
        <ext-comp-def title="Security Alarm Filtering" fam-id="FAU_ARP_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_arp_ext.2" name="Security Alarm Filtering">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall provide the ability to apply <assignable>methods of selection</assignable> to selectively exclude alerts from being generated. </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to transmit WIDS alerts.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance includes instructions on enabling and disabling alerts.<h:br/><h:br/> 
              </Guidance>          
              <Tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>The evaluator shall use the operational guidance to enable/disable detection of available detection capabilities through the WIDS 
                          administrator interface. The evaluator shall then generate traffic that would successfully trigger the alert. The evaluator should verify 
                          that the TOE generated the alert. The evaluator shall record the attack/intrusion that was generated and indicate which alert was triggered
                        as well as the details that were provided by the WIDS about the alert.</h:li>
                      <h:li>The evaluator shall disable the alert. The evaluator shall then generate events as in previous test that should successfully 
                        trigger the alert. The evaluator should check if the TOE generated an alert for the attack and record the findings. 
                      </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
           
        <f-component id="fau_gen.1(wids)" name="Audit Data Generation">
          <consistency-rationale></consistency-rationale>
          <f-element>
            <title> The TSF shall be able to generate an audit record of the following auditable events:
              <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [not specified] level of audit;</h:li>
                <h:li><h:i>[Auditable events listed in <ctr-ref refid="auditWids"/>;</h:i></h:li>
                <h:li><h:i>Failure of wireless sensor communication].</h:i></h:li>
              </h:ol>
              <h:table>
                <h:tr><h:td><h:b>Requirement</h:b></h:td><h:td><h:b>Auditable Events</h:b></h:td><h:td><h:b>Additional Audit Record Contents</h:b></h:td></h:tr>
                <h:tr><h:td>FAU_ANO_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>              
                <h:tr><h:td>FAU_ARP.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_ARP_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_GEN.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_IDS_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>           
                <h:tr><h:td>FAU_INV_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>             
                <h:tr><h:td>FAU_INV_EXT.3</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.4</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.4/CELL</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.5</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_MAC_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>             
                <h:tr><h:td>FAU_SAA.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>                               
                <h:tr><h:td>FAU_SIG_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_STG_EXT.1/PCAP</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>      
                <h:tr><h:td>FAU_WID_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.2</h:td><h:td>Sensor wireless transmissions capabilities.</h:td><h:td>Wireless transmission cappabilities are turned on.</h:td></h:tr>          
                <h:tr><h:td>FAU_WID_EXT.3</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.4</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>           
                <h:tr><h:td>FAU_WID_EXT.5</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.6</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>              
                <h:tr><h:td>FAU_WID_EXT.7</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WIP_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FDP_IFC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FMT_SMF.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FPT_FLS.1</h:td><h:td>Information about failure.</h:td><h:td>Indication that there was a failure, type of failure, device that failed, and time of failure.</h:td></h:tr>
                <h:tr><h:td>FPT_ITT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FTP_ITC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
              </h:table>
              <ctr id="auditWids" ctr-type="Table">: Auditable Events</ctr>            
            </title> 
            <note role="application">
              The auditable events defined in <ctr-ref refid="auditWids"/> are for the SFRs that are explicitly defined in this PP-Module and are intended to extend FAU_GEN.1 in the Base-PP. The events in the <ctr-ref refid="auditWids"/> should be combined with those of the ND cPP in the context of a conforming Security Target.<h:br/><h:br/>
              The Auditable Events (<ctr-ref refid="auditWids"/>) includes optional and objective SFRs. The auditing of optional and objective SFRs is only required if that SFR is included in the ST.  
            </note>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall perform the following test:<h:br/>
                The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate audit records in accordance with the assurance activities associated with the functional requirements in this PP-Module. When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the administrative guide, and that the fields in each audit record have the proper entries. <h:br/><h:br/>                
                Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. 
              </Tests>
            </aactivity> 
          </f-element>
        </f-component>  
                     
        <ext-comp-def title="Intrusion Detection Methods" fam-id="FAU_IDS_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_ids_ext.1" name="Intrusion Detection System – Intrusion Detection and Reporting Methods">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall provide the following methods of intrusion detection: 
              <selectables>
                <selectable id="anoBased">anomaly-based</selectable>
                <selectable id="sigBased">signature-based</selectable>
                <selectable>behavior-based</selectable>
                <selectable>hybrid</selectable>
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables>
            </title>
            <note role="application">
              At least one detection method must be selected. Based on the selection made in 
              this SFR, the following SFRs must also be included: <h:br/>
              If anomaly-based detection is selected: <linkref linkend="FAU_ANO_EXT.1"/> <h:br/>
              If signature-based detection is selected: <linkref linkend="FAU_SIG_EXT.1"/><h:br/><h:br/>
              A hybrid detection method is one that incorporates two or more detection methods (e.g., both anomaly and signature based or signature and 
              another method). If one of the detection methods in a hybrid solution includes either anomaly-based or signature-based detection methods, the
              corresponding selection based requirements must also be met.        
              <!-- Justin: Why do we need hybrid? Can't they just select all that applies or is hybrid something special? -->
              <!-- Lauren: No, we can remove hybrid. Either selection will satisfy the SFR from a technical standpoint. I removed the reverence to the hybrid solution in the aaactivity TSS. -->
             </note>
          </f-element>
<!-- NEW SFR -->
            <!-- Justin: Did you add testing?? 
                   Show capability exists - can we tie into another SFR EA?
              
               ** Lauren: Regarding testing, would just like to show capability exists here.
              <aactivity>	
              <TSS>
                The evaluator shall verify that the <abbr linkend="TSS"/> includes guidance on which intrusion detection technique(s) the <abbr linkend="TOE"/> utilizes. 
                If a hybrid intrusion detection is selected as the intrusion detection method, the <abbr linkend="TSS"/> should provide details on the detection techniques utilized. 
                If a proprietary vendor detection method is selected, technical details on the method must be provided.<h:br/><h:br/>
              </TSS>    
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to configure the <abbr linkend="TOE"/> in order for it to detect 
                such intrusions.<h:br/><h:br/>  
              </Guidance>            
              <Tests> 
                Depending on the detection technique used by the <abbr linkend="TOE"/>, the evaluator shall note the existence of the capability, detection technique used, and 
                test for the appropriate selection-based requirements.
              </Tests>             
            </aactivity>
            -->

             <f-element> 
               
            <title> The TSF shall provide <selectables linebreak="yes">
              <selectable>Syslog using <selectables>
                <selectable>defined API</selectable>
                <selectable>Syslog</selectable>        
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables></selectable>
              <selectable>SNMP trap reporting using <selectables>
              <selectable>defined API</selectable>
                <selectable>Simple Network Management Protocol (SNMP)</selectable>         
                <selectable><assignable>other detection method</assignable></selectable>
              </selectables></selectable>
            </selectables>.             
            </title>
            <note role="application">
              Syslog and/or SNMP trap reporting can be used. At least one reporting method must be selected. <!-- TODO: If SNMP is selected - then need to specify version number -->
             </note>
             </f-element>
<!-- NEW SFR -->
            <!-- Justin: Did we add testing?? -->  
          <!-- Import/export data post processing from WIDS controller
          Import/export configuration - management of sensor -->
             <f-element>
            <title> The TSF shall provide the ability to import data from the system: 
              <selectables>
                <selectable>custom API</selectable>
                <selectable>Syslog</selectable>
                <selectable><assignable>proprietary vendor detection method (e.g. Splunk)</assignable></selectable>
              </selectables>
            </title>
            <note role="application">
              The system shall provide the ability to interact with an extensible interface to a custom proprietary or third party  wireless monitoring system
              for the purposes of importing data from the wireless system. At least one detection method must be selected. 

            </note>  

            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes guidance on which intrusion detection technique(s) the TOE utilizes. If a hybrid intrusion detection is selected as the intrusion detection method, the TSS should provide details on the detection techniques utilized. Furthermore, when using a hybrid detection method that includes detection methods other than anomaly or signature based, the TSS shall include more details about such detection methods. <!-- TODO: FIX -->If proprietary vendor detection method is selected, technical details on the method must be provided.<h:br/><h:br/>
              </TSS>    
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to configure the TOE in order for it to detect 
                such intrusions.<h:br/><h:br/>  
              </Guidance>            

              <Tests> <!-- Updated test language to reflect the confirmation that the capability exists natively within the TOE -->
                Depending on the detection technique used by the <abbr linkend="TOE"/>, the evaluator shall confirm and note the existence of the capability, and 
                test for the appropriate selection-based requirements.

             <!--   <Tests> 
                Depending on the detection technique used by the TOE the evaluator shall note detection technique used and test 
                for the appropriate selection-based requirements.
             -->

              </Tests>             
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Environmental Inventory" fam-id="FAU_INV_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_inv_ext.1" name="Environmental Inventory">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall provide Authorized Administrators with the ability to define an inventory 
              of <h:i>[authorized APs and EUDs]</h:i> based on <h:i>[EUD MAC addresses, AP MAC addresses]</h:i>.
            </title>

            <note role="application">
              This inventory is used as a whitelist to indicate to the WIDS which APs and EUDs are legitimate members of the wireless network. The terminology used to describe an inventoried or whitelisted device may vary by vendor product. This PP-Module utilizes whitelisted to describe APs and EUDs that are part of the inventory and non-whitelisted to describe APs and EUDs that are not part of the inventory.
            </note>

            <aactivity>	
              <TSS>
                The evaluator shall review the TSS to verify that it includes information the ability of the TOE to define inventory of authorized APs and EUDs.<h:br/><h:br/> 
              </TSS>         
              <Guidance>
                The evaluator shall review the operational guidance for instructions on how to configure and change clasification of APs and EUDs to indicate that they are part of the whitelist.<h:br/><h:br/>  
              </Guidance>           
              <Tests> 
                The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  Deploy an AP and EUD that should be classified as authorized devices. <h:br/>
                  <test>
                    If the whitelist is configured automatically:
                    <h:ul>
                      <h:li>Check the list of whitelisted devices and verify that the list is correct. </h:li>
                      <h:li>Verify that the devices are classified as whitelisted. </h:li>
                      <h:li>Remove or reclassify a device from the inventory. </h:li>
                      <h:li>Verify that the device is not marked as whitelisted after removing or reclassifying. </h:li>
                    </h:ul>                  
                  </test>
                  <test>
                    If the set of authorized devices is configured manually:
                    <h:ul>
                      <h:li>Add an AP and EUD to the list. Record whether AP and EUD are displayed on the inventory. </h:li>
                      <h:li>Verify that the devices are classified as whitelisted in the list of whitelisted devices. </h:li>
                      <h:li>Remove the AP from the inventory. </h:li>
                      <h:li>Verify that the removed device does not appear in the inventory after removal.</h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title> The TSF shall detect the presence and current information of<h:i>[EUDs, APs]</h:i> in the Operational Environment that are part of the defined inventory.
            </title>
            <note role="Application">
              When referring to current information that should be detected by the TSF, it is referring to information about the detected AP or EUD as is observed by the 
              WIDS such as operating channel and band, SSID of an AP, client(s) connected to an AP, and the AP that an EUD is connected to. <linkref linkend="FAU_INV_EXT.2.3"/> has a full list of the details 
              about the AP or EUD that should be detected by the WIDS.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes how the presence of authorized EUDs and APs is presented by the TOE and what information about the devices is provided.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to view authorized APs and EUDs that are within range of the TOE sensors.<h:br/><h:br/> 
              </Guidance>           
              <Tests> The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy a whitelisted AP and EUD, and connect the EUD to the AP.</test>
                  <test>Verify that the list of detected APs and EUDs contains the whitelisted AP and EUD that were just deployed. </test>
                  <test>If the AP and EUD are detected verify that they are classified as whitelisted devices.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>         
          <f-element>
            <title> The TSF shall detect the presence and current information of <h:i>[EUDs, APs]</h:i> in the Operational Environment that are 
              not part of the defined inventory.
            </title>
            <note role="Application">When referring to current information that should be detected by the TSF, it is referring to information about the detected AP or EUD as is observed by the 
              WIDS such as operating channel and band, SSID of an AP, client(s) connected to an AP, and the AP that an EUD is connected to. <linkref linkend="FAU_INV_EXT.2.3"/> has a full list of the details 
              about the AP or EUD that should be detected by the WIDS.</note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes guidance on where in the WIDS interface the list of detected APs and EUDs is displayed.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to view unauthorized APs and EUDs that are within range of the TOE sensors.<h:br/><h:br/> 
              </Guidance>         
              <Tests> 
                The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>Deploy a non-whitelisted AP and EUD and connect the EUD to the AP.</test>
                  <test>Verify that the list of detected APs and EUDs contains the non-whitelisted AP and EUD that were just deployed.</test>
                  <test>If the AP and EUD are detected verify that they are not classified as whitelisted devices.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Characteristics of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_inv_ext.2" name="Characteristics of Environmental Objects">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect information on the current physical location of <h:i>[inventoried and malicious EUDs, APs]</h:i> within 
              <h:i>[range of the TOE’s wireless sensors]</h:i>.
            </title>
            <note role="application">
              This SFR only checks for the ability of the WIDS to track the location of APs and EUDs either by placing them on a map or providing the distance of the AP or EUD from the sensor but does not mandate a certain degree of accuracy. Objective requirement <linkref linkend="FAU_INV_EXT.4"/> is more stringent on the accuracy of the location tracking capabilities.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes information on location tracking, optimal number of sensors and sensor placement to meet the required level of accuracy.<h:br/><h:br/>  
              </TSS>          
              <Guidance>
                The evaluator shall review the operational guidance for instructions on how to configure location tracking and where in the TSF administrator interface the location of APs and EUDs can be viewed.<h:br/><h:br/> 
              </Guidance>          
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Verify that TSF is able to provide location information on the AP.</step>
                      <step>Verify that the location presented by the TSF appears within the range of the sensors.</step>
                    </steplist>                  
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title> The TSF shall detect <h:i>[received signal strength,</h:i> <selectables>
              <selectable>RF power levels above a predetermined threshold</selectable>
              <selectable>no other characteristics</selectable>
            </selectables>] of hardware operating within <h:i>[range of the TOE’s wireless sensors]</h:i>.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS contains information regarding the TSF’s ability to record signal strength of hardware operating within range of its sensors.<h:br/><h:br/> 
              </TSS>          
              <Guidance>
                If the option for detection of RF power levels above a predetermined threshold is selected, the evaluator shall use the operational guidance to set or check what the threshold is in a given test. The evaluator should also verify that the operational guidance provides instruction on how to configure the TOE to generate an alert when the threshold is exceeded.<h:br/><h:br/> 
              </Guidance>            
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Check the WIDS user interface for a list of detected APs and EUDs.</step>
                      <step>Verify that the current received signal strength is part of the information presented on the 
                        WIDS user interface about the APs and EUDs.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>   
            </aactivity>
          </f-element>
          <f-element>
            <title> The TSF shall detect the <h:i>current RF band, current channel, MAC Address, classification of APs and EUDs, </h:i> <assignable>other details</assignable> of 
              <h:i>[all APs and EUDs]</h:i> within <h:i>range of the TOE’s wireless sensors</h:i>. For <h:i>[APs]</h:i> the TOE shall detect the following additional details:
              <h:i>encryption, number of connected EUDs</h:i>. For <h:i>[EUDs]</h:i> the TOE shall detect the following additional details:
              <h:i>SSID and BSSID of AP it is connected to.</h:i> 
            </title>
            <note role="Application">For detection of encryption type, the TSF should be able to differentiate between the different WLAN encryption methods and when no encryption is in use.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS explains the capability of detecting the current RF band, current channel, MAC Address, classification of APs and EUDs within the TOE’s wireless range.<h:br/><h:br/> 
              </TSS>           
              <Guidance>
                The evaluator shall review the operational guidance in order to verify that there are instructions that show how to locate the device inventory mentioned above.<h:br/><h:br/> 
              </Guidance>            
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP, non-whitelisted AP and two whitelisted EUDs.</step>
                      <step>Connect one whitelisted EUD to the whitelisted AP and one to the non-whitelisted AP.</step>
                      <step>Check the WIDS user interface for a list of detected APs and EUDs.</step>
                      <step>Verify that current RF band, current channel, MAC Address, classification of device, are part of the information presented on the 
                        WIDS user interface for all the APs and EUDs detected. For APs verify that encryption, number of connected EUDs is presented.
                        For EUDs verify that the SSID and BSSID of AP it is connected is presented.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Behavior of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component  id="fau_inv_ext.3" name="Behavior of Environmental Objects">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title>
              The TSF shall detect when <h:i>[inventoried EUDs]</h:i> exhibit the following behavior: An EUD establishes a peer-to-peer connection with any other EUD.
                  <selectables>
                    <selectable>An EUD bridges two network interfaces</selectable>
                    <selectable>An EUD uses internet connection sharing</selectable>
                    <selectable>other connection types</selectable>
                    <selectable>no other connections</selectable>
                  </selectables>               
            </title>
            <note role="Application">For this requirement, it is acceptable for the WIDS to use a generic terms for bridges or peer-to-peer connections when
              generating an alert for the detection of different types of bridges or peer-to-peer connections. The type of connection does not have to be specific. </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to detect the network behavior described by the SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall review the operational guidance to verify that it provides instructions on how alerts are presented to the administrator as well as information regarding the format of each alert.<h:br/><h:br/> 
              </Guidance>             
              <Tests> 
                The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <h:br/>
                    Create the following connections between two whitelisted EUDs. 
                        <h:ul>
                          <h:li>Windows Ad Hoc Connection</h:li>
                          <h:li>Mac OS Ad Hoc</h:li>
                          <h:li>Linux Ad Hoc</h:li>
                          <h:li>Wi-Fi Direct</h:li>
                        </h:ul>
                    <h:br/>
                  </test>
                  <test>
                    Create the following connections between one whitelisted EUD and a non-whitelisted EUD 
                    <h:ul>
                      <h:li>Windows Ad Hoc Connection</h:li>
                      <h:li>Mac OS Ad Hoc</h:li>
                      <h:li>Linux Ad Hoc</h:li>
                      <h:li>Wi-Fi Direct</h:li>
                    </h:ul>
                  </test>
                  <test>(Optional)
                    Bridge two network interfaces on a whitelisted EUD (one must be the wireless card listed as whitelisted).                    
                  </test>
                  <test>
                    <h:ul>
                      <h:li>Create a Windows Hosted Network with a whitelisted EUD. </h:li>
                      <h:li>Connect a different whitelisted EUD to the network.</h:li>
                    </h:ul>
                  </test>
                </testlist>
                  Verify that alerts were generated by each of the connections in each test. Provide a description of the alert.             
              </Tests>
            </aactivity>
          </f-element>
        </f-component>

        <f-component  id="fau_saa.1" name="Potential Violation Analysis">
        <consistency-rationale></consistency-rationale>
          <f-element>
            <title>The TSF shall be able to apply a set of rules for monitoring the <h:b>wireless traffic</h:b> and based 
              upon these rules indicate a potential <h:b>malicious action</h:b>.
            </title>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                There are no tests for this SFR, testing detection of potential malicious events is tested through the ability to detect
                intrusions in other SFRs.
              </Tests>             
            </aactivity>
          </f-element>
          <f-element>
            <title>The TSF shall enforce the following rules for monitoring wireless traffic:
              <h:ol type="a">
                <h:li>Accumulation or combination of [assignment: subset of defined auditable events] known to indicate a 
                potential security violation;
                </h:li>
                <h:li><h:i>[other potential security violations as defined by <ctr-ref refid="SecViolations"/>]</h:i>.</h:li>
              </h:ol>
              <h:table>
                <h:tr class="header">
                  <h:td>SFR</h:td>
                  <h:td>Potential Security Violation.</h:td>
                </h:tr>
                <h:tr>
                  <h:td><linkref linkend="FAU_INV_EXT.3"/></h:td>
                  <h:td>Detection of authorized EUD establishing peer-to-peer connection with any other EUD.</h:td>
                </h:tr>
                <h:tr>
                  <h:td><linkref linkend="FAU_INV_EXT.3"/></h:td>
                  <h:td>Detection of EUD bridging two network interfaces.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.1"/></h:td>
                  <h:td>Detection of rogue AP.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.1"/></h:td>
                  <h:td>Detection of malicious EUD.</h:td>
                </h:tr>                
                 <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.2"/></h:td>
                  <h:td>Detection of traffic with excessive transmit power level.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.2"/></h:td>
                  <h:td>Detection of active probing.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.2"/></h:td>
                  <h:td>Detection of MAC spoofing.</h:td>
                </h:tr>     	
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.3"/></h:td>
                  <h:td>Detection of RF-based denial of service.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.3"/></h:td>
                  <h:td>Detection of deauthentication flooding.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.3"/></h:td>
                  <h:td>Detection of disassociation flooding.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.3"/></h:td>
                  <h:td>Detection of request-to-send/clear-to-send abuse.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.4"/></h:td>
                  <h:td>Detection of unauthorized authentication scheme use.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.5"/></h:td>
                  <h:td>Detection of unauthorized encryption scheme use.</h:td>
                </h:tr>                
                <h:tr>
                  <h:td><linkref linkend="FAU_WID_EXT.5"/></h:td>
                  <h:td>Detection of unencrypted traffic.</h:td>
                </h:tr>
              </h:table>
              <ctr id="SecViolations" ctr-type="Table">: Potential Security Violations</ctr>
            </title>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                There are no tests for this SFR, testing of monotoring capabities is tested through the ability to detect
                intrusions in other SFRs.
              </Tests>          
            </aactivity>
          </f-element>
        </f-component>
              
        <ext-comp-def title="Malicious Environmental Objects" fam-id="FAU_WID_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_wid_ext.1" name="Wireless Intrusion Detection – Malicious Environmental Objects">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall apply <assignable>user-defined, automatic</assignable> classification rules to detect the following 
              types of malicious environmental objects: <h:i>[rogue APs]</h:i>.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes how the TOE can detect rogue APs and whether this behavior is configurable.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall review the operational guidance for instructions on how to configure user-defined classification rules, if supported.<h:br/><h:br/> 
              </Guidance>    
              <Tests> 
                The evaluator shall perform configure an AP classifcation rule, then perform the following test:<h:br/>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Deploy an AP following the user-defined classification rule.</h:li>
                      <h:li>Verify that the AP gets correctly classified.</h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title> The TSF shall distinguish between benign and malicious <h:i>[APs, EUDs]</h:i> based on 
              <h:i>[automatic detection metrics]</h:i>.
            </title>
            <aactivity>	
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>          
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>           
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Deploy a non-whitelisted AP in the area of the WIDS sensor but take no action against the network.</h:li>
                      <h:li>Deploy a non-whitelisted AP in the area of the WIDS sensor and connect it to the internal wired infrastructure (optional for overlay WIDS).</h:li>
                      <h:li>Connect a whitelisted EUD to a non-whitelisted AP. </h:li>
                      <h:li>Connect a non-whitelisted EUD to a whitelisted AP.</h:li>
                      <h:li>Launch an attack against authorized AP with an unauthorized EUD.</h:li>
                    </h:ul>
                  </test>
                  For each step above verify that the TSF detects APs and EUDs and that they are classified appropriately.
               </testlist> 
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
  
        <ext-comp-def title="Passive Information Flow Monitoring" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.2" name="Wireless Intrusion Detection – Passive Information Flow Monitoring">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title>
              The TSF shall monitor and analyze 
              <selectables>
                <selectable>simultaneously monitor and analyze</selectable>
                <selectable>no other behavior</selectable>
              </selectables> network traffic matching the <h:i>[802.11 monitoring SFP]</h:i> for all channels in the following RF Frequencies:
               2.4 GHz and 4.9/5.0 GHz 
              <selectables>
                 <selectable>channels outside regulatory domain</selectable>
                 <selectable>non-standard channel frequencies</selectable>
                 <selectable>no other domains</selectable>
               </selectables>.
            </title>
            <note role="Application">
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in <linkref linkend="FDP_IFC.1"/> and defined through <linkref linkend="FAU_WID_EXT"/> SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.</note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes information on the channels the TSF can detect.<h:br/><h:br/> 
              </TSS>          
              <Guidance>
                The evaluator shall review the operational guidance for the channels that the TSF is able to monitor and how to configure 
                the TSF to monitor the channels as selected in the SFR.  Depending on the channel dwelling times implemented by the vendor it might 
                take a while for the detection of devices. <h:br/><h:br/> 
              </Guidance>         
              <Tests> 
                The evaluator shall perform the following tests:<h:br/>
                <testlist>
                  <test>
                    Channels on On 5GHz band
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels within the regulatory domain on 5GHz band.</step>
                      <step>Deploy AP on at least 2 different channels outside the regulatory domain on 5GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>               
                  <test>
                    Channels on 2.4GHz band
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels within the regulatory domain on 2.4GHz band.</step>
                      <step>Deploy AP on at least 2 different channels outside the regulatory domain on 2.4GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>                
                  <test>
                    Non-standard channel frequencies
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels on non-standard channel frequencies.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>                 
                </testlist>
              </Tests>                       
            </aactivity>
          </f-element>
          <f-element>
            <title> 
              The TSF shall provide wireless sensors to detect network traffic matching the <h:i>[802.11 monitoring SFP]</h:i> that 
              <selectables>
                <selectable>can be configured to prevent transmission of data</selectable>
                <selectable>does not transmit data</selectable>
              </selectables>.
            </title>
            <note role="application">
              The intent of this SFR is to employ WIDS sensors that can have all wireless transmission capabilities disabled for instances where a site wishes to implement a no wireless policy. <h:br/>
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in <linkref linkend="FDP_IFC.1.1"/> and defined through <linkref linkend="FAU_WID_EXT"/> SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes information on how to configure the sensors as completely passive. Specifically, the TSS shall indicate whether the TOE can configured as a dedicated sensor with prevention disabled, or, if the sensor transmits data even with no prevention capabilities are enabled, how to disable wireless transmissions.<h:br/><h:br/> 
              </TSS>            
              <Guidance>
                Specifically, the TSS shall indicate whether the TOE can configured as a dedicated sensor with prevention disabled, or, if the sensor transmits data even with no prevention capabilities are enabled, how to disable wireless transmissions. <h:br/><h:br/> 
              </Guidance>        
              <Tests> 
                If the TOE provides the ability to disable wireless transmission, the evaluator shall follow the operational guidance to configure the sensor 
                to not transmit wirelessly. The evaluator shall then deploy a signal analyzer in order to check for wireless emanations from the TOE.<h:br/>
                The evaluator shall then perform the following tests:<h:br/>               
                Deploy a signal analyzer and configure on the bands specified in the tests below.
                <h:b>On 2.4 GHz band</h:b> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Boot a sensor and using the signal analyzer observe to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the sensor.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>During normal sensor operations, observe the analyzer for about 10 minutes to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the sensor.</step>
                    </steplist>
                  </test>
                </testlist>             
                 <h:b>On 5GHz band</h:b> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Boot a sensor and using the signal analyzer observe to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the sensor.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>During normal sensor operations, observe the analyzer for about 10 minutes to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the sensor.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title> 
              The TSF shall provide the ability to define a subset of <h:i>[SSID(s)]</h:i> as authorized.
            </title>
            <note role="application">
              The administrator should have the ability to configure which SSIDs are permitted on the network. </note>
            <aactivity>	
              <TSS>
                No TSS assurance activity specified.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the TSS includes instructions on how to set the allowed SSIDs.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                The evaluator shall configure the TSF with a set of authorized channels and SSIDs. The ability to detect violation of this policy will be tested in <linkref linkend="FAU_WID_EXT.2.4"/>.</Tests>             
            </aactivity>
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect the presence of unauthorized traffic on the network through the following methods: [
              <h:ul>
                <h:li>detection of unauthorized APs broadcasting authorized SSIDs,</h:li>
                <h:li>detection of APs and EUDs spoofing the MAC address of whitelisted APs and EUDs,</h:li>
                <h:li>detection of authorized EUDs associating to unauthorized SSIDs,</h:li>
                <h:li>detection of unauthorized EUDs associating to authorized APs,</h:li>
                <h:li>detection of unauthorized point to point wireless bridges by whitelisted APs,</h:li>
                <h:li>detection of active probing,</h:li>
                <h:li>
                  <selectables>
                    <selectable>illegal state transitions</selectable>
                    <selectable>protocol violations 
                      <selectables>
                        <selectable>802.11</selectable>
                        <selectable>802.1X</selectable>
                        <selectable><assignable>proprietary vendor protocol(s)</assignable></selectable>
                      </selectables>
                    </selectable>
                    <selectable>no other methods.</selectable>
                  </selectables>
                  ]
                </h:li>
              </h:ul>
            </title>
            <note role="application">
              “Authorized” EUDs/APs are those that are assigned to the whitelist as 
              defined by <linkref linkend="FAU_INV_EXT.1"/>. Detection of illegal state transitions and protocol violations are 
              objective requirements and will be mandatory in future PP versions.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the methods that the TOE uses to detect the presence of unauthorized connections and unauthorized network traffic.<h:br/><h:br/> 
              </TSS>            
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to configure SSIDs as authorized.<h:br/><h:br/> 
              </Guidance>         
              <Tests> 
                The evaluator shall configure the TSF with a set of authorized SSIDs and perform the following tests:<h:br/>
                <testlist>
                  <h:b>Unauthorized SSID, Unauthorized Connections - 2.4 GHz band</h:b>
                  <test>
                    <steplist>
                      <step>Configure a whitelisted AP to operate on a set channel on the 2.4 GHz band with an authorized SSID. </step>
                      <step>Connect a non-whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the non-whitelisted EUD connecting to the whitelisted AP.</step>
                      <step>Change the AP's SSID to one not on the authorized list.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the whitelisted AP using unauthorized SSID
                        and the EUD associating to an unauthorized SSID.</step>
                    </steplist>
                  </test><h:br/>                      
                  <h:b>Unauthorized SSID, Unauthorized Connections - 5 GHz band</h:b>
                  <test>
                    <steplist>
                      <step>Configure a whitelisted AP to operate on a set channel on the 5 GHz band with an authorized SSID. </step>
                      <step>Connect a non-whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the non-whitelisted EUD connecting to the whitelisted AP.</step>
                      <step>hange the AP's SSID to one not on the authorized list.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the whitelisted AP using unauthorized SSID
                        and the EUD associating to an unauthorized SSID.</step>
                    </steplist>
                  </test><h:br/>    
                </testlist>           
                <testlist>
                  <h:b>MAC Spoofing</h:b>
                  <test>
                    <h:ul>
                      <h:li>Spoof mac address of whiteliste EUD connected to a whitelisted AP on a second EUD. </h:li>
                      <h:li>Connect EUD with spoofed MAC address to another whitelisted AP while the valid EUD it is spoofing 
                        is connected to the first AP. </h:li>
                      <h:li>Verify that the TSF detected the MAC spoofing.</h:li>
                    </h:ul>          
                  </test>          
                  <test>
                    <h:ul>
                      <h:li>Spoof mac address of whiteliste AP on a second AP. </h:li>
                      <h:li>Verify that the TSF detected the MAC spoofing.</h:li>
                    </h:ul>          
                  </test> 
                </testlist>              
                <testlist>
                  <h:b>Active Probing</h:b>
                  <test>
                    <h:ul>
                      <h:li>Perform an active scan on the subnet of the WLAN.</h:li>
                      <h:li>Record tools used and type of scan performed. Verify that the TSF detects the active probing.</h:li>
                    </h:ul>          
                  </test>                 
                </testlist>               
                <testlist>
                  <h:b>Point-to-Point Wireless Bridges</h:b>
                  <test>
                    <h:ul>
                      <h:li>Setup a point-to-point wireless bridge using whitelisted APs in the range of the wireless sensors.</h:li>
                      <h:li>Verift that the TSF detects the bridge.</h:li>
                    </h:ul>          
                  </test>                 
                </testlist>
              </Tests>             
            </aactivity>
          </f-element>

<!-- NEW SFRs -->
            <f-element> 
             <title> 
             The TSF shall perform stateful frame inspection and log attacks spanning multiple frames. 
             </title> 
             <note role="application">
               Attackers possess the capability to distribute an attack across multiple frames in an attempt to avoid traditional detection measures that solely focus 
             on packet headers. Stateful frame inspection will allow for the identification of obfuscation techniques centered around spreading an attack across multiple frames. Detection of 
             illegal state transitions and protocol violations are objective requirements and will be mandatory in future PP versions. 
             </note>
             <aactivity>	
              <TSS>
              </TSS>
              <Guidance>
                The TOE shall have the ability to perform stateful frame inspection and log attacks spanning multiple frames. The evaluator shall verify that the operational guidance provides instructions on how to specify and confirm that stateful frame capture and inspection is being performed.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <h:b>Stateful Frame Inspection</h:b>
                  <test>
                    <h:ul>
                      <h:li>Deploy whitelisted AP.</h:li>
                      <h:li>Connect a whitelisted EUD to the AP.</h:li>
                      <h:li>Deploy a protocol analyzer (e.g. Wireshark) or native capability within the WIDS Controller between the AP and EUD.</h:li>
                      <h:li>Verify from the network traffic packet capture that all frames are being inspected to validate their connection state from the TSF</h:li>
                    </h:ul>          
                  </test>                 
                 </testlist>
             </Tests>  
             </aactivity>
             </f-element>
<!-- NEW SFR -->
            
           <!--Add to FAU_SAA.1.2-->
          <f-element> 
             <title> 
               The TSF shall detect a violation in allowing NULL SSID associations. 
             </title> 
             <note role="application">
               The 802.11 standard allows APs to beacon with the SSID field set to null. This is referred to as a hidden or cloaked SSID. The client seeking to associate with an AP using a hidden SSID must first send out a Probe 
               Request that contains the SSID of that network, then the AP will return with a Probe Request of its own. 
               The TSF needs to be able to detect if an AP is allowing clients to associate without providing the valid SSID of the AP. 
             </note>
             <aactivity>	
              <TSS>
                
              </TSS>
              <Guidance>
                The TOE shall have the ability to perform stateful frame inspection and log attacks spanning multiple frames. The evaluator shall verify that 
                the operational guidance provides instructions on how to specify and confirm that stateful frame capture and inspection is being performed.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <h:b>NULL Client Associations</h:b>
                  <test>
                    <h:ul>
                      <h:li>Deploy whitelisted AP.</h:li>
                      <h:li>Configure the AP to have null SSID.</h:li>
                      <h:li>Attempt to connect a whitelisted EUD to the AP without supplying the correct AP SSID.</h:li>
                      <h:li>Verify that the AP does not permit the EUD to complete an association by returning a Probe Request.</h:li>
                      <h:li>If an association does occur, confirm that an alert is triggered due to a violation of policy.</h:li>
                    </h:ul>          
                  </test>                 
                 </testlist>
             </Tests>  
             </aactivity>
             </f-element>     
        </f-component>   
        
        <ext-comp-def title="Denial of Service" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.3" name="Wireless Intrusion Detection – Denial of Service">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect the following intrusions: 
              RF-based denial of service, deauthentication flooding, disassociation flooding, <assignable>other DoS methods</assignable>, 
                <selectables>
                  <selectable>request-to-send/clear-to-send abuse</selectable>
                  <selectable>no other DoS methods</selectable>
                </selectables>
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall examine the TSS to verify that it describes the denial of service attacks that can be detected by the TOE.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                If the ability of the TOE to detect different types of denial of service attacks is configurable, the evaluator shall verify that 
                the operational guidance provides instructions on how to specify the attack(s) that are detected.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <h:b>RF-based DoS</h:b>
                  <test>
                    <h:ul>
                      <h:li>Deploy whitelisted AP and configure to stay in a particular channel.</h:li>
                      <h:li>Connect a whitelisted EUD to the AP.</h:li>
                      <h:li>Use an RF Jammer or signal generator on the same frequency as the AP and EUD to create a DoS.</h:li>
                      <h:li>Verify that the TSF detects the RF-based DoS.</h:li>
                    </h:ul>          
                  </test>                 
                </testlist>
                <testlist>
                  <h:b>Traffic injection based DoS</h:b>
                  <test> <h:b>Deauthentication Flood</h:b>
                    <h:ul>
                      <h:li>Deploy whitelisted AP and configure to a set channel.</h:li>
                      <h:li>Connect a whitelisted EUD to the AP.</h:li>
                      <h:li>Send an flood of deauthentication frames to the EUD using the MAC address of whitelisted AP it is connected to.</h:li>
                      <h:li>Verify that the TSF detects the deauthentication flood.</h:li>
                      <h:li>Send an flood of deauthentication frames with the MAC address of whitelisted AP as the source and destination as a broadcast.</h:li>
                      <h:li>Verify that the TSF detects the deauthentication flood.</h:li>             
                    </h:ul>          
                  </test>
                  <test> <h:b>Dissasociation Flood</h:b>
                    <h:ul>
                      <h:li>Deploy whitelisted AP and configure to a set channel.</h:li>
                      <h:li>Connect two whitelisted EUDs to the AP.</h:li>
                      <h:li>Send an flood of CTS frames to reserve RF medium.</h:li>
                      <h:li>Verify that the TSF detects the CTS abuse.</h:li>
                    </h:ul>          
                  </test> 
                </testlist>
              </Tests>           
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Unauthorized Authentication Schemes" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.4" name="Wireless Intrusion Detection – Unauthorized Authentication Schemes">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> 
              The TSF shall provide Authorized Administrators the ability to define authorized WLAN authentication schemes.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to allow authorized administrators to define authorized WLAN authentication schemes.<h:br/><h:br/> 
              </TSS>            
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it provides instructions on how to define a WLAN authentication 
                scheme as authorized or unauthorized for the purposes of detection.<h:br/><h:br/> 
              </Guidance>            
              <Tests>
                The evaluator shall configure the TSF with a set of authorized WLAN authentication schemes. The ability to detect violation of this policy will be tested in <linkref linkend="FAU_WID_EXT.4.2"/>.<h:br/><h:br/> 
              </Tests>             
            </aactivity>
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect when <h:i>[whitelisted APs and EUDs defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> attempt to use WLAN authentication 
              schemes that are not authorized.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized WLAN authentication schemes are used.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>          
              <Tests> 
                The evaluator shall configure the TSF with 802.1x authentication as the only mode of authorized WLAN authentication schemes and perform the following tests:<h:br/>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Deploy a whitelisted AP with open authentication.</h:li>
                      <h:li>Connect a whitelisted EUD to AP. </h:li>
                      <h:li>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes. </h:li>
                      <h:li>Deploy a whitelisted AP that uses pre-shared key authentication.</h:li>
                      <h:li>Connect a whitelisted EUD to AP. </h:li>
                      <h:li>Verify that the TSF detects the AP and the EUD using unauthorized authentication schemes. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>          
        
        <ext-comp-def title="Unauthorized Encryption Schemes" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.5" name="Wireless Intrusion Detection – Unauthorized Encryption Schemes">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> 
              The TSF shall provide Authorized Administrators the ability to define authorized WLAN encryption schemes.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to allow authorized administrators to define authorized WLAN encryption schemes.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it provides instructions on how to define a 
                WLAN encryption scheme as authorized or unauthorized for the purposes of detection.<h:br/><h:br/> 
              </Guidance>             
              <Tests>
                The evaluator shall configure the TSF with a set of allowed encryption schemes. The ability to detect violation
                of this policy will be tested in <linkref linkend="FAU_WID_EXT.5.2"/>.
              </Tests>       
            </aactivity>
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect when <h:i>[whitelisted APs and EUDs defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> attempt to use WLAN encryption schemes that are not authorized.</title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized WLAN encryption schemes are used.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>             
              <Tests> 
                The evaluator shall configure the TSF with 128 bit AES encryption type as the only allowd encryption scheme 
                and perform the following test:<h:br/>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Deploy a whitelisted AP with no encryption.</h:li>
                      <h:li>Connect a whitelisted EUD to AP. </h:li>
                      <h:li>Verify that the TSF detects the AP and the EUD using unauthorized encryption schemes. </h:li>
                      <h:li>Deploy a whitelisted AP that uses TKIP encryption only.</h:li>
                      <h:li>Connect a whitelisted EUD to AP. </h:li>
                      <h:li>Verify that the TSF detects the AP and the EUD using unauthorized encryption schemes. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>          
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect when <h:i>[whitelisted APs and EUDs defined in <linkref linkend="FAU_INV_EXT.1.1"/>]</h:i> send or receive unencrypted data.
            </title>
            <note role="application">
              When referring to unencrypted data being received by a whitelisted AP or EUD it refers to unencrypted data 
              being sent to a whitelisted AP or EUD from either a non-whitelisted or whitelisted AP or EUD.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the ability of the TOE to detect when unauthorized APs and EUDs
                send or receive unencrypted data. <h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                  <h:ul>
                    <h:li>Deploy a whitelisted AP with no encryption.</h:li>
                    <h:li>Connect a whitelisted EUD to AP and generate traffic.</h:li>
                    <h:li>Verify that the TSF detects unencrypted data frames being sent between the whitelisted AP and EUD.</h:li>
                    <h:li>Connect a non-whitelisted EUD to AP and generate traffic.</h:li>
                    <h:li>Verify that the TSF detects unencrypted data frames being sent between the whitelisted AP and non-whitelisted EUD.</h:li>
                  </h:ul>
                  </test>
                  <test>
                    <h:ul>
                      <h:li>Deploy a non-whitelisted AP with no encryption.</h:li>
                      <h:li>Connect a whitelisted EUD to AP and generate traffic.</h:li>
                      <h:li>Verify that the TSF detects unencrypted data frames being between the non-whitelisted AP and whitelisted EUD.</h:li>
                    </h:ul>
                  </test>
               </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>      
      </subsection>  
      <subsection title="User Data Protection (FDP)" id="fdp">
        <f-component id="fdp_ifc.1" name="Information Flow Control Policy">
          <consistency-rationale></consistency-rationale>
          <f-element>
            <title> 
              The TSF shall enforce the <h:i>[802.11 monitoring SFP]</h:i> for <h:i>[all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <h:ul>
                <h:li><h:i>authorized APs and authorized EUDs </h:i></h:li>
                <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                <h:li><h:i>unauthorized APs and authorized EUDs</h:i>].</h:li>
              </h:ul>     
            </title>
            <note role="application">“Authorized” EUDs/APs are those that are assigned to the whitelist as defined by <linkref linkend="FAU_INV_EXT.1.1"/>. 
              <h:br></h:br>
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in <linkref linkend="FDP_IFC.1"/> and defined through <linkref linkend="FAU_WID_EXT"/> SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                If this functionality is configurable, the evaluator shall verify that the operational guidance provides instructions on how to configure the TOE to monitor different types of IEEE 802.11 frame types and subtypes.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Set the WIDS sensor for a set channel</h:li>
                      <h:li>Start a traffic capture from the WIDS sensor</h:li>
                      <h:li>Send a set number of frames on the channel the sensor's operating channel for all IEEE 802.11 a, b, g, n, ac frame types and subtypes from/to the following:
                        <h:ol>
                          <h:li><h:i>authorized APs and authorized EUDs</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs</h:i></h:li>
                        </h:ol>]   
                      </h:li>
                      <h:li>
                        Verify that there are frames from all the types and subtypes in the capture.
                      </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>      
     <subsection title="Security Management (FMT)" id="fmt" >
       <f-component id="fmt_smf.1(wids)" name="Specification of Management Functions (WIDS)">
         <consistency-rationale></consistency-rationale>
         <f-element>
           <title> 
             The TSF shall be capable of performing the following management functions for WIDS functionality: 
             [<h:i>management functions listed in <ctr-ref refid="mgmt"/></h:i>].        
             <h:table>
               <h:tr>
                 <h:td>SFR</h:td>
                 <h:td>Management Function</h:td>
               </h:tr>
               <h:tr>
                 <h:td><linkref linkend="FAU_ANO_EXT.1"/></h:td>
                 <h:td>Specification of periods of network activity that constitute baseline of expected behavior (optional).</h:td>
               </h:tr>
             </h:table>
             <ctr id="mgmt" ctr-type="Table">: Management Functions</ctr>
           </title>
           <aactivity>
             <TSS>
               The evaluator shall verify that the TSS describes how the baseline can be configured.<h:br/><h:br/> 
             </TSS>
             <Guidance>
               The evaluator shall verify that the operational guidance describes the instructions for 
               defining a baseline.<h:br/><h:br/> 
             </Guidance>
             <Tests> 
               The evaluator shall perform the following test:<h:br/>
               <testlist>
                 <test>Following the instructions in the operatinal guidance verify that the period of network activity that constitutes 
                   a baseline can indicated in the TSF. </test>
               </testlist>
             </Tests>              
           </aactivity>
         </f-element>         
       </f-component>
     </subsection>  
    </man-sfrs>
    <opt-sfrs>    
      <subsection title="Security Audit (FAU)" id="fau">
        <ext-comp-def title="Wireless Spectrum Monitoring" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.6" name="Wireless Intrusion Detection – Wireless Spectrum Monitoring">
        <consistency-rationale></consistency-rationale>
        <comp-lev></comp-lev>
        <management></management>
        <audit></audit>
        <dependencies></dependencies>
        <f-element>
          <title> 
            The TSF shall detect the presence of network devices that operate in the following RF bands: 
            <selectables>
              <selectable>3.6 GHz</selectable>
              <selectable>60 GHz</selectable>
              <selectable>sub-GHz (0-900 MHz)</selectable>
              <selectable id="cell">all cellular bands</selectable>
            </selectables>
          </title>
          <note role="application">
            This SFR refers to Non-Wi-Fi (IEEE 802.11 a, b, g, n, and ac) network devices that operate 
            in the specified frequencies. If the ST author selects detection of devices in the cellular bands, <linkref linkend="FAU_INV_EXT.4.1"/> must be included in the ST. 
          </note>
          <aactivity>	
            <TSS>
              The evaluator shall verify that the TSS includes the set of RF bands and technologies that the TSF can detect the use of. The TSS should also include instructions on how to enable and the hardware that is necessary for the additional band detection. <h:br/><h:br/> 
            </TSS>          
            <Guidance>
              The evaluator shall verify that the operational guidance describes how to enable and configure detection of the 
              technologies included in the ST as well as the hardware that is needed to perform this function.<h:br/><h:br/> 
            </Guidance>
            <Tests>
              The evaluator shall enable and configure detection of the selected technologies.
              <testlist>
                <test>Deploy a device within the given technology and verify that the TSF detects the device.</test>
              </testlist>               
            </Tests>            
          </aactivity>
        </f-element>
        <!-- Justin: Did we add this SFR? -->
          <!-- Should this be two different components so that they can be added individually? How do these two elements fit together?  -->
          <!-- Lauren: We didn't add this SFR, but I do see this as two seperate components. A special sensor dedicated to spectrum analysis significatntle differs from RF detection/presense.-->
          <f-element>
          <title> 
            The TSF shall provide a dedicated sensor for wireless spectrum analysis.
          </title>
          <aactivity>	
            <TSS>
              The evaluator shall verify that the TSS to verify that the TOE provides a dedicated sensor for wireless spectrum analysis.<h:br/><h:br/> 
            </TSS>      
            <Guidance>
              The evaluator shall verify that the operational guidance describes how to enable and configure dedicated spectrum analysis as well as 
              the hardware that is needed to perform this function.<h:br/><h:br/> 
            </Guidance>
            <Tests>
              The evaluator shall enable and configure dedicated spectrum analysis and test the capabilities listed in the TSS.
            </Tests>
          </aactivity>
        </f-element>
      </f-component>
      </subsection>     
    </opt-sfrs>
    <sel-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        <ext-comp-def title="Anomaly-Based Intrusion Detection" fam-id="FAU_ANO_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_ano_ext.1" name="Anomaly-Based Intrusion Detection">
          <selection-depends req="fau_ids_ext.1.1" ids="anoBased"/> 
          <consistency-rationale></consistency-rationale>          
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>        
          <f-element>
            <title> The TSF shall support the definition of 
              <selectables>
                <selectable>baselines (‘expected and approved’)</selectable>
                <selectable>anomaly (‘unexpected’) traffic patterns</selectable>
              </selectables>including the specification of 
              <selectables linebreak="yes">
                <selectable>throughput ([assignment: data elements (e.g. bytes, packets, etc.) per time period (e.g. minutes, 
                  hours, days)])</selectable> <!-- Justin: does this cover the bandwidth thing that was identified in the gap analysis? -->
                <selectable>time of day</selectable>
                <selectable>frequency; </selectable>
                <selectable>thresholds</selectable>
                <selectable><assignable>other methods</assignable></selectable>
              </selectables>  
              and the following network protocol fields: 
              <h:ul>
                <h:li>all management and control frame header elements </h:li>
              </h:ul>             
            </title>
          </f-element>
          <f-element>
            <title> 
              The TSF shall support the definition of anomaly activity through 
              <selectables>
                <selectable>manual configuration by administrators</selectable>
                <selectable>automated configuration</selectable>
              </selectables>. 
            </title>
            <note role="application">
              The “baseline” and “anomaly” can be something manually defined/configured by a TOE administrator (or importing definitions), or something that the TOE is able to automatically define/create by inspecting network traffic over a period of time (a.k.a. “profiling”). 
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the composition and construction of baselines or anomaly-based attributes specified in the SFR. The evaluator shall verify that the TSS provides a description of how baselines are defined and implemented by the TSF, or a description of how anomaly-based rules are defined and configured by the administrator. <h:br/><h:br/> 
                
                The evaluator shall verify that the TSS describes the available modes of configuration (manual or automatic) and how to configure or import the baseline.<h:br/><h:br/> 
              </TSS>                    
              <Guidance>
                The evaluator shall verify that the operational guidance describes how to configure baseline and/or anomalous traffic patterns based on what is stated in the TSS.<h:br/><h:br/> 
                The evaluator shall verify that the operational guidance describes how to perform automatic and/or manual definition of anomaly activity based on what is selected in the ST.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                The evaluator shall use the instructions in the operational guidance to configure baselines or anomaly-based rules through automated and/or manual means based on what is selected in the ST. The evaluator shall send traffic that does not match the baseline or matches the anomaly-based rule and verify the TSF detects the anomalous behavior and generates an alert.              
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
<!-- Kevin: Need to allow component id to have / in it -->
<!-- Justin: Is there really a need to allow a different range of accuracy for locating a device using cellular versus Wi-Fi? FAU_INV_EXT.4 states a 15 feet range to locate APs and EUDs -->        
        <ext-comp-def title="Location of Environmental Objects (Cellular Devices)" fam-id="FAU_INV_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_inv_ext.4(cell)" name="Location of Environmental Objects (Cellular Devices)">        
        <selection-depends req="fau_wid_ext.6.1" ids="cell"/>
        <consistency-rationale></consistency-rationale>
        <comp-lev></comp-lev>
        <management></management>
        <audit></audit>
        <dependencies></dependencies>
        <f-element>
          <title> 
            The TSF shall detect the physical location of cellular devices to within 
            <assignable>distance degree of accuracy</assignable> of their actual location.
          </title>
          <aactivity>	
            <TSS>
              The evaluator shall verify that the TSS includes information on the TOE’s ability to detect the 
              physical location of cellular devices.<h:br/><h:br/> 
            </TSS>            
            <Guidance>
              The evaluator shall review the operational guidance for instructions on how to configure location tracking, how to 
              load a location map (if applicable), and where in the TSF administrator interface the location of devices can be viewed.<h:br/><h:br/> 
            </Guidance>             
            <Tests> 
              The evaluator shall perform the following tests:<h:br/>
              <testlist>
                <test>
                  <steplist>
                    <step>Deploy a cellular device within range of the sensors.</step>
                    <step>Verify that the TSF is able to track the  location of the device.</step>
                    <step>Verify the level of accuracy indicated by the TSF falls within the one indicated in the assignment.</step>
                  </steplist>
                </test>
              </testlist>
            </Tests>
          </aactivity>
        </f-element>
      </f-component>
      
        
        <ext-comp-def title="Signature-Based Intrusion Detection" fam-id="FAU_SIG_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_sig_ext.1" name="Signature-Based Intrusion Detection">
          <selection-depends req="fau_ids_ext.1.1" ids="sigBased"/> 
          <consistency-rationale></consistency-rationale>          
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies> 
          <f-element>
            <title> 
              The TSF shall support user-defined and customizable attack signatures.
            </title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the user-defined and customizable attack signatures that the TOE can define.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance provides information on how to configure user-defined and customizable attack 
                signatures, including a description of the customization options that are available.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Craft a signature with the available fields indicated in the TSS.</step>
                      <step>Send a crafted frame that matches the signature to a whitelisted EUD</step>
                      <step>Verify that the TSF triggers an alert based on the newly defined signature.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>      
        
        <ext-comp-def title="Protected Audit Event Storage (Packet Captures)" fam-id="FAU_STG_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_stg_ext.1(pcap)" name="Protected Audit Event Storage (Packet Captures)">
          <selection-depends req="fau_arp.1.1" ids="pcap"/>
          <consistency-rationale></consistency-rationale>          
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies> 
          <f-element>
            <title>The TSF shall be able to transmit the generated <h:b>packet captures</h:b> to an external IT entity using a 
              trusted channel according to FTP_ITC.1.
            </title>
            <note role="application">
              This PP-Module modifies <linkref linkend="FTP_ITC.1"/> from NDcPP.
            </note>        
          </f-element>
          <f-element>
            <title>The TSF shall be able to store generated <h:b>packet captures</h:b> on the TOE itself.
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall 
              <selectables>
                <selectable>drop new packet capture data</selectable>
                <selectable>overwrite previous packet captures according to the following rule
                  <assignable>rule for overwriting previous packet captures</assignable>
                </selectable>
                <selectable>
                  <assignable>other action</assignable>
                </selectable> 
              </selectables> when the local storage space for packet capture data is full.             
            </title>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS includes the list of trusted channels (as specified in FTP_ITC.1) available in 
                the TSF to transmit packet captures to an external entity. The evaluator shall verify that the TSS describes the ability of the TOE to store packet capture data within itself, how much storage space is available for packet capture data and where that data is stored. The evaluator shall verify that the TSS describes the behavior of the TOE when local storage space for packet capture data is exhausted and whether this behavior is configurable.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to configure the trusted channel. If the behavior of the TOE when local storage space for packet capture data is exhausted is configurable, the evaluator shall verify that the operational guidance provides information on what the configurable behaviors are and how they can be set.<h:br/><h:br/>      
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure packet captures according to the guidance specified. The evaluator shall then trigger an event that starts a capture and verify through the tests in FTP_ITC.1 that the captured traffic being sent to the external device is being sent through a trusted channel.</test>   
                  <test>The evaluator shall configure packet captures to be stored on the TSF according to the guidance specified. The evaluator shall then trigger an event that starts a capture and verify that the packet capture was stored on the TSF.</test>
                  <test>The evaluator shall define packet data retention and deletion rules on the TSF according to the guidance specified and test the functionality of the specified rules.</test>        
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </sel-sfrs>
    <obj-sfrs>
      <subsection title="Security Audit (FAU)" id="fau">
        
        <f-component id="fau_gen.1" name="Device Configuration - Exporting Event Data"> <!-- NEW SFR -->
          <!-- TODO: Not gen -->
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> 
              The TSF shall allow for the for the export of all captured event logs. 
            </title>
            <note role="application">It is expected that an Authorized Administrator will be responsible for providing event output from the TSF
              for the purposes of ingest into other analysis and reporting mechanisms. Having the ability to export event log data from the device is a necessary capability
              to satisfy this requirement.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS includes a list of available containment methods on the TSF and 
                how to configure them.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                The evaluator shall perform the following test on the TSF: 
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events generated by the AP.</step>
                      <step>Verify that the TSF can export its configuration and observable event data in any of the following formats:</step> 
                      <h:ul>
                        <h:li>comma separated values (CSV)</h:li>
                        <h:li>common log format (CLF)</h:li>
                        <h:li>JavaScript Object Notation (JSON)</h:li>
                        <h:li>syslog</h:li>
                      </h:ul>   
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <!-- TODO: This component needs to be renumbered. It is actually a third iteration of FAU_GEN.1 
      How does this differ from FAU_GEN.1???
      From Diana - FAU_GEN.1.1/WIDS is for regular audit functions. FAU_GEN.2 is meant it to be the actual alerts that get generated by the wids. She originally had them together and TC stated that alerts are not audit so she moved them all and call them Alerts Data Generation instead of Audit. 
      -->
        <f-component id="fau_gen.2(wids)" name="Alerts Data Generation (WIDS)">
          <consistency-rationale></consistency-rationale>        
          <f-element>
            <title> The TSF shall be able to generate a WIDS audit record of the following auditable events:
              <h:ol type="a">
                <h:li>Start-up and shutdown of the WIDS functions;</h:li>
                <h:li>All WIDS auditable events for the [not specified] level of audit;</h:li>
                <h:li><h:i>[Auditable events listed in <ctr-ref refid="audit"/>;</h:i></h:li>
                <h:li><h:i>Totals of similar events occurring within a specified time period]</h:i></h:li>
              </h:ol>
              <h:table>
                <h:tr><h:td><h:b>Requirement</h:b></h:td><h:td><h:b>Auditable Events</h:b></h:td><h:td><h:b>Additional Audit Record Contents</h:b></h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_ANO_EXT.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_ARP.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_ARP_EXT.2"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_GEN.1/WIDS"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_IDS_EXT.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.1"/></h:td><h:td>whitelisted devices information</h:td><h:td>Type of device (AP or EUD), MAC Address.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.2"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.3"/></h:td><h:td>Unexpected behavior by whitelisted device alert</h:td><h:td>Description of behavior detected (i.e., bridge, ICS connection), MAC address of whitelisted device, MAC address of the device that the whitelisted device made a connection with, connection start and end.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.4"/></h:td><h:td>Information on location of device</h:td><h:td>Device MAC address, device type, classification of device, sensors that detected device, signal strength as received by detecting sensor(s), proximity to detecting sensor(s) (in meters). </h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.4/CELL"/></h:td><h:td>Information on location of device</h:td><h:td>device MAC address, device type, classification of device, sensors that detected device, signal strength as received by detecting sensor(s), proximity to detecting sensor(s) (in meters). </h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_INV_EXT.5"/></h:td><h:td>Alert generated by detection of rogue device.</h:td><h:td>Description of alert, type of device (AP or EUD), MAC Address, associations made between authorized devices (which APs are EUDs connected to), channel detected on, RF Band detected on, encryption type used by rogue, IEEE 802.11 standard used (a, b, g, n, ac), SSID (if AP).</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_MAC_EXT.1.1"/></h:td><h:td>Alert generated by detection of mac spoofing.</h:td>
                  <h:td>Description of alert, type of device (AP or EUD), MAC Address, associations made between authorized devices (which APs are EUDs connected to), channel detected on, RF Band detected on, encryption type used by rogue, IEEE 802.11 standard used (a, b, g, n, ac), SSID (if AP).</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_MAC_EXT.1.2"/></h:td><h:td>Alert generated by detection of mac spoofing.</h:td>
                  <h:td>Description of alert, location as labeled by administrator, time elapsed between connection in different locations, type of device (AP or EUD), MAC Address, associations made between authorized devices (which APs are EUDs connected to), channel detected on, RF Band detected on, encryption type used by rogue, IEEE 802.11 standard used (a, b, g, n, ac), SSID (if AP).</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_SAA.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_SIG_EXT.1"/></h:td><h:td>Alert generated by violaton of user defined signature.</h:td><h:td>Name of alert being triggered(as provided when creating the signature), description of alert (as provided when creating the signature), MAC address of devices involved.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_STG_EXT.1/PCAP"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.1.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.2"/></h:td><h:td>Details about what SSIDs are set as authorized.</h:td><h:td>SSIDs set by administrator as authorized.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.2.4"/></h:td><h:td>Unauthorized activity</h:td><h:td>description of violation (i.e. whitelisted EUD connected to unauthorized SSID), identity information of the devices involved.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.3"/></h:td><h:td>Alert generated for DoS.</h:td><h:td>MAC Address, device type, and classification AP or EUD attacked, DoS details (RF or injection based), for injection-based, indicate type (i.e., deauth flood). </h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.4"/></h:td><h:td>Information about devices and unauthorized authentication methods.</h:td><h:td>MAC Address, device type, and classification of devices involved, authentication method used.</h:td></h:tr>            
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.5"/></h:td><h:td>Information about devices and unauthorized encryption methods.</h:td><h:td>MAC Address, device type, and classification of devices involved, encryption method used.</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.5.3"/></h:td><h:td>Information about devices involved.</h:td><h:td>MAC Address, device type, and classification of devices involved (sending and receiving devices).</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.6"/></h:td><h:td>Information about detected devices.</h:td><h:td>Frequency band, channel used within frequency band, identification information (MAC address if applicable or other similar unique ID), device technology (i.e.,cellular), sensor(s) that detected devices.</h:td></h:tr>   
                <h:tr><h:td><linkref linkend="FAU_WID_EXT.7"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FAU_WIP_EXT.1"/></h:td><h:td>Information about action taken.</h:td><h:td>description of violation,the type of containment used, was containment triggered manually or automatically, sensor performing the containment (if wireless), details about the device (s) being contained (classification, device type, MAC address).</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FDP_IFC.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FMT_SMF.1/WIDS"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FPT_FLS.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>                
                <h:tr><h:td><linkref linkend="FPT_ITT.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td><linkref linkend="FTP_ITC.1"/></h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
              </h:table>
              <ctr id="audit" ctr-type="Table">: WIDS Alerts</ctr> 
            </title>         
            <note role="application">The alerts table contains the contents of the alert produced by the WIDS. The Alert table includes optional and objective requirements. The auditing of optional and objective requirements is only required if the vendor chooses to have the requirement evaluated by NIAP. <h:br/>         
              With regards to ‘similar’ type events, 'similar’ events are multiple occurrences of the same auditable event within some time period where the only significant difference between these events is the timestamp. For example, it is not expected that the TOE generate an individual audit message for every event of the same kind that occurs within a reasonable time period. An alert must, at a minum, include the details as outlined on the table, but may contain additional details.
            </note>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate audit records in accordance with the assurance activities associated with the functional requirements in this PP-Module. When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the administrative guide, and that the fields in each audit record have the proper entries. <h:br/><h:br/>                
                Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. 
              </Tests>
            </aactivity> 
          </f-element>
          <!-- TODO: need to change the wording of this to be more about the alerts. Need to rename this SFR -->
          <f-element>
            <title> The TSF shall record within each WIDS auditable event as <selectables>
              <selectable>comma separated values (CSV)</selectable>
              <selectable>common log format (CLF)</selectable>
              <selectable>JavaScript Object Notation (JSON)</selectable>
              <selectable>syslog</selectable>
            </selectables>
              at least the following information:
              <h:ol type="a">
                <h:li>Date and time of the event, type of event, and subject identity (if applicable);</h:li>
                <h:li>For each audit event type, based on the auditable event definitions of the functional components included in the PP/ST, 
                  [<h:i>auditable events listed in Table 4</h:i>].
                </h:li>
              </h:ol>              
            </title>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance describes how to configure the TOE to result in applicable WIDS data logging. The evaluator shall verify that the operational guidance provides instructions for any configuration that may be done in regard to logging similar events (e.g., setting thresholds, defining time windows, etc.).<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
                The evaluator shall test that the alerts yield the expected WIDS/WIPS audit data in the format selected in the ST for each WIDS auditable event in table 4. Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. 
              </Tests>
            </aactivity>
          </f-element>
        </f-component> 
        
        
        <ext-comp-def title="Precise Location of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_inv_ext.4" name="Precise Location of Environmental Objects">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect the physical location of [<h:i>APs, EUDs</h:i>] to within [<h:i>15 feet</h:i>] of their actual location.</title>
          </f-element>
          <!-- NEW SFRs -->
          <f-element>
            <title> The TSF shall include a signal library.</title> <!-- GAP Analysis -->
            
            <note role="application">The TSF will need to have the ability to import, export, or update the exisiting signal library.</note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes information on location tracking, optimal
                number of sensors and sensor placement to meet the required level of accuracy. <h:br/><h:br/> 
              </TSS>           
              <Guidance>
                The evaluator shall review the operational guidance for instructions on how to configure location tracking, how to 
                load a location map (if applicable), and where in the TSF administrator interface the location of APs and EUDs can be viewed.<h:br/><h:br/> 
              </Guidance>       
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
               <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Verify the TS provides location tracking information about the AP.</step>
                      <step>Verify the AP location presented is within 15 feet actual location.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
        <ext-comp-def title="Detection of Unauthorized Connections" fam-id="FAU_INV_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_inv_ext.5" name="Detection of Unauthorized Connections">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect when [<h:i>non-whitelisted APs as defined in <linkref linkend="FAU_INV_EXT.1"/></h:i>] have the following connections: 
              [<h:i>wired connection to the internal corporate network</h:i>].</title>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS includes guidance on whether the TSF has the capability of 
                detecting APs connecting to the protected wired network infrastructure. If the capability is present the TSS shall include
                configuration guidance for this feature.<h:br/><h:br/> 
              </TSS>
              
              <Guidance>
                The evaluator shall review the operational guidance for instructions on how to configure the WIDS to detect
                unauthorized APs connected to the protected wired infrastructure.<h:br/><h:br/> 
              </Guidance>
              
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
              <testlist>
                <test>
                  <steplist>
                    <step>Deploy a non-whitelisted AP.</step>
                    <step>Connect the AP via wire to the protected network infrastructure.</step>
                    <step>Check the WIDS user interface for a list of detected APs and EUDs.</step>
                    <step>Verify that the rogue AP is detected and an alert generated on the detection of an AP connected to the protected wired infrastructure.</step>
                  </steplist>
                </test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <ext-comp-def title="Device Impersonation" fam-id="FAU_MAC_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_mac_ext.1" name="Device Impersonation">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect when two sensors in non-overlapping locations receive traffic from the same MAC address simultaneously.</title>
            <note role="application">The intent of this SFR is to detect MAC spoofing where an attacker is able to cause the whitelisted EUD 
              to disconnect and promptly connects a non-whitelisted device using the MAC address of the whitelisted EUD.</note>
            <aactivity>	
              <TSS>
                The evaluator shall verify that the TSS describes the behavior of the TOE when two sensors in 
                non-overlapping locations receive traffic from the same MAC address simultaneously.<h:br/><h:br/> 
              </TSS>      
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to deploy the TOE in 
                a manner that allows the TSF to detect when two sensors in non-overlapping locations receive traffic from the same 
                MAC address simultaneously (i.e. information about the range and placement of sensors to ensure non-overlapping coverage).<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                The evaluator shall perform the following test:
              <testlist>
                <test>
                  <steplist>
                    <step>Setup a whitelisted AP (Location 1).</step>
                    <step>Connect a whitelisted EUD to AP.</step>
                    <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate non-overlapping location where the WIDS 
                      also has sensors. Or simulate the distant non-verlapping locations by deploying the second AP in a shielded environment 
                      connected to the valid network (Location 2).</step>
                    <step>Spoof the MAC address of the EUD in location 1 with the EUD in location 2 and connect it to the 
                      whitelisted AP in location 2. Make sure both EUDs are connected at the same time.</step>
                    <step>Verify that the TSF detected and generated an alert.</step>
                  </steplist>
                </test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>         
          <f-element>
            <title> The TSF shall detect when two sensors in non-overlapping locations receive traffic from the MAC addresses of 
              [<h:i>non-whitelisted EUDs as defined in <linkref linkend="FAU_INV_EXT.1"/></h:i>] within 
              [<h:i>an Authorized administrator-configurable timeframe based on distance between sensors</h:i>].</title>
            <note role="application">The intent of this SFR is to allow the administrator to determine the time that should be 
              allowed between a whitelisted EUD connecting in two distant locations.</note>
            <aactivity>	
              <TSS>
                There are no TSS assurance activities for this SFR. <h:br/><h:br/> 
              </TSS>            
              <Guidance>
                The evaluator shall verify that the operational guidance provides instructions on how to configure the timeframe 
                that should be allowed between two subsequent attempts for an EUD to connect from two separate locations.<h:br/><h:br/> 
              </Guidance>           
              <Tests> 
                The evaluator shall perform the following test:<h:br/>
              <testlist>
                <test>
                  <steplist>
                    <step>Configure the timeframe allowed between connection of two EUDs in two separate locations (Location 1, Location 2).</step>
                    <step>Setup a whitelisted AP (Location 1). </step>
                    <step>Connect a whitelisted EUD to AP.</step>
                    <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate non-overlapping location where the WIDS 
                      also has sensors. Or simulate the distant non-verlapping locations by deploying the second AP in a shielded environment 
                      connected to the valid network (Location 2).</step>
                    <step>Spoof the MAC address of the EUD in location 1 with the EUD in location 2 and connect it to the 
                      whitelisted AP in location 2. Make sure that the time between connections is shorter than the time timeframe 
                      allowed/configured. </step>
                    <step>Verify that the TSF detected and generated an alert.</step>
                  </steplist>
                </test>
              </testlist>
              </Tests>             
            </aactivity>
          </f-element>
        </f-component>
      
        <ext-comp-def title="Proprietary Traffic Monitoring" fam-id="FAU_WID_EXT">
          <mod-def></mod-def>
        </ext-comp-def>
        <f-component id="fau_wid_ext.7" name="Wireless Intrusion Detection – Proprietary Traffic Monitoring">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall detect the presence of all vendor proprietary network traffic matching the [<h:i>802.11 monitoring SFP</h:i>]
              for [<h:i>all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <h:ol>
                <h:li><h:i>authorized APs and authorized EUDs.</h:i></h:li>
                <h:li><h:i>authorized APs and unauthorized EUDs.</h:i></h:li>
                <h:li><h:i>unauthorized APs and authorized EUDs.</h:i></h:li>
              </h:ol>]            
            </title>
            <note role="Application">The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in <linkref linkend="FDP_IFC.1"/> and defined through <linkref linkend="FAU_WID_EXT"/> SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS>
                There are no TSS assurance activities for this SFR.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Set the WIDS sensor for a set channel.</step>
                      <step>Start a traffic capture from the WIDS sensor.</step>
                      <step>Send a set number of frames on the sensor's operating channel for all IEEE 802.11 a, b, g, n, ac 
                        vendor propietary frame types and subtypes from/to the following:
                        <h:ol>
                          <h:li><h:i>authorized APs and authorized EUDs.</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs.</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs.</h:i></h:li>
                        </h:ol>
                      </step>
                      <step>Provide a list of the frames types and subtypos that were used for testing and verify that they were all detected.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Wireless Intrusion Prevention" fam-id="FAU_WIP_EXT">
          <fam-behavior></fam-behavior>
        </ext-comp-def>
        <f-component id="fau_wip_ext.1" name="Wireless Intrusion Prevention">
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> The TSF shall allow an Authorized Administrator to isolate a wireless AP or EUD from the network monitored 
              by the TSF using the following methods: 
              <selectables>
                <selectable>wireless containment</selectable>
                <selectable>wire-side containment of an unauthorized AP connected to the internal corporate wired network.</selectable>
              </selectables>     
            </title>
            <note role="application">It is expected that an Authorized Administrator will be responsible for confirming the 
              AP or EUD as a rogue AP or EUD to initiate wireless containment. <h:br/> 
              In this SFR the containment of an an unauthorized AP connected to the internal corporate wired network refers to an unauthorized AP 
              that is physically connected (via wire) to the protected internal wired infrastructure. 
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS includes a list of available containment methods on the TSF and 
                how to configure them.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                Configure the containment methods available on the TSF and perform the following test for each method.
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP and connect to the protected wired infrastructure via wire  
                        (make sure it gets classified as rogue, or manually classify as such).</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Verify that TSF generates an alert, breaks the connection of the whitelisted EUD from the rogue AP, and contains the rogue AP.</step>                  
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      

        
       
       
        
            
      </subsection>     
      
      <subsection title="Security Management (FMT)" id="fmt">
        
        <f-component id="fmt_mof.1" name="Device Configuration - Monitoring Time and Frequency"> <!-- NEW SFRs --><!-- Need to move, but testing was added -->
          <consistency-rationale></consistency-rationale>
          <comp-lev></comp-lev>
          <management></management>
          <audit></audit>
          <dependencies></dependencies>
          <f-element>
            <title> 
              The TSF shall allow for the configuration of the time it monitors a specific frequency. 
            </title>
            <note role="application">It is expected that an Authorized Administrator will be responsible for configuring the 
              AP to operate on a specific frequency persuaent to the 802.11 standard. The  TSF will have the ability to adjust the amount of time
              it passively monitors and captures WLAN traffic on a given frequency and channel.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS includes a list of available containment methods on the TSF and 
                how to configure them.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                There are no operational guidance activities for this SFR.<h:br/><h:br/> 
              </Guidance>
              <Tests> 
                The evaluator shall perform the following test on the TSF: 
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events generated by the AP.</step>
                      <step>Verify that the TSF can be configured to capture traffic on a specific channel for specific interval of time, and assign a specified frequency and time interval.</step> 
                      <step>Confirm that the TSF" /> remains on the frequency and channel for the time period specified.</step>                 
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
      </subsection>
      
      <subsection title="Protection of the TSF (FPT)" id="fpt" >
        <f-component id="fpt_fls.1" name="Basic Internal TSF Data Transfer Protection">
          <consistency-rationale></consistency-rationale>
          <f-element>
            <title> The TSF shall preserve a secure state when the following types of failures occur: 
              [<h:i>sensor functionality failure, potential compromise of the TSF</h:i>].
            </title>
            <note role="application">
              At minimum, the preservation of a secure state requires the generation of audit records when the defined failure conditions occur.
            </note>
            <aactivity>	
              <TSS>
                The evaluator shall review the TSS section to determine that the TOE’s implementation of the fail secure 
                functionality is documented. The evaluator shall examine the TSS section to ensure that all failure modes 
                specified in the ST are described.<h:br/><h:br/> 
              </TSS>
              <Guidance>
                The evaluator shall review the operational guidance to verify that it identifies the potential TOE failures, how the TSF preserves a secure state following these failures, and any actions that are required to restore the TOE to normal operation following the transition to a failure state. <h:br/><h:br/> 
              </Guidance>
              <Tests> 
                <testlist>
                  <test>For each failure mode specified in the ST, the evaluator shall ensure that the TOE attains a secure state
                    after initiating each failure mode type.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>  
      </subsection>    
    </obj-sfrs>
  </chapter> 
 <bibliography>
    <cc-entry/>
  </bibliography>
 <acronyms>
   <entry>
     <term><abbr title="Advanced Encryption Standard">AES</abbr></term>
     <description>Advanced Encryption Standard</description>
   </entry>
   <entry>
     <term><abbr title="Access Point">AP</abbr></term>
     <description>Access Point</description>
   </entry>
   <entry>
     <term><abbr title="Basic Service Set Identifier">BSSID</abbr></term>
     <description>Basic Service Set Identifier</description>
   </entry>
   <entry>
     <term><abbr title="Denial of Service">DoS</abbr></term>
     <description>Denial of Service</description>
   </entry>      
   <entry>
     <term><abbr title="End User Device">EUD</abbr></term>
     <description>End User Device</description>
   </entry>      
   <entry>
     <term><abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr></term>
     <description>Hypertext Transfer Protocol Secure</description>
   </entry>
   <entry>
     <term><abbr title="Internet Protocol Security">IPsec</abbr></term>
     <description>Internet Protocol Security</description>
   </entry>
   <entry>
     <term><abbr title="Media Access Control">MAC</abbr></term>
     <description>Media Access Control</description>
   </entry>      
   <entry>
     <term><abbr title="Secure Shell">SSH</abbr></term>
     <description>Secure Shell</description>
   </entry>
   <entry>
     <term><abbr title="Service Set Identifier">SSID</abbr></term>
     <description>Service Set Identifier</description>
   </entry>
   <entry>
     <term><abbr title="Transport Layer Security">TLS</abbr></term>
     <description>Transport Layer Security</description>
   </entry>
   <entry>
     <term><abbr title="Temporal Key Integrity Protocol">TKIP</abbr></term>
     <description>Temporal Key Integrity Protocol</description>
   </entry>
   <entry>
     <term><abbr title="Wired Equivalent Protocol">WEP</abbr></term>
     <description>Wired Equivalent Protocol</description>
   </entry>
   <entry>
     <term><abbr title="Wireless Intrusion Detection Systems">WIDS</abbr></term>
     <description>Wireless Intrusion Detection Systems</description>
   </entry>
   <entry>
     <term><abbr title="Wireless Intrusion Prevention Systems">WIPS</abbr></term>
     <description>Wireless Intrusion Prevention Systems</description>
   </entry>
   <entry>
     <term><abbr title="Wireless Local Area Network">WLAN</abbr></term>
     <description>Wireless Local Area Network</description>
   </entry>
   <entry>
     <term><abbr title="Wi-Fi Protected Access">WPA</abbr></term>
     <description>Wi-Fi Protected Access</description>
   </entry>    
    </acronyms>
</Module>
